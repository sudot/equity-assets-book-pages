import{a as nn,m as Xi,r as rn,w as an,E as ji,_ as Zi,q as Ot,x as oe,a4 as A,a5 as et,bi as jt,bj as sn,bk as ln,bl as cn,n as un,ap as hn,L as dn,e as pn,aZ as vn,p as Oi,s as Vi,t as Tt,v as ot,Q as ie,ax as Be,a2 as Oe,F as Wi,y as gn,at as fn,au as mn,av as yn,aw as _n}from"./index.757f950f.js";import{c as xn,d as Sn,a as Ni,Q as Cn}from"./transaction.804e5840.js";import{e as zi,Q as bn}from"./QForm.c5e622cc.js";import{Q as Tn}from"./QPage.6a266ce5.js";import{u as wn}from"./use-quasar.23119b98.js";import{A as En,g as Yi,r as In}from"./AddTransaction.b0e9a5b8.js";import"./ClosePopup.13d91716.js";import"./rtl.b51694b1.js";import"./QItem.1baa897c.js";import"./decimal.cf065309.js";var Dn=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{},ge={exports:{}},Ve={exports:{}};/**
 * @license
 * KLineChart v9.5.4
 * Copyright (c) 2019 lihu.
 * Licensed under Apache License 2.0 https://www.apache.org/licenses/LICENSE-2.0
 */(function(k,mt){(function(f,j){j(mt)})(Dn,function(f){function j(n,t){if(N(n)||N(t)){for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e)){var o=n[e],i=t[e];N(i)&&N(o)&&!W(i)&&!W(o)?j(o,i):R(t[e])&&(n[e]=t[e])}}}function Z(n){if(!N(n)||!W(n))return n;var t;for(var e in t=W(n)?[]:{},n)if(Object.prototype.hasOwnProperty.call(n,e)){var o=n[e];t[e]=N(o)?Z(o):o}return t}function W(n){return Object.prototype.toString.call(n)==="[object Array]"}function K(n){return typeof n=="function"}function N(n){return typeof n=="object"}function V(n){return typeof n=="number"&&!isNaN(n)}function R(n){return n!=null}function G(n){return typeof n=="boolean"}function q(n){return typeof n=="string"}var wt,Zt,fe,We,me,ne,Wt,Ne,ye,Nt,qi=/\\(\\)?/g,Gi=RegExp(`[^.[\\]]+|\\[(?:([^"'][^[]*)|(["'])((?:(?!\\2)[^\\\\]|\\\\.)*?)\\2)\\]|(?=(?:\\.|\\[\\])(?:\\.|\\[\\]|$))`,"g");function $(n,t,e){if(R(n)){var o=[];t.replace(Gi,function(s){for(var l=[],c=1;arguments.length>c;c++)l[c-1]=arguments[c];var u=s;return R(l[1])?u=l[2].replace(qi,"$1"):R(l[0])&&(u=l[0].trim()),o.push(u),""});for(var i=n,r=0,a=o.length;R(i)&&a>r;)i=i==null?void 0:i[o[r++]];return R(i)?i:e!=null?e:"--"}return e!=null?e:"--"}function ze(n,t,e){var o=n.format(new Date(t)).split(", "),i=o[0].split("/"),r=o[1].split(":"),a={YYYY:i[2],MM:i[0],DD:i[1],HH:r[0]==="24"?"00":r[0],mm:r[1],ss:r[2]};return e.replace(/YYYY|MM|DD|HH|mm|ss/g,function(s){return a[s]})}function U(n,t){var e=+n;return V(e)?e.toFixed(t!=null?t:2):"".concat(n)}function Ye(n){var t=+n;if(V(t)){if(t>1e9)return"".concat(+(t/1e9).toFixed(3),"B");if(t>1e6)return"".concat(+(t/1e6).toFixed(3),"M");if(t>1e3)return"".concat(+(t/1e3).toFixed(3),"K")}return"".concat(n)}function J(n,t){var e="".concat(n);if(t.length===0)return e;if(e.includes(".")){var o=e.split(".");return"".concat(o[0].replace(/(\d)(?=(\d{3})+$)/g,function(i){return"".concat(i).concat(t)}),".").concat(o[1])}return e.replace(/(\d)(?=(\d{3})+$)/g,function(i){return"".concat(i).concat(t)})}f.LineType=void 0,(wt=f.LineType||(f.LineType={})).Dashed="dashed",wt.Solid="solid",f.PolygonType=void 0,(Zt=f.PolygonType||(f.PolygonType={})).Stroke="stroke",Zt.Fill="fill",Zt.StrokeFill="stroke_fill",f.TooltipShowRule=void 0,(fe=f.TooltipShowRule||(f.TooltipShowRule={})).Always="always",fe.FollowCross="follow_cross",fe.None="none",f.TooltipShowType=void 0,(We=f.TooltipShowType||(f.TooltipShowType={})).Standard="standard",We.Rect="rect",f.TooltipIconPosition=void 0,(me=f.TooltipIconPosition||(f.TooltipIconPosition={})).Left="left",me.Middle="middle",me.Right="right",function(n){n.Fixed="fixed",n.Pointer="pointer"}(ne||(ne={})),f.CandleType=void 0,(Wt=f.CandleType||(f.CandleType={})).CandleSolid="candle_solid",Wt.CandleStroke="candle_stroke",Wt.CandleUpStroke="candle_up_stroke",Wt.CandleDownStroke="candle_down_stroke",Wt.Ohlc="ohlc",Wt.Area="area",f.YAxisPosition=void 0,(Ne=f.YAxisPosition||(f.YAxisPosition={})).Left="left",Ne.Right="right",f.YAxisType=void 0,(ye=f.YAxisType||(f.YAxisType={})).Normal="normal",ye.Percentage="percentage",ye.Log="log",f.FormatDateType=void 0,(Nt=f.FormatDateType||(f.FormatDateType={}))[Nt.Tooltip=0]="Tooltip",Nt[Nt.Crosshair=1]="Crosshair",Nt[Nt.XAxis=2]="XAxis";var _e=function(n,t){return _e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,o){e.__proto__=o}||function(e,o){for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(e[i]=o[i])},_e(n,t)};function B(n,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+t+" is not a constructor or null");function e(){this.constructor=n}_e(n,t),n.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}var Mt,P=function(){return P=Object.assign||function(n){for(var t,e=1,o=arguments.length;o>e;e++)for(var i in t=arguments[e])Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i]);return n},P.apply(this,arguments)};function re(n,t,e,o){return new(e||(e=Promise))(function(i,r){function a(c){try{l(o.next(c))}catch(u){r(u)}}function s(c){try{l(o.throw(c))}catch(u){r(u)}}function l(c){var u;c.done?i(c.value):(u=c.value,u instanceof e?u:new e(function(h){h(u)})).then(a,s)}l((o=o.apply(n,t||[])).next())})}function ae(n,t){var e,o,i,r,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:s(0),throw:s(1),return:s(2)},typeof Symbol=="function"&&(r[Symbol.iterator]=function(){return this}),r;function s(l){return function(c){return function(u){if(e)throw new TypeError("Generator is already executing.");for(;r&&(r=0,u[0]&&(a=0)),a;)try{if(e=1,o&&(i=2&u[0]?o.return:u[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,u[1])).done)return i;switch(o=0,i&&(u=[2&u[0],i.value]),u[0]){case 0:case 1:i=u;break;case 4:return a.label++,{value:u[1],done:!1};case 5:a.label++,o=u[1],u=[0];continue;case 7:u=a.ops.pop(),a.trys.pop();continue;default:if(i=a.trys,!((i=i.length>0&&i[i.length-1])||u[0]!==6&&u[0]!==2)){a=0;continue}if(u[0]===3&&(!i||u[1]>i[0]&&i[3]>u[1])){a.label=u[1];break}if(u[0]===6&&i[1]>a.label){a.label=i[1],i=u;break}if(i&&i[2]>a.label){a.label=i[2],a.ops.push(u);break}i[2]&&a.ops.pop(),a.trys.pop();continue}u=t.call(n,a)}catch(h){u=[6,h],o=0}finally{e=i=0}if(5&u[0])throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}([l,c])}}}function qt(n){var t=typeof Symbol=="function"&&Symbol.iterator,e=t&&n[t],o=0;if(e)return e.call(n);if(n&&typeof n.length=="number")return{next:function(){return n&&o>=n.length&&(n=void 0),{value:n&&n[o++],done:!n}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function it(n,t){var e=typeof Symbol=="function"&&n[Symbol.iterator];if(!e)return n;var o,i,r=e.call(n),a=[];try{for(;(t===void 0||t-- >0)&&!(o=r.next()).done;)a.push(o.value)}catch(s){i={error:s}}finally{try{o&&!o.done&&(e=r.return)&&e.call(r)}finally{if(i)throw i.error}}return a}function He(n,t,e){if(e||arguments.length===2)for(var o,i=0,r=t.length;r>i;i++)!o&&i in t||(o||(o=Array.prototype.slice.call(t,0,i)),o[i]=t[i]);return n.concat(o||Array.prototype.slice.call(t))}typeof SuppressedError=="function"&&SuppressedError,f.ActionType=void 0,(Mt=f.ActionType||(f.ActionType={})).OnZoom="onZoom",Mt.OnScroll="onScroll",Mt.OnVisibleRangeChange="onVisibleRangeChange",Mt.OnTooltipIconClick="onTooltipIconClick",Mt.OnCrosshairChange="onCrosshairChange",Mt.OnCandleBarClick="onCandleBarClick",Mt.OnPaneDrag="onPaneDrag";var se,$i=function(){function n(){this._callbacks=[]}return n.prototype.subscribe=function(t){var e;0>((e=this._callbacks.indexOf(t))!==null&&e!==void 0?e:-1)&&this._callbacks.push(t)},n.prototype.unsubscribe=function(t){var e;if(t!==void 0){var o=(e=this._callbacks.indexOf(t))!==null&&e!==void 0?e:-1;o>-1&&this._callbacks.splice(o,1)}else this._callbacks=[]},n.prototype.execute=function(t){this._callbacks.forEach(function(e){e(t)})},n.prototype.isEmpty=function(){return this._callbacks.length===0},n}(),xe=1,Xe=new Date().getTime();function je(n){var t=new Date().getTime();return t===Xe?++xe:xe=1,Xe=t,"".concat(n!=null?n:"").concat(t,"_").concat(xe)}function yt(n,t){var e,o=document.createElement(n),i=t!=null?t:{};for(var r in i)o.style[r]=(e=i[r])!==null&&e!==void 0?e:"";return o}function kt(n){var t,e,o;return Math.ceil((o=(e=(t=n.ownerDocument)===null||t===void 0?void 0:t.defaultView)===null||e===void 0?void 0:e.devicePixelRatio)!==null&&o!==void 0?o:2)}function At(n,t,e){return"".concat(t!=null?t:"normal"," ").concat(n!=null?n:12,"px ").concat(e!=null?e:"Helvetica Neue")}function Gt(n,t,e,o){if(se===void 0){var i=document.createElement("canvas"),r=kt(i);(se=i.getContext("2d")).scale(r,r)}return se.font=At(t,e,o),Math.round(se.measureText(n).width)}function Se(n,t,e){var o=0,i=0;for(i=n.length-1;o!==i;){var r=Math.floor((i+o)/2),a=i-o,s=n[r][t];if(e===n[o][t])return o;if(e===n[i][t])return i;if(e===s)return r;if(e>s?o=r:i=r,2>=a)break}return o}function Ze(n,t){return t==null&&(t=10),+(+n).toFixed(t=Math.min(Math.max(0,t),20))}function qe(n,t,e){var o=[Number.MIN_SAFE_INTEGER,Number.MAX_SAFE_INTEGER];return n.forEach(function(i){var r,a;o[0]=Math.max((r=i[t])!==null&&r!==void 0?r:i,o[0]),o[1]=Math.min((a=i[e])!==null&&a!==void 0?a:i,o[1])}),o}function $t(n){return Math.log(n)/Math.log(10)}function Ft(n){return Math.pow(10,n)}var Ce,Ki=1,Ui=50,Qi=function(){function n(t){this._dateTimeFormat=this._buildDateTimeFormat(),this._zoomEnabled=!0,this._scrollEnabled=!0,this._loading=!0,this._loadMoreCallback=null,this._more=!0,this._totalBarSpace=0,this._barSpace=6,this._offsetRightDistance=50,this._startScrollOffsetRightBarCount=0,this._minVisibleBarCount={left:2,right:2},this._visibleRange={from:0,to:0,realFrom:0,realTo:0},this._chartStore=t,this._gapBarSpace=this._calcGapBarSpace(),this._offsetRightBarCount=this._offsetRightDistance/this._barSpace}return n.prototype._calcGapBarSpace=function(){return Math.max(1,Math.min(Math.floor(.82*this._barSpace),Math.floor(this._barSpace)-1))},n.prototype.adjustVisibleRange=function(){var t,e=this._chartStore.getDataList(),o=e.length,i=this._totalBarSpace/this._barSpace,r=i-Math.min(this._minVisibleBarCount.left,o);this._offsetRightBarCount>r&&(this._offsetRightBarCount=r);var a=-o+Math.min(this._minVisibleBarCount.right,o);a>this._offsetRightBarCount&&(this._offsetRightBarCount=a);var s=Math.round(this._offsetRightBarCount+o+.5);s>o&&(s=o);var l=Math.round(s-i)-1;if(0>l&&(l=0),this._visibleRange={from:l,to:s,realFrom:this._offsetRightBarCount>0?Math.round(o+this._offsetRightBarCount-i)-1:l,realTo:s},this._chartStore.getActionStore().execute(f.ActionType.OnVisibleRangeChange,this._visibleRange),this._chartStore.adjustVisibleDataList(),l===0&&this._more&&!this._loading&&this._loadMoreCallback!==null){this._loading=!0;var c=e[0];this._loadMoreCallback((t=c==null?void 0:c.timestamp)!==null&&t!==void 0?t:null)}},n.prototype.setMore=function(t){return this._more=t,this},n.prototype.setLoading=function(t){return this._loading=t,this},n.prototype.getDateTimeFormat=function(){return this._dateTimeFormat},n.prototype._buildDateTimeFormat=function(t){var e={hour12:!1,year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"};t!==void 0&&(e.timeZone=t);var o=null;try{o=new Intl.DateTimeFormat("en",e)}catch{}return o},n.prototype.setTimezone=function(t){var e=this._buildDateTimeFormat(t);e!==null&&(this._dateTimeFormat=e)},n.prototype.getTimezone=function(){return this._dateTimeFormat.resolvedOptions().timeZone},n.prototype.getBarSpace=function(){return{bar:this._barSpace,halfBar:this._barSpace/2,gapBar:this._gapBarSpace,halfGapBar:this._gapBarSpace/2}},n.prototype.setBarSpace=function(t,e){Ki>t||t>Ui||this._barSpace===t||(this._barSpace=t,this._gapBarSpace=this._calcGapBarSpace(),e==null||e(),this.adjustVisibleRange(),this._chartStore.getTooltipStore().recalculateCrosshair(!0),this._chartStore.getChart().adjustPaneViewport(!1,!0,!0,!0))},n.prototype.setTotalBarSpace=function(t){return this._totalBarSpace!==t&&(this._totalBarSpace=t,this.adjustVisibleRange(),this._chartStore.getTooltipStore().recalculateCrosshair(!0)),this},n.prototype.setOffsetRightDistance=function(t,e){return this._offsetRightDistance=t,this._offsetRightBarCount=t/this._barSpace,e!=null&&e&&(this.adjustVisibleRange(),this._chartStore.getTooltipStore().recalculateCrosshair(!0),this._chartStore.getChart().adjustPaneViewport(!1,!0,!0,!0)),this},n.prototype.resetOffsetRightDistance=function(){this.setOffsetRightDistance(this._offsetRightDistance)},n.prototype.getInitialOffsetRightDistance=function(){return this._offsetRightDistance},n.prototype.getOffsetRightDistance=function(){return Math.max(0,this._offsetRightBarCount*this._barSpace)},n.prototype.getOffsetRightBarCount=function(){return this._offsetRightBarCount},n.prototype.setOffsetRightBarCount=function(t){return this._offsetRightBarCount=t,this},n.prototype.setLeftMinVisibleBarCount=function(t){return this._minVisibleBarCount.left=t,this},n.prototype.setRightMinVisibleBarCount=function(t){return this._minVisibleBarCount.right=t,this},n.prototype.getVisibleRange=function(){return this._visibleRange},n.prototype.startScroll=function(){this._startScrollOffsetRightBarCount=this._offsetRightBarCount},n.prototype.scroll=function(t){if(this._scrollEnabled){var e=t/this._barSpace;this._chartStore.getActionStore().execute(f.ActionType.OnScroll),this._offsetRightBarCount=this._startScrollOffsetRightBarCount-e,this.adjustVisibleRange(),this._chartStore.getTooltipStore().recalculateCrosshair(!0),this._chartStore.getChart().adjustPaneViewport(!1,!0,!0,!0)}},n.prototype.getDataByDataIndex=function(t){var e;return(e=this._chartStore.getDataList()[t])!==null&&e!==void 0?e:null},n.prototype.coordinateToFloatIndex=function(t){var e=this._chartStore.getDataList().length;return Math.round(1e6*(e+this._offsetRightBarCount-(this._totalBarSpace-t)/this._barSpace))/1e6},n.prototype.dataIndexToTimestamp=function(t){var e,o=this.getDataByDataIndex(t);return(e=o==null?void 0:o.timestamp)!==null&&e!==void 0?e:null},n.prototype.timestampToDataIndex=function(t){var e=this._chartStore.getDataList();return e.length===0?0:Se(e,"timestamp",t)},n.prototype.dataIndexToCoordinate=function(t){var e=this._chartStore.getDataList().length;return this._totalBarSpace-(e+this._offsetRightBarCount-t-.5)*this._barSpace},n.prototype.coordinateToDataIndex=function(t){return Math.ceil(this.coordinateToFloatIndex(t))-1},n.prototype.zoom=function(t,e){var o,i=this;if(this._zoomEnabled){if((e==null?void 0:e.x)===void 0){var r=this._chartStore.getTooltipStore().getCrosshair();e={x:(o=r==null?void 0:r.x)!==null&&o!==void 0?o:this._totalBarSpace/2}}this._chartStore.getActionStore().execute(f.ActionType.OnZoom);var a=this.coordinateToFloatIndex(e.x);this.setBarSpace(this._barSpace+t*(this._barSpace/10),function(){i._offsetRightBarCount+=a-i.coordinateToFloatIndex(e==null?void 0:e.x)})}},n.prototype.setZoomEnabled=function(t){return this._zoomEnabled=t,this},n.prototype.getZoomEnabled=function(){return this._zoomEnabled},n.prototype.setScrollEnabled=function(t){return this._scrollEnabled=t,this},n.prototype.getScrollEnabled=function(){return this._scrollEnabled},n.prototype.setLoadMoreCallback=function(t){return this._loadMoreCallback=t,this},n.prototype.clear=function(){this._more=!0,this._loading=!0,this._visibleRange={from:0,to:0,realFrom:0,realTo:0}},n}();function be(n,t,e,o,i){var r,a=t.result,s=t.figures,l=t.styles,c=$(l,"circles",o.circles),u=c.length,h=$(l,"bars",o.bars),d=h.length,p=$(l,"lines",o.lines),v=p.length,g=0,m=0,y=0;s.forEach(function(_){var x;switch(_.type){case"circle":var S=c[g%u];r=P(P({},S),{color:S.noChangeColor}),g++;break;case"bar":var C=h[m%d];r=P(P({},C),{color:C.noChangeColor}),m++;break;case"line":r=p[y%v],y++}if(R(r)){var T=(x=_.styles)===null||x===void 0?void 0:x.call(_,{prev:{kLineData:n[e-1],indicatorData:a[e-1]},current:{kLineData:n[e],indicatorData:a[e]},next:{kLineData:n[e+1],indicatorData:a[e+1]}},t,o);i(_,P(P({},r),T))}})}f.IndicatorSeries=void 0,(Ce=f.IndicatorSeries||(f.IndicatorSeries={})).Normal="normal",Ce.Price="price",Ce.Volume="volume";var Ge=function(){function n(t){this.result=[],this._precisionFlag=!1;var e=t.name,o=t.shortName,i=t.series,r=t.calcParams,a=t.figures,s=t.precision,l=t.shouldOhlc,c=t.shouldFormatBigNumber,u=t.visible,h=t.minValue,d=t.maxValue,p=t.styles,v=t.extendData,g=t.regenerateFigures,m=t.createTooltipDataSource,y=t.draw;this.name=e,this.shortName=o!=null?o:e,this.series=i!=null?i:f.IndicatorSeries.Normal,this.precision=s!=null?s:4,this.calcParams=r!=null?r:[],this.figures=a!=null?a:[],this.shouldOhlc=l!=null&&l,this.shouldFormatBigNumber=c!=null&&c,this.visible=u==null||u,this.minValue=h!=null?h:null,this.maxValue=d!=null?d:null,this.styles=p!=null?p:{},this.extendData=v,this.regenerateFigures=g!=null?g:null,this.createTooltipDataSource=m!=null?m:null,this.draw=y!=null?y:null}return n.prototype.setShortName=function(t){return this.shortName!==t&&(this.shortName=t,!0)},n.prototype.setSeries=function(t){return this.series!==t&&(this.series=t,!0)},n.prototype.setPrecision=function(t,e){var o=e!=null&&e,i=Math.floor(t);return!(i===this.precision||0>t||o&&(!o||this._precisionFlag))&&(this.precision=i,o||(this._precisionFlag=!0),!0)},n.prototype.setCalcParams=function(t){var e,o;return this.calcParams=t,this.figures=(o=(e=this.regenerateFigures)===null||e===void 0?void 0:e.call(this,t))!==null&&o!==void 0?o:this.figures,!0},n.prototype.setShouldOhlc=function(t){return this.shouldOhlc!==t&&(this.shouldOhlc=t,!0)},n.prototype.setShouldFormatBigNumber=function(t){return this.shouldFormatBigNumber!==t&&(this.shouldFormatBigNumber=t,!0)},n.prototype.setVisible=function(t){return this.visible!==t&&(this.visible=t,!0)},n.prototype.setStyles=function(t){return t!==null&&(j(this.styles,t),!0)},n.prototype.setExtendData=function(t){return this.extendData!==t&&(this.extendData=t,!0)},n.prototype.setFigures=function(t){return this.figures!==t&&(this.figures=t,!0)},n.prototype.setMinValue=function(t){return this.minValue!==t&&(this.minValue=t,!0)},n.prototype.setMaxValue=function(t){return this.maxValue!==t&&(this.maxValue=t,!0)},n.prototype.setRegenerateFigures=function(t){return this.regenerateFigures!==t&&(this.regenerateFigures=t,!0)},n.prototype.setCreateTooltipDataSource=function(t){return this.createTooltipDataSource!==t&&(this.createTooltipDataSource=t,!0)},n.prototype.setDraw=function(t){return this.draw!==t&&(this.draw=t,!0)},n.prototype.calcIndicator=function(t){return re(this,void 0,void 0,function(){var e;return ae(this,function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),[4,this.calc(t,this)];case 1:return e=o.sent(),this.result=e,[2,!0];case 2:return o.sent(),[2,!1];case 3:return[2]}})})},n.extend=function(t){return function(e){function o(){return e.call(this,t)||this}return B(o,e),o.prototype.calc=function(i,r){return t.calc(i,r)},o}(n)},n}(),Ji={name:"AVP",shortName:"AVP",series:f.IndicatorSeries.Price,precision:2,figures:[{key:"avp",title:"AVP: ",type:"line"}],calc:function(n){var t=0,e=0;return n.map(function(o){var i,r,a={},s=(i=o==null?void 0:o.turnover)!==null&&i!==void 0?i:0,l=(r=o==null?void 0:o.volume)!==null&&r!==void 0?r:0;return t+=s,(e+=l)!==0&&(a.avp=t/e),a})}},to={name:"EMA",shortName:"EMA",series:f.IndicatorSeries.Price,calcParams:[6,12,20],precision:2,shouldOhlc:!0,figures:[{key:"ema1",title:"EMA6: ",type:"line"},{key:"ema2",title:"EMA12: ",type:"line"},{key:"ema3",title:"EMA20: ",type:"line"}],regenerateFigures:function(n){return n.map(function(t,e){return{key:"ema".concat(e+1),title:"EMA".concat(t,": "),type:"line"}})},calc:function(n,t){var e=t.calcParams,o=t.figures,i=0,r=[];return n.map(function(a,s){var l={},c=a.close;return i+=c,e.forEach(function(u,h){u-1>s||(r[h]=s>u-1?(2*c+(u-1)*r[h])/(u+1):i/u,l[o[h].key]=r[h])}),l})}},eo={name:"MA",shortName:"MA",series:f.IndicatorSeries.Price,calcParams:[5,10,30,60],precision:2,shouldOhlc:!0,figures:[{key:"ma5",title:"MA5: ",type:"line"},{key:"ma10",title:"MA10: ",type:"line"},{key:"ma30",title:"MA30: ",type:"line"},{key:"ma60",title:"MA60: ",type:"line"}],regenerateFigures:function(n){return n.map(function(t,e){return{key:"ma".concat(e+1),title:"MA".concat(t,": "),type:"line"}})},calc:function(n,t){var e=t.calcParams,o=t.figures,i=[];return n.map(function(r,a){var s={},l=r.close;return e.forEach(function(c,u){var h;i[u]=((h=i[u])!==null&&h!==void 0?h:0)+l,c-1>a||(s[o[u].key]=i[u]/c,i[u]-=n[a-(c-1)].close)}),s})}},io={name:"RSI",shortName:"RSI",calcParams:[6,12,24],figures:[{key:"rsi1",title:"RSI1: ",type:"line"},{key:"rsi2",title:"RSI2: ",type:"line"},{key:"rsi3",title:"RSI3: ",type:"line"}],regenerateFigures:function(n){return n.map(function(t,e){var o=e+1;return{key:"rsi".concat(o),title:"RSI".concat(o,": "),type:"line"}})},calc:function(n,t){var e=t.calcParams,o=t.figures,i=[],r=[];return n.map(function(a,s){var l,c={},u=((l=n[s-1])!==null&&l!==void 0?l:a).close,h=a.close-u;return e.forEach(function(d,p){var v,g,m;if(h>0?i[p]=((v=i[p])!==null&&v!==void 0?v:0)+h:r[p]=((g=r[p])!==null&&g!==void 0?g:0)+Math.abs(h),s>=d-1){c[o[p].key]=r[p]!==0?100-100/(1+i[p]/r[p]):0;var y=n[s-(d-1)],_=(m=n[s-d])!==null&&m!==void 0?m:y,x=y.close-_.close;x>0?i[p]-=x:r[p]-=Math.abs(x)}}),c})}},oo={name:"VOL",shortName:"VOL",series:f.IndicatorSeries.Volume,calcParams:[5,10,20],shouldFormatBigNumber:!0,precision:0,minValue:0,figures:[{key:"ma1",title:"MA5: ",type:"line"},{key:"ma2",title:"MA10: ",type:"line"},{key:"ma3",title:"MA20: ",type:"line"},{key:"volume",title:"VOLUME: ",type:"bar",baseValue:0,styles:function(n,t,e){var o=n.current.kLineData;return{color:o.close>o.open?$(t.styles,"bars[0].upColor",e.bars[0].upColor):o.open>o.close?$(t.styles,"bars[0].downColor",e.bars[0].downColor):$(t.styles,"bars[0].noChangeColor",e.bars[0].noChangeColor)}}}],regenerateFigures:function(n){var t=n.map(function(e,o){return{key:"ma".concat(o+1),title:"MA".concat(e,": "),type:"line"}});return t.push({key:"volume",title:"VOLUME: ",type:"bar",baseValue:0,styles:function(e,o,i){var r=e.current.kLineData;return{color:r.close>r.open?$(o.styles,"bars[0].upColor",i.bars[0].upColor):r.open>r.close?$(o.styles,"bars[0].downColor",i.bars[0].downColor):$(o.styles,"bars[0].noChangeColor",i.bars[0].noChangeColor)}}}),t},calc:function(n,t){var e=t.calcParams,o=t.figures,i=[];return n.map(function(r,a){var s,l=(s=r.volume)!==null&&s!==void 0?s:0,c={volume:l};return e.forEach(function(u,h){var d,p;i[h]=((d=i[h])!==null&&d!==void 0?d:0)+l,u-1>a||(c[o[h].key]=i[h]/u,i[h]-=(p=n[a-(u-1)].volume)!==null&&p!==void 0?p:0)}),c})}},no={name:"WR",shortName:"WR",calcParams:[6,10,14],figures:[{key:"wr1",title:"WR1: ",type:"line"},{key:"wr2",title:"WR2: ",type:"line"},{key:"wr3",title:"WR3: ",type:"line"}],regenerateFigures:function(n){return n.map(function(t,e){return{key:"wr".concat(e+1),title:"WR".concat(e+1,": "),type:"line"}})},calc:function(n,t){var e=t.calcParams,o=t.figures;return n.map(function(i,r){var a={},s=i.close;return e.forEach(function(l,c){var u=l-1;if(r>=u){var h=qe(n.slice(r-u,r+1),"high","low"),d=h[0],p=d-h[1];a[o[c].key]=p===0?0:(s-d)/p*100}}),a})}},le={},ro=[Ji,{name:"AO",shortName:"AO",calcParams:[5,34],figures:[{key:"ao",title:"AO: ",type:"bar",baseValue:0,styles:function(n,t,e){var o,i,r,a,s,l=(i=(o=n.prev.indicatorData)===null||o===void 0?void 0:o.ao)!==null&&i!==void 0?i:Number.MIN_SAFE_INTEGER,c=(a=(r=n.current.indicatorData)===null||r===void 0?void 0:r.ao)!==null&&a!==void 0?a:Number.MIN_SAFE_INTEGER;return{color:s=c>l?$(t.styles,"bars[0].upColor",e.bars[0].upColor):$(t.styles,"bars[0].downColor",e.bars[0].downColor),style:c>l?f.PolygonType.Stroke:f.PolygonType.Fill,borderColor:s}}}],calc:function(n,t){var e=t.calcParams,o=Math.max(e[0],e[1]),i=0,r=0,a=0,s=0;return n.map(function(l,c){var u,h={},d=(l.low+l.high)/2;return i+=d,r+=d,c<e[0]-1||(a=i/e[0],i-=((u=n[c-(e[0]-1)]).low+u.high)/2),c<e[1]-1||(s=r/e[1],r-=((u=n[c-(e[1]-1)]).low+u.high)/2),o-1>c||(h.ao=a-s),h})}},{name:"BIAS",shortName:"BIAS",calcParams:[6,12,24],figures:[{key:"bias1",title:"BIAS6: ",type:"line"},{key:"bias2",title:"BIAS12: ",type:"line"},{key:"bias3",title:"BIAS24: ",type:"line"}],regenerateFigures:function(n){return n.map(function(t,e){return{key:"bias".concat(e+1),title:"BIAS".concat(t,": "),type:"line"}})},calc:function(n,t){var e=t.calcParams,o=t.figures,i=[];return n.map(function(r,a){var s={},l=r.close;return e.forEach(function(c,u){var h;if(i[u]=((h=i[u])!==null&&h!==void 0?h:0)+l,a>=c-1){var d=i[u]/e[u];s[o[u].key]=(l-d)/d*100,i[u]-=n[a-(c-1)].close}}),s})}},{name:"BOLL",shortName:"BOLL",series:f.IndicatorSeries.Price,calcParams:[20,2],precision:2,shouldOhlc:!0,figures:[{key:"up",title:"UP: ",type:"line"},{key:"mid",title:"MID: ",type:"line"},{key:"dn",title:"DN: ",type:"line"}],calc:function(n,t){var e=t.calcParams,o=e[0]-1,i=0;return n.map(function(r,a){var s={};if(i+=r.close,a>=o){s.mid=i/e[0];var l=function(c,u){var h=c.length,d=0;return c.forEach(function(p){var v=p.close-u;d+=v*v}),Math.sqrt((d=Math.abs(d))/h)}(n.slice(a-o,a+1),s.mid);s.up=s.mid+e[1]*l,s.dn=s.mid-e[1]*l,i-=n[a-o].close}return s})}},{name:"BRAR",shortName:"BRAR",calcParams:[26],figures:[{key:"br",title:"BR: ",type:"line"},{key:"ar",title:"AR: ",type:"line"}],calc:function(n,t){var e=t.calcParams,o=0,i=0,r=0,a=0;return n.map(function(s,l){var c,u,h={},d=s.high,p=s.low,v=s.open,g=((c=n[l-1])!==null&&c!==void 0?c:s).close;if(r+=d-v,a+=v-p,o+=d-g,i+=g-p,l>=e[0]-1){h.ar=a!==0?r/a*100:0,h.br=i!==0?o/i*100:0;var m=n[l-(e[0]-1)],y=m.high,_=m.low,x=m.open,S=((u=n[l-e[0]])!==null&&u!==void 0?u:n[l-(e[0]-1)]).close;o-=y-S,i-=S-_,r-=y-x,a-=x-_}return h})}},{name:"BBI",shortName:"BBI",series:f.IndicatorSeries.Price,precision:2,calcParams:[3,6,12,24],shouldOhlc:!0,figures:[{key:"bbi",title:"BBI: ",type:"line"}],calc:function(n,t){var e=t.calcParams,o=Math.max.apply(Math,He([],it(e),!1)),i=[],r=[];return n.map(function(a,s){var l={},c=a.close;if(e.forEach(function(h,d){var p;i[d]=((p=i[d])!==null&&p!==void 0?p:0)+c,h-1>s||(r[d]=i[d]/h,i[d]-=n[s-(h-1)].close)}),s>=o-1){var u=0;r.forEach(function(h){u+=h}),l.bbi=u/4}return l})}},{name:"CCI",shortName:"CCI",calcParams:[20],figures:[{key:"cci",title:"CCI: ",type:"line"}],calc:function(n,t){var e=t.calcParams,o=e[0]-1,i=0,r=[];return n.map(function(a,s){var l={},c=(a.high+a.low+a.close)/3;if(i+=c,r.push(c),s>=o){var u=i/e[0],h=r.slice(s-o,s+1),d=0;h.forEach(function(v){d+=Math.abs(v-u)});var p=d/e[0];l.cci=p!==0?(c-u)/p/.015:0,i-=(n[s-o].high+n[s-o].low+n[s-o].close)/3}return l})}},{name:"CR",shortName:"CR",calcParams:[26,10,20,40,60],figures:[{key:"cr",title:"CR: ",type:"line"},{key:"ma1",title:"MA1: ",type:"line"},{key:"ma2",title:"MA2: ",type:"line"},{key:"ma3",title:"MA3: ",type:"line"},{key:"ma4",title:"MA4: ",type:"line"}],calc:function(n,t){var e=t.calcParams,o=Math.ceil(e[1]/2.5+1),i=Math.ceil(e[2]/2.5+1),r=Math.ceil(e[3]/2.5+1),a=Math.ceil(e[4]/2.5+1),s=0,l=[],c=0,u=[],h=0,d=[],p=0,v=[],g=[];return n.forEach(function(m,y){var _,x,S,C,T,b={},w=(_=n[y-1])!==null&&_!==void 0?_:m,E=(w.high+w.close+w.low+w.open)/4,D=Math.max(0,m.high-E),I=Math.max(0,E-m.low);e[0]-1>y||(b.cr=I!==0?D/I*100:0,s+=b.cr,c+=b.cr,h+=b.cr,p+=b.cr,e[0]+e[1]-2>y||(l.push(s/e[1]),e[0]+e[1]+o-3>y||(b.ma1=l[l.length-1-o]),s-=(x=g[y-(e[1]-1)].cr)!==null&&x!==void 0?x:0),e[0]+e[2]-2>y||(u.push(c/e[2]),e[0]+e[2]+i-3>y||(b.ma2=u[u.length-1-i]),c-=(S=g[y-(e[2]-1)].cr)!==null&&S!==void 0?S:0),e[0]+e[3]-2>y||(d.push(h/e[3]),e[0]+e[3]+r-3>y||(b.ma3=d[d.length-1-r]),h-=(C=g[y-(e[3]-1)].cr)!==null&&C!==void 0?C:0),e[0]+e[4]-2>y||(v.push(p/e[4]),e[0]+e[4]+a-3>y||(b.ma4=v[v.length-1-a]),p-=(T=g[y-(e[4]-1)].cr)!==null&&T!==void 0?T:0)),g.push(b)}),g}},{name:"DMA",shortName:"DMA",calcParams:[10,50,10],figures:[{key:"dma",title:"DMA: ",type:"line"},{key:"ama",title:"AMA: ",type:"line"}],calc:function(n,t){var e=t.calcParams,o=Math.max(e[0],e[1]),i=0,r=0,a=0,s=[];return n.forEach(function(l,c){var u,h={},d=l.close;i+=d,r+=d;var p=0,v=0;if(e[0]-1>c||(p=i/e[0],i-=n[c-(e[0]-1)].close),e[1]-1>c||(v=r/e[1],r-=n[c-(e[1]-1)].close),c>=o-1){var g=p-v;h.dma=g,a+=g,o+e[2]-2>c||(h.ama=a/e[2],a-=(u=s[c-(e[2]-1)].dma)!==null&&u!==void 0?u:0)}s.push(h)}),s}},{name:"DMI",shortName:"DMI",calcParams:[14,6],figures:[{key:"pdi",title:"PDI: ",type:"line"},{key:"mdi",title:"MDI: ",type:"line"},{key:"adx",title:"ADX: ",type:"line"},{key:"adxr",title:"ADXR: ",type:"line"}],calc:function(n,t){var e=t.calcParams,o=0,i=0,r=0,a=0,s=0,l=0,c=0,u=0,h=[];return n.forEach(function(d,p){var v,g,m={},y=(v=n[p-1])!==null&&v!==void 0?v:d,_=y.close,x=d.high,S=d.low,C=x-S,T=Math.abs(x-_),b=Math.abs(_-S),w=x-y.high,E=y.low-S,D=Math.max(Math.max(C,T),b),I=w>0&&w>E?w:0,M=E>0&&E>w?E:0;if(o+=D,i+=I,r+=M,p>=e[0]-1){p>e[0]-1?(a=a-a/e[0]+D,s=s-s/e[0]+I,l=l-l/e[0]+M):(a=o,s=i,l=r);var F=0,L=0;a!==0&&(F=100*s/a,L=100*l/a),m.pdi=F,m.mdi=L;var O=0;L+F!==0&&(O=Math.abs(L-F)/(L+F)*100),c+=O,2*e[0]-2>p||(m.adx=u=p>2*e[0]-2?(u*(e[0]-1)+O)/e[0]:c/e[0],2*e[0]+e[1]-3>p||(m.adxr=(((g=h[p-(e[1]-1)].adx)!==null&&g!==void 0?g:0)+u)/2))}h.push(m)}),h}},{name:"EMV",shortName:"EMV",calcParams:[14,9],figures:[{key:"emv",title:"EMV: ",type:"line"},{key:"maEmv",title:"MAEMV: ",type:"line"}],calc:function(n,t){var e=t.calcParams,o=0,i=[];return n.map(function(r,a){var s,l={};if(a>0){var c=n[a-1],u=r.high,h=r.low,d=(s=r.volume)!==null&&s!==void 0?s:0,p=(u+h)/2-(c.high+c.low)/2;d===0||u-h==0?l.emv=0:l.emv=p/(d/1e8/(u-h)),o+=l.emv,i.push(l.emv),e[0]>a||(l.maEmv=o/e[0],o-=i[a-e[0]])}return l})}},to,{name:"MTM",shortName:"MTM",calcParams:[12,6],figures:[{key:"mtm",title:"MTM: ",type:"line"},{key:"maMtm",title:"MAMTM: ",type:"line"}],calc:function(n,t){var e=t.calcParams,o=0,i=[];return n.forEach(function(r,a){var s,l={};a<e[0]||(l.mtm=r.close-n[a-e[0]].close,o+=l.mtm,e[0]+e[1]-1>a||(l.maMtm=o/e[1],o-=(s=i[a-(e[1]-1)].mtm)!==null&&s!==void 0?s:0)),i.push(l)}),i}},eo,{name:"MACD",shortName:"MACD",calcParams:[12,26,9],figures:[{key:"dif",title:"DIF: ",type:"line"},{key:"dea",title:"DEA: ",type:"line"},{key:"macd",title:"MACD: ",type:"bar",baseValue:0,styles:function(n,t,e){var o,i,r,a,s,l=(i=(o=n.prev.indicatorData)===null||o===void 0?void 0:o.macd)!==null&&i!==void 0?i:Number.MIN_SAFE_INTEGER,c=(a=(r=n.current.indicatorData)===null||r===void 0?void 0:r.macd)!==null&&a!==void 0?a:Number.MIN_SAFE_INTEGER;return s=c>0?$(t.styles,"bars[0].upColor",e.bars[0].upColor):0>c?$(t.styles,"bars[0].downColor",e.bars[0].downColor):$(t.styles,"bars[0].noChangeColor",e.bars[0].noChangeColor),{style:c>l?f.PolygonType.Stroke:f.PolygonType.Fill,color:s,borderColor:s}}}],calc:function(n,t){var e,o,i=t.calcParams,r=0,a=0,s=0,l=0,c=Math.max(i[0],i[1]);return n.map(function(u,h){var d={},p=u.close;return r+=p,i[0]-1>h||(e=h>i[0]-1?(2*p+(i[0]-1)*e)/(i[0]+1):r/i[0]),i[1]-1>h||(o=h>i[1]-1?(2*p+(i[1]-1)*o)/(i[1]+1):r/i[1]),c-1>h||(d.dif=a=e-o,s+=a,c+i[2]-2>h||(d.macd=2*(a-(l=h>c+i[2]-2?(2*a+l*(i[2]-1))/(i[2]+1):s/i[2])),d.dea=l)),d})}},{name:"OBV",shortName:"OBV",calcParams:[30],figures:[{key:"obv",title:"OBV: ",type:"line"},{key:"maObv",title:"MAOBV: ",type:"line"}],calc:function(n,t){var e=t.calcParams,o=0,i=0,r=[];return n.forEach(function(a,s){var l,c,u,h,d=(l=n[s-1])!==null&&l!==void 0?l:a;d.close>a.close?i-=(c=a.volume)!==null&&c!==void 0?c:0:a.close>d.close&&(i+=(u=a.volume)!==null&&u!==void 0?u:0);var p={obv:i};o+=i,e[0]-1>s||(p.maObv=o/e[0],o-=(h=r[s-(e[0]-1)].obv)!==null&&h!==void 0?h:0),r.push(p)}),r}},{name:"PVT",shortName:"PVT",figures:[{key:"pvt",title:"PVT: ",type:"line"}],calc:function(n){var t=0;return n.map(function(e,o){var i,r,a={},s=(i=e.volume)!==null&&i!==void 0?i:1,l=((r=n[o-1])!==null&&r!==void 0?r:e).close,c=0,u=l*s;return u!==0&&(c=(e.close-l)/u),a.pvt=t+=c,a})}},{name:"PSY",shortName:"PSY",calcParams:[12,6],figures:[{key:"psy",title:"PSY: ",type:"line"},{key:"maPsy",title:"MAPSY: ",type:"line"}],calc:function(n,t){var e=t.calcParams,o=0,i=0,r=[],a=[];return n.forEach(function(s,l){var c,u,h={},d=((c=n[l-1])!==null&&c!==void 0?c:s).close,p=s.close-d>0?1:0;r.push(p),o+=p,e[0]-1>l||(h.psy=o/e[0]*100,i+=h.psy,e[0]+e[1]-2>l||(h.maPsy=i/e[1],i-=(u=a[l-(e[1]-1)].psy)!==null&&u!==void 0?u:0),o-=r[l-(e[0]-1)]),a.push(h)}),a}},{name:"ROC",shortName:"ROC",calcParams:[12,6],figures:[{key:"roc",title:"ROC: ",type:"line"},{key:"maRoc",title:"MAROC: ",type:"line"}],calc:function(n,t){var e=t.calcParams,o=[],i=0;return n.forEach(function(r,a){var s,l,c={};if(a>=e[0]-1){var u=((s=n[a-e[0]])!==null&&s!==void 0?s:n[a-(e[0]-1)]).close;c.roc=u!==0?(r.close-u)/u*100:0,i+=c.roc,e[0]-1+e[1]-1>a||(c.maRoc=i/e[1],i-=(l=o[a-(e[1]-1)].roc)!==null&&l!==void 0?l:0)}o.push(c)}),o}},io,{name:"SMA",shortName:"SMA",series:f.IndicatorSeries.Price,calcParams:[12,2],precision:2,figures:[{key:"sma",title:"SMA: ",type:"line"}],shouldOhlc:!0,calc:function(n,t){var e=t.calcParams,o=0,i=0;return n.map(function(r,a){var s={},l=r.close;return o+=l,e[0]-1>a||(s.sma=i=a>e[0]-1?(l*e[1]+i*(e[0]-e[1]+1))/(e[0]+1):o/e[0]),s})}},{name:"KDJ",shortName:"KDJ",calcParams:[9,3,3],figures:[{key:"k",title:"K: ",type:"line"},{key:"d",title:"D: ",type:"line"},{key:"j",title:"J: ",type:"line"}],calc:function(n,t){var e=t.calcParams,o=[];return n.forEach(function(i,r){var a,s,l,c,u={},h=i.close;if(r>=e[0]-1){var d=qe(n.slice(r-(e[0]-1),r+1),"high","low"),p=d[1],v=d[0]-p;u.k=((e[1]-1)*((s=(a=o[r-1])===null||a===void 0?void 0:a.k)!==null&&s!==void 0?s:50)+(h-p)/(v===0?1:v)*100)/e[1],u.d=((e[2]-1)*((c=(l=o[r-1])===null||l===void 0?void 0:l.d)!==null&&c!==void 0?c:50)+u.k)/e[2],u.j=3*u.k-2*u.d}o.push(u)}),o}},{name:"SAR",shortName:"SAR",series:f.IndicatorSeries.Price,calcParams:[2,2,20],precision:2,shouldOhlc:!0,figures:[{key:"sar",title:"SAR: ",type:"circle",styles:function(n,t,e){var o,i,r=n.current,a=(i=(o=r.indicatorData)===null||o===void 0?void 0:o.sar)!==null&&i!==void 0?i:Number.MIN_SAFE_INTEGER,s=r.kLineData;return{color:((s==null?void 0:s.high)+(s==null?void 0:s.low))/2>a?$(t.styles,"circles[0].upColor",e.circles[0].upColor):$(t.styles,"circles[0].downColor",e.circles[0].downColor)}}}],calc:function(n,t){var e=t.calcParams,o=e[0]/100,i=e[1]/100,r=e[2]/100,a=o,s=-100,l=!1,c=0;return n.map(function(u,h){var d=c,p=u.high,v=u.low;if(l){(s===-100||p>s)&&(s=p,a=Math.min(a+i,r)),c=d+a*(s-d);var g=Math.min(n[Math.max(1,h)-1].low,v);c>u.low?(c=s,a=o,s=-100,l=!l):c>g&&(c=g)}else{(s===-100||s>v)&&(s=v,a=Math.min(a+i,r)),c=d+a*(s-d);var m=Math.max(n[Math.max(1,h)-1].high,p);u.high>c?(c=s,a=0,s=-100,l=!l):m>c&&(c=m)}return{sar:c}})}},{name:"TRIX",shortName:"TRIX",calcParams:[12,9],figures:[{key:"trix",title:"TRIX: ",type:"line"},{key:"maTrix",title:"MATRIX: ",type:"line"}],calc:function(n,t){var e,o,i,r=t.calcParams,a=0,s=0,l=0,c=0,u=[];return n.forEach(function(h,d){var p,v={},g=h.close;if(a+=g,d>=r[0]-1&&(s+=e=d>r[0]-1?(2*g+(r[0]-1)*e)/(r[0]+1):a/r[0],d>=2*r[0]-2&&(l+=o=d>2*r[0]-2?(2*e+(r[0]-1)*o)/(r[0]+1):s/r[0],d>=3*r[0]-3))){var m=void 0,y=0;d>3*r[0]-3?y=((m=(2*o+(r[0]-1)*i)/(r[0]+1))-i)/i*100:m=l/r[0],i=m,v.trix=y,c+=y,3*r[0]+r[1]-4>d||(v.maTrix=c/r[1],c-=(p=u[d-(r[1]-1)].trix)!==null&&p!==void 0?p:0)}u.push(v)}),u}},oo,{name:"VR",shortName:"VR",calcParams:[26,6],figures:[{key:"vr",title:"VR: ",type:"line"},{key:"maVr",title:"MAVR: ",type:"line"}],calc:function(n,t){var e=t.calcParams,o=0,i=0,r=0,a=0,s=[];return n.forEach(function(l,c){var u,h,d,p,v,g={},m=l.close,y=((u=n[c-1])!==null&&u!==void 0?u:l).close,_=(h=l.volume)!==null&&h!==void 0?h:0;if(m>y?o+=_:y>m?i+=_:r+=_,c>=e[0]-1){var x=r/2;g.vr=i+x===0?0:(o+x)/(i+x)*100,a+=g.vr,e[0]+e[1]-2>c||(g.maVr=a/e[1],a-=(d=s[c-(e[1]-1)].vr)!==null&&d!==void 0?d:0);var S=n[c-(e[0]-1)],C=(p=n[c-e[0]])!==null&&p!==void 0?p:S,T=S.close,b=(v=S.volume)!==null&&v!==void 0?v:0;T>C.close?o-=b:C.close>T?i-=b:r-=b}s.push(g)}),s}},no];function $e(n){var t;return(t=le[n])!==null&&t!==void 0?t:null}ro.forEach(function(n){le[n.name]=Ge.extend(n)});var Te,ao=function(){function n(t){this._instances=new Map,this._chartStore=t}return n.prototype._overrideInstance=function(t,e){var o=e.shortName,i=e.series,r=e.calcParams,a=e.precision,s=e.figures,l=e.minValue,c=e.maxValue,u=e.shouldOhlc,h=e.shouldFormatBigNumber,d=e.visible,p=e.styles,v=e.extendData,g=e.regenerateFigures,m=e.createTooltipDataSource,y=e.draw,_=e.calc,x=!1;o!==void 0&&t.setShortName(o)&&(x=!0),i!==void 0&&t.setSeries(i)&&(x=!0);var S=!1;return r!==void 0&&t.setCalcParams(r)&&(x=!0,S=!0),s!==void 0&&t.setFigures(s)&&(x=!0,S=!0),l!==void 0&&t.setMinValue(l)&&(x=!0),c!==void 0&&t.setMinValue(c)&&(x=!0),a!==void 0&&t.setPrecision(a)&&(x=!0),u!==void 0&&t.setShouldOhlc(u)&&(x=!0),h!==void 0&&t.setShouldFormatBigNumber(h)&&(x=!0),d!==void 0&&t.setVisible(d)&&(x=!0),p!==void 0&&t.setStyles(p)&&(x=!0),v!==void 0&&t.setExtendData(v)&&(x=!0,S=!0),g!==void 0&&t.setRegenerateFigures(g)&&(x=!0),m!==void 0&&t.setCreateTooltipDataSource(m)&&(x=!0),y!==void 0&&t.setDraw(y)&&(x=!0),_!==void 0&&(t.calc=_,S=!0),[x,S]},n.prototype.addInstance=function(t,e,o){var i;return re(this,void 0,void 0,function(){var r,a,s,l;return ae(this,function(c){switch(c.label){case 0:return r=t.name,a=this._instances.get(e),(i=a==null?void 0:a.has(r))!==null&&i!==void 0&&i?[4,Promise.reject(Error("Duplicate indicators."))]:[3,2];case 1:case 3:return[2,c.sent()];case 2:return a===void 0&&(a=new Map,this._instances.set(e,a)),s=$e(r),l=new s,this._overrideInstance(l,t),o||a.clear(),a.set(r,l),[4,l.calcIndicator(this._chartStore.getDataList())]}})})},n.prototype.getInstances=function(t){var e;return(e=this._instances.get(t))!==null&&e!==void 0?e:new Map},n.prototype.removeInstance=function(t,e){var o=!1,i=this._instances.get(t);return i!==void 0&&(e!==void 0?i.has(e)&&(i.delete(e),o=!0):(i.clear(),o=!0),i.size===0&&this._instances.delete(t)),o},n.prototype.hasInstances=function(t){return this._instances.has(t)},n.prototype.calcInstance=function(t,e){var o;return re(this,void 0,void 0,function(){var i,r,a,s=this;return ae(this,function(l){switch(l.label){case 0:return i=[],t!==void 0?e!==void 0?(r=this._instances.get(e),(o=r==null?void 0:r.has(t))!==null&&o!==void 0&&o&&(a=r==null?void 0:r.get(t),i.push(a.calcIndicator(this._chartStore.getDataList())))):this._instances.forEach(function(c){if(c.has(t)){var u=c==null?void 0:c.get(t);i.push(u.calcIndicator(s._chartStore.getDataList()))}}):this._instances.forEach(function(c){c.forEach(function(u){i.push(u.calcIndicator(s._chartStore.getDataList()))})}),[4,Promise.all(i)];case 1:return[2,l.sent().includes(!0)]}})})},n.prototype.getInstanceByPaneId=function(t,e){var o;if(t!==void 0){var i=this._instances.get(t);return e!==void 0?(o=i==null?void 0:i.get(e))!==null&&o!==void 0?o:null:i!=null?i:null}return this._instances},n.prototype.setSeriesPrecision=function(t){this._instances.forEach(function(e){e.forEach(function(o){o.series===f.IndicatorSeries.Price&&o.setPrecision(t.price,!0),o.series===f.IndicatorSeries.Volume&&o.setPrecision(t.volume,!0)})})},n.prototype.override=function(t,e){return re(this,void 0,void 0,function(){var o,i,r,a,s,l,c=this;return ae(this,function(u){switch(u.label){case 0:return o=t.name,i=new Map,e!==null?(r=this._instances.get(e))!==void 0&&i.set(e,r):i=this._instances,a=!1,s=[],i.forEach(function(h){var d=h.get(o);if(d!==void 0){var p=c._overrideInstance(d,t);p[1]?s.push(d.calcIndicator(c._chartStore.getDataList())):p[0]&&(a=!0)}}),[4,Promise.all(s)];case 1:return l=u.sent(),[2,[a,l.includes(!0)]]}})})},n}(),so=function(){function n(t){this._crosshair={},this._activeIcon=null,this._chartStore=t}return n.prototype.setCrosshair=function(t,e){var o,i,r=this._chartStore.getDataList(),a=t!=null?t:{},s=r[i=a.x!==void 0?0>(o=this._chartStore.getTimeScaleStore().coordinateToDataIndex(a.x))?0:o>r.length-1?r.length-1:o:o=r.length-1],l=this._chartStore.getTimeScaleStore().dataIndexToCoordinate(o),c=this._crosshair.x,u=this._crosshair.y,h=this._crosshair.paneId;this._crosshair=P(P({},a),{realX:l,kLineData:s,realDataIndex:o,dataIndex:i}),c===a.x&&u===a.y&&h===a.paneId||(s!==null&&this._chartStore.getChart().crosshairChange(this._crosshair),e!=null&&e||this._chartStore.getChart().updatePane(1))},n.prototype.recalculateCrosshair=function(t){this.setCrosshair(this._crosshair,t)},n.prototype.getCrosshair=function(){return this._crosshair},n.prototype.setActiveIcon=function(t){this._activeIcon=t!=null?t:null},n.prototype.getActiveIcon=function(){return this._activeIcon},n.prototype.clear=function(){this.setCrosshair({},!0),this.setActiveIcon()},n}();f.OverlayMode=void 0,(Te=f.OverlayMode||(f.OverlayMode={})).Normal="normal",Te.WeakMagnet="weak_magnet",Te.StrongMagnet="strong_magnet";var zt="overlay_figure_",lo=Number.MAX_SAFE_INTEGER,Ke=function(){function n(t){this.currentStep=1,this.points=[],this._prevPressedPoint=null,this._prevPressedPoints=[];var e=t.mode,o=t.modeSensitivity,i=t.extendData,r=t.styles,a=t.totalStep,s=t.lock,l=t.visible,c=t.zLevel,u=t.needDefaultPointFigure,h=t.needDefaultXAxisFigure,d=t.needDefaultYAxisFigure,p=t.createPointFigures,v=t.createXAxisFigures,g=t.createYAxisFigures,m=t.performEventPressedMove,y=t.performEventMoveForDrawing,_=t.onDrawStart,x=t.onDrawing,S=t.onDrawEnd,C=t.onClick,T=t.onDoubleClick,b=t.onRightClick,w=t.onPressedMoveStart,E=t.onPressedMoving,D=t.onPressedMoveEnd,I=t.onMouseEnter,M=t.onMouseLeave,F=t.onRemoved,L=t.onSelected,O=t.onDeselected;this.name=t.name,this.totalStep=a===void 0||2>a?1:a,this.lock=s!=null&&s,this.visible=l==null||l,this.zLevel=c!=null?c:0,this.needDefaultPointFigure=u!=null&&u,this.needDefaultXAxisFigure=h!=null&&h,this.needDefaultYAxisFigure=d!=null&&d,this.mode=e!=null?e:f.OverlayMode.Normal,this.modeSensitivity=o!=null?o:8,this.extendData=i,this.styles=r!=null?r:{},this.createPointFigures=p!=null?p:null,this.createXAxisFigures=v!=null?v:null,this.createYAxisFigures=g!=null?g:null,this.performEventPressedMove=m!=null?m:null,this.performEventMoveForDrawing=y!=null?y:null,this.onDrawStart=_!=null?_:null,this.onDrawing=x!=null?x:null,this.onDrawEnd=S!=null?S:null,this.onClick=C!=null?C:null,this.onDoubleClick=T!=null?T:null,this.onRightClick=b!=null?b:null,this.onPressedMoveStart=w!=null?w:null,this.onPressedMoving=E!=null?E:null,this.onPressedMoveEnd=D!=null?D:null,this.onMouseEnter=I!=null?I:null,this.onMouseLeave=M!=null?M:null,this.onRemoved=F!=null?F:null,this.onSelected=L!=null?L:null,this.onDeselected=O!=null?O:null}return n.prototype.setId=function(t){return this.id===void 0&&(this.id=t,!0)},n.prototype.setGroupId=function(t){return this.groupId===void 0&&(this.groupId=t,!0)},n.prototype.setDefaultZLevel=function(t){return this.defaultZLevel===void 0&&(this.defaultZLevel=t,!0)},n.prototype.setPaneId=function(t){this.paneId=t},n.prototype.setExtendData=function(t){return t!==this.extendData&&(this.extendData=t,!0)},n.prototype.setStyles=function(t){return t!==null&&(j(this.styles,t),!0)},n.prototype.setPoints=function(t){if(t.length>0){var e=void 0;if(this.points=He([],it(t),!1),this.totalStep-1>t.length?(this.currentStep=t.length+1,e=t.length):(this.currentStep=-1,e=this.totalStep-1),this.performEventMoveForDrawing!==null)for(var o=0;e>o;o++)this.performEventMoveForDrawing({currentStep:o+2,mode:this.mode,points:this.points,performPointIndex:o,performPoint:this.points[o]});return this.currentStep===-1&&this.performEventPressedMove!==null&&this.performEventPressedMove({currentStep:this.currentStep,mode:this.mode,points:this.points,performPointIndex:this.points.length-1,performPoint:this.points[this.points.length-1]}),!0}return!1},n.prototype.setLock=function(t){return this.lock!==t&&(this.lock=t,!0)},n.prototype.setVisible=function(t){return this.visible!==t&&(this.visible=t,!0)},n.prototype.resetZLevel=function(){this.zLevel=this.defaultZLevel},n.prototype.setZLevel=function(t){return this.zLevel!==t&&(this.zLevel=t,!0)},n.prototype.setMode=function(t){return this.mode!==t&&(this.mode=t,!0)},n.prototype.setModeSensitivity=function(t){return this.modeSensitivity!==t&&(this.modeSensitivity=t,!0)},n.prototype.setOnDrawStartCallback=function(t){return this.onDrawStart!==t&&(this.onDrawStart=t,!0)},n.prototype.setOnDrawingCallback=function(t){return this.onDrawing!==t&&(this.onDrawing=t,!0)},n.prototype.setOnDrawEndCallback=function(t){return this.onDrawEnd!==t&&(this.onDrawEnd=t,!0)},n.prototype.setOnClickCallback=function(t){return this.onClick!==t&&(this.onClick=t,!0)},n.prototype.setOnDoubleClickCallback=function(t){return this.onDoubleClick!==t&&(this.onDoubleClick=t,!0)},n.prototype.setOnRightClickCallback=function(t){return this.onRightClick!==t&&(this.onRightClick=t,!0)},n.prototype.setOnPressedMoveStartCallback=function(t){return this.onPressedMoveStart!==t&&(this.onPressedMoveStart=t,!0)},n.prototype.setOnPressedMovingCallback=function(t){return this.onPressedMoving!==t&&(this.onPressedMoving=t,!0)},n.prototype.setOnPressedMoveEndCallback=function(t){return this.onPressedMoveEnd!==t&&(this.onPressedMoveEnd=t,!0)},n.prototype.setOnMouseEnterCallback=function(t){return this.onMouseEnter!==t&&(this.onMouseEnter=t,!0)},n.prototype.setOnMouseLeaveCallback=function(t){return this.onMouseLeave!==t&&(this.onMouseLeave=t,!0)},n.prototype.setOnRemovedCallback=function(t){return this.onRemoved!==t&&(this.onRemoved=t,!0)},n.prototype.setOnSelectedCallback=function(t){return this.onSelected!==t&&(this.onSelected=t,!0)},n.prototype.setOnDeselectedCallback=function(t){return this.onDeselected!==t&&(this.onDeselected=t,!0)},n.prototype.nextStep=function(){this.currentStep===this.totalStep-1?this.currentStep=-1:this.currentStep++},n.prototype.forceComplete=function(){this.currentStep=-1},n.prototype.isDrawing=function(){return this.currentStep!==-1},n.prototype.isStart=function(){return this.currentStep===1},n.prototype.eventMoveForDrawing=function(t){var e,o=this.currentStep-1,i={};t.timestamp!==void 0&&(i.timestamp=t.timestamp),t.dataIndex!==void 0&&(i.dataIndex=t.dataIndex),t.value!==void 0&&(i.value=t.value),this.points[o]=i,(e=this.performEventMoveForDrawing)===null||e===void 0||e.call(this,{currentStep:this.currentStep,mode:this.mode,points:this.points,performPointIndex:o,performPoint:i})},n.prototype.eventPressedPointMove=function(t,e){var o;t.dataIndex!==void 0&&(this.points[e].dataIndex=t.dataIndex,this.points[e].timestamp=t.timestamp),t.value!==void 0&&(this.points[e].value=t.value),(o=this.performEventPressedMove)===null||o===void 0||o.call(this,{currentStep:this.currentStep,points:this.points,mode:this.mode,performPointIndex:e,performPoint:this.points[e]})},n.prototype.startPressedMove=function(t){this._prevPressedPoint=P({},t),this._prevPressedPoints=Z(this.points)},n.prototype.eventPressedOtherMove=function(t,e){var o,i;this._prevPressedPoint!==null&&(t.dataIndex!==void 0&&this._prevPressedPoint.dataIndex!==void 0&&(o=t.dataIndex-this._prevPressedPoint.dataIndex),t.value!==void 0&&this._prevPressedPoint.value!==void 0&&(i=t.value-this._prevPressedPoint.value),this.points=this._prevPressedPoints.map(function(r){var a;r.dataIndex===void 0&&r.timestamp!==void 0&&(r.dataIndex=e.timestampToDataIndex(r.timestamp));var s=P({},r);return o!==void 0&&r.dataIndex!==void 0&&(s.dataIndex=r.dataIndex+o,s.timestamp=(a=e.dataIndexToTimestamp(s.dataIndex))!==null&&a!==void 0?a:void 0),i!==void 0&&r.value!==void 0&&(s.value=r.value+i),s}))},n.extend=function(t){return function(e){function o(){return e.call(this,t)||this}return B(o,e),o}(n)},n}(),co={name:"fibonacciLine",totalStep:3,needDefaultPointFigure:!0,needDefaultXAxisFigure:!0,needDefaultYAxisFigure:!0,createPointFigures:function(n){var t=n.coordinates,e=n.precision,o=n.thousandsSeparator,i=n.overlay.points;if(t.length>0){var r=[],a=[],s=n.bounding.width;if(t.length>1&&i[0].value!==void 0&&i[1].value!==void 0){var l=t[0].y-t[1].y,c=i[0].value-i[1].value;[1,.786,.618,.5,.382,.236,0].forEach(function(u){var h,d=t[1].y+l*u,p=J((((h=i[1].value)!==null&&h!==void 0?h:0)+c*u).toFixed(e.price),o);r.push({coordinates:[{x:0,y:d},{x:s,y:d}]}),a.push({x:0,y:d,text:"".concat(p," (").concat((100*u).toFixed(1),"%)"),baseline:"bottom"})})}return[{type:"line",attrs:r},{type:"text",isCheckEvent:!1,attrs:a}]}return[]}},uo={name:"horizontalRayLine",totalStep:3,needDefaultPointFigure:!0,needDefaultXAxisFigure:!0,needDefaultYAxisFigure:!0,createPointFigures:function(n){var t=n.coordinates,e={x:0,y:t[0].y};return t[1]!==void 0&&t[1].x>t[0].x&&(e.x=n.bounding.width),[{type:"line",attrs:{coordinates:[t[0],e]}}]},performEventPressedMove:function(n){var t=n.points,e=n.performPoint;t[0].value=e.value,t[1].value=e.value},performEventMoveForDrawing:function(n){n.currentStep===2&&(n.points[0].value=n.performPoint.value)}},we=function(){function n(){this._children=[],this._callbacks=new Map}return n.prototype.registerEvent=function(t,e){return this._callbacks.set(t,e),this},n.prototype.onEvent=function(t,e,o){var i=this._callbacks.get(t);return!(i===void 0||!this.checkEventOn(e))&&i(e,o)},n.prototype.checkEventOn=function(t){var e,o;try{for(var i=qt(this._children),r=i.next();!r.done;r=i.next())if(r.value.checkEventOn(t))return!0}catch(a){e={error:a}}finally{try{r&&!r.done&&(o=i.return)&&o.call(i)}finally{if(e)throw e.error}}return!1},n.prototype.dispatchEvent=function(t,e,o){var i=this._children.length-1;if(i>-1){for(var r=i;r>-1;r--)if(this._children[r].dispatchEvent(t,e,o))return!0}return this.onEvent(t,e,o)},n.prototype.addChild=function(t){return this._children.push(t),this},n.prototype.clear=function(){this._children=[]},n}(),Ue=function(n){function t(e){var o=n.call(this)||this;return o.attrs=e.attrs,o.styles=e.styles,o}return B(t,n),t.prototype.checkEventOn=function(e){return this.checkEventOnImp(e,this.attrs,this.styles)},t.prototype.draw=function(e){this.drawImp(e,this.attrs,this.styles)},t.extend=function(e){var o=function(i){function r(){return i!==null&&i.apply(this,arguments)||this}return B(r,i),r.prototype.checkEventOnImp=function(a,s,l){return e.checkEventOn(a,s,l)},r.prototype.drawImp=function(a,s,l){e.draw(a,s,l)},r}(t);return o},t}(we);function Qe(n,t){return Math.sqrt(Math.pow(n.x+t.x,2)+Math.pow(n.y+t.y,2))}function ho(n){var t=Qe(n[0],n[1]),e=t+Qe(n[1],n[2]),o=[n[2].x-n[0].x,n[2].y-n[0].y];return[{x:n[1].x-.5*o[0]*t/e,y:n[1].y-.5*o[1]*t/e},{x:n[1].x+.5*o[0]*t/e,y:n[1].y+.5*o[1]*t/e}]}function Je(n,t){var e=t.coordinates;if(e.length>1)for(var o=1;e.length>o;o++){var i=e[o-1],r=e[o];if(i.x===r.x){if(4>Math.abs(i.y-n.y)+Math.abs(r.y-n.y)-Math.abs(i.y-r.y)&&2>Math.abs(n.x-i.x))return!0}else{var a=ce(i,r),s=Ee(a,n),l=Math.abs(s-n.y);if(4>Math.abs(i.x-n.x)+Math.abs(r.x-n.x)-Math.abs(i.x-r.x)&&4>l*l/(a[0]*a[0]+1))return!0}}return!1}function Ee(n,t){return n!=null?t.x*n[0]+n[1]:t.y}function Kt(n,t,e){return Ee(ce(n,t),e)}function ce(n,t){var e=n.x-t.x;if(e!==0){var o=(n.y-t.y)/e;return[o,n.y-o*n.x]}return null}function ti(n,t,e){var o=t.coordinates,i=o.length;if(i>1){var r=e.style,a=r===void 0?f.LineType.Solid:r,s=e.smooth,l=e.size,c=e.color,u=c===void 0?"currentColor":c,h=e.dashedValue,d=h===void 0?[2,2]:h;if(n.lineWidth=l===void 0?1:l,n.strokeStyle=u,n.setLineDash(a===f.LineType.Dashed?d:[]),n.beginPath(),n.moveTo(o[0].x,o[0].y),s!=null&&s){for(var p=[],v=1;i-1>v;v++)p=p.concat(ho([o[v-1],o[v],o[v+1]]));n.quadraticCurveTo(p[0].x,p[0].y,o[1].x,o[1].y);for(var g=2;i-1>g;g++)n.bezierCurveTo(p[2*(g-2)+1].x,p[2*(g-2)+1].y,p[2*(g-1)].x,p[2*(g-1)].y,o[g].x,o[g].y);n.quadraticCurveTo(p[2*(g-2)+1].x,p[2*(g-2)+1].y,o[g].x,o[g].y)}else for(g=1;o.length>g;g++)n.lineTo(o[g].x,o[g].y);n.stroke(),n.closePath()}}var po={name:"line",checkEventOn:Je,draw:function(n,t,e){ti(n,t,e)}};function ei(n,t,e){var o=e!=null?e:0,i=[];if(n.length>1)if(n[0].x===n[1].x){var r=t.height;if(i.push({coordinates:[{x:n[0].x,y:0},{x:n[0].x,y:r}]}),n.length>2){i.push({coordinates:[{x:n[2].x,y:0},{x:n[2].x,y:r}]});for(var a=n[0].x-n[2].x,s=0;o>s;s++){var l=a*(s+1);i.push({coordinates:[{x:n[0].x+l,y:0},{x:n[0].x+l,y:r}]})}}}else{var c=t.width,u=ce(n[0],n[1]),h=u[0],d=u[1];if(i.push({coordinates:[{x:0,y:0*h+d},{x:c,y:c*h+d}]}),n.length>2){var p=n[2].y-h*n[2].x;for(i.push({coordinates:[{x:0,y:0*h+p},{x:c,y:c*h+p}]}),a=d-p,s=0;o>s;s++){var v=d+a*(s+1);i.push({coordinates:[{x:0,y:0*h+v},{x:c,y:c*h+v}]})}}}return i}function vo(n,t){if(n.length>1){var e=void 0;return e=n[0].x===n[1].x&&n[0].y!==n[1].y?n[1].y>n[0].y?{x:n[0].x,y:t.height}:{x:n[0].x,y:0}:n[0].x>n[1].x?{x:0,y:Kt(n[0],n[1],{x:0,y:n[0].y})}:{x:t.width,y:Kt(n[0],n[1],{x:t.width,y:n[0].y})},{coordinates:[n[0],e]}}return[]}var go={name:"simpleAnnotation",totalStep:2,styles:{text:{borderSize:1,borderRadius:2,borderColor:"#1677FF",paddingLeft:4,paddingRight:4,paddingTop:4,paddingBottom:4,backgroundColor:"#1677FF"},line:{style:f.LineType.Dashed}},createPointFigures:function(n){var t,e,o=n.overlay,i=n.coordinates;R(o.extendData)&&(e=K(o.extendData)?o.extendData(o):(t=o.extendData)!==null&&t!==void 0?t:"");var r=i[0].x,a=i[0].y-6,s=a-50,l=s-5;return[{type:"line",attrs:{coordinates:[{x:r,y:a},{x:r,y:s}]},ignoreEvent:!0},{type:"polygon",attrs:{coordinates:[{x:r,y:s},{x:r-4,y:l},{x:r+4,y:l}]},ignoreEvent:!0},{type:"text",attrs:{x:r,y:l,text:e!=null?e:"",align:"center",baseline:"bottom"},ignoreEvent:!0}]}},fo={name:"simpleTag",totalStep:2,styles:{text:{borderSize:1,borderRadius:2,borderColor:"#1677FF",paddingLeft:4,paddingRight:4,paddingTop:4,paddingBottom:4,backgroundColor:"#1677FF"}},createPointFigures:function(n){var t=n.coordinates;return{type:"line",attrs:{coordinates:[{x:0,y:t[0].y},{x:n.bounding.width,y:t[0].y}]},ignoreEvent:!0}},createYAxisFigures:function(n){var t,e,o,i,r,a=n.overlay,s=n.coordinates,l=n.bounding,c=n.yAxis,u=n.precision;return(t=c==null?void 0:c.isFromZero())!==null&&t!==void 0&&t?(o="left",i=0):(o="right",i=l.width),R(a.extendData)&&(r=K(a.extendData)?a.extendData(a):(e=a.extendData)!==null&&e!==void 0?e:""),R(r)||a.points[0].value===void 0||(r=U(a.points[0].value,u.price)),{type:"text",attrs:{x:i,y:s[0].y,text:r!=null?r:"",align:o,baseline:"middle"}}}},Ut={};function mo(n){var t;return(t=Ut[n])!==null&&t!==void 0?t:null}function ii(n){var t={width:0,height:0,left:0,right:0,top:0,bottom:0};return n!==void 0&&j(t,n),t}[co,uo,{name:"horizontalSegment",totalStep:3,needDefaultPointFigure:!0,needDefaultXAxisFigure:!0,needDefaultYAxisFigure:!0,createPointFigures:function(n){var t=n.coordinates,e=[];return t.length===2&&e.push({coordinates:t}),[{type:"line",attrs:e}]},performEventPressedMove:function(n){var t=n.points,e=n.performPoint;t[0].value=e.value,t[1].value=e.value},performEventMoveForDrawing:function(n){n.currentStep===2&&(n.points[0].value=n.performPoint.value)}},{name:"horizontalStraightLine",totalStep:2,needDefaultPointFigure:!0,needDefaultXAxisFigure:!0,needDefaultYAxisFigure:!0,createPointFigures:function(n){var t=n.coordinates;return[{type:"line",attrs:{coordinates:[{x:0,y:t[0].y},{x:n.bounding.width,y:t[0].y}]}}]}},{name:"parallelStraightLine",totalStep:4,needDefaultPointFigure:!0,needDefaultXAxisFigure:!0,needDefaultYAxisFigure:!0,createPointFigures:function(n){return[{type:"line",attrs:ei(n.coordinates,n.bounding)}]}},{name:"priceChannelLine",totalStep:4,needDefaultPointFigure:!0,needDefaultXAxisFigure:!0,needDefaultYAxisFigure:!0,createPointFigures:function(n){return[{type:"line",attrs:ei(n.coordinates,n.bounding,1)}]}},{name:"priceLine",totalStep:2,needDefaultPointFigure:!0,needDefaultXAxisFigure:!0,needDefaultYAxisFigure:!0,createPointFigures:function(n){var t=n.coordinates,e=n.thousandsSeparator,o=n.overlay.points[0].value;return[{type:"line",attrs:{coordinates:[t[0],{x:n.bounding.width,y:t[0].y}]}},{type:"text",ignoreEvent:!0,attrs:{x:t[0].x,y:t[0].y,text:J((o===void 0?0:o).toFixed(n.precision.price),e),baseline:"bottom"}}]}},{name:"rayLine",totalStep:3,needDefaultPointFigure:!0,needDefaultXAxisFigure:!0,needDefaultYAxisFigure:!0,createPointFigures:function(n){return[{type:"line",attrs:vo(n.coordinates,n.bounding)}]}},{name:"segment",totalStep:3,needDefaultPointFigure:!0,needDefaultXAxisFigure:!0,needDefaultYAxisFigure:!0,createPointFigures:function(n){var t=n.coordinates;return t.length===2?[{type:"line",attrs:{coordinates:t}}]:[]}},{name:"straightLine",totalStep:3,needDefaultPointFigure:!0,needDefaultXAxisFigure:!0,needDefaultYAxisFigure:!0,createPointFigures:function(n){var t=n.coordinates,e=n.bounding;return t.length===2?t[0].x===t[1].x?[{type:"line",attrs:{coordinates:[{x:t[0].x,y:0},{x:t[0].x,y:e.height}]}}]:[{type:"line",attrs:{coordinates:[{x:0,y:Kt(t[0],t[1],{x:0,y:t[0].y})},{x:e.width,y:Kt(t[0],t[1],{x:e.width,y:t[0].y})}]}}]:[]}},{name:"verticalRayLine",totalStep:3,needDefaultPointFigure:!0,needDefaultXAxisFigure:!0,needDefaultYAxisFigure:!0,createPointFigures:function(n){var t=n.coordinates;if(t.length===2){var e={x:t[0].x,y:0};return t[1].y>t[0].y&&(e.y=n.bounding.height),[{type:"line",attrs:{coordinates:[t[0],e]}}]}return[]},performEventPressedMove:function(n){var t=n.points,e=n.performPoint;t[0].timestamp=e.timestamp,t[0].dataIndex=e.dataIndex,t[1].timestamp=e.timestamp,t[1].dataIndex=e.dataIndex},performEventMoveForDrawing:function(n){var t=n.points,e=n.performPoint;n.currentStep===2&&(t[0].timestamp=e.timestamp,t[0].dataIndex=e.dataIndex)}},{name:"verticalSegment",totalStep:3,needDefaultPointFigure:!0,needDefaultXAxisFigure:!0,needDefaultYAxisFigure:!0,createPointFigures:function(n){var t=n.coordinates;return t.length===2?[{type:"line",attrs:{coordinates:t}}]:[]},performEventPressedMove:function(n){var t=n.points,e=n.performPoint;t[0].timestamp=e.timestamp,t[0].dataIndex=e.dataIndex,t[1].timestamp=e.timestamp,t[1].dataIndex=e.dataIndex},performEventMoveForDrawing:function(n){var t=n.points,e=n.performPoint;n.currentStep===2&&(t[0].timestamp=e.timestamp,t[0].dataIndex=e.dataIndex)}},{name:"verticalStraightLine",totalStep:2,needDefaultPointFigure:!0,needDefaultXAxisFigure:!0,needDefaultYAxisFigure:!0,createPointFigures:function(n){var t=n.coordinates;return[{type:"line",attrs:{coordinates:[{x:t[0].x,y:0},{x:t[0].x,y:n.bounding.height}]}}]}},go,fo].forEach(function(n){Ut[n.name]=Ke.extend(n)});var nt="main",_t="xAxis",xt="yAxis",Qt="separator",oi=function(n){function t(e,o){var i=n.call(this)||this;return i._bounding=ii(),i._pane=o,i._init(e),i}return B(t,n),t.prototype._init=function(e){if(this._container=yt("div",this.getContainerStyle()),this.insertBefore()){var o=e.lastChild;o!==null?e.insertBefore(this._container,o):e.appendChild(this._container)}else e.appendChild(this._container);this.initDom(this._container)},t.prototype.setBounding=function(e){return j(this._bounding,e),this},t.prototype.getContainer=function(){return this._container},t.prototype.getBounding=function(){return this._bounding},t.prototype.getPane=function(){return this._pane},t.prototype.update=function(e){this.updateImp(this._container,this._bounding,e!=null?e:3)},t.prototype.insertBefore=function(){return!1},t}(we),yo=function(n){function t(e,o){var i,r,a,s=n.call(this,e,o)||this;return s._dragFlag=!1,s._dragStartY=0,s._topPaneHeight=0,s._currentPaneHeight=0,s._pressedMouseMoveEvent=(i=s._pressedTouchMouseMoveEvent,r=20,a=0,function(){var l=Date.now();l-a>(r!=null?r:20)&&(i.apply(this,arguments),a=l)}),s.registerEvent("touchStartEvent",s._mouseDownEvent.bind(s)).registerEvent("touchMoveEvent",s._pressedMouseMoveEvent.bind(s)).registerEvent("touchEndEvent",s._mouseUpEvent.bind(s)).registerEvent("mouseDownEvent",s._mouseDownEvent.bind(s)).registerEvent("mouseUpEvent",s._mouseUpEvent.bind(s)).registerEvent("pressedMouseMoveEvent",s._pressedMouseMoveEvent.bind(s)).registerEvent("mouseEnterEvent",s._mouseEnterEvent.bind(s)).registerEvent("mouseLeaveEvent",s._mouseLeaveEvent.bind(s)),s}return B(t,n),t.prototype.getName=function(){return Qt},t.prototype.checkEventOn=function(){return!0},t.prototype._mouseDownEvent=function(e){var o,i;this._dragFlag=!0,this._dragStartY=e.pageY;var r=this.getPane();return this._topPaneHeight=(i=(o=r.getTopPane())===null||o===void 0?void 0:o.getBounding().height)!==null&&i!==void 0?i:0,this._currentPaneHeight=r.getBounding().height,!0},t.prototype._mouseUpEvent=function(){return this._dragFlag=!1,this._mouseLeaveEvent()},t.prototype._pressedTouchMouseMoveEvent=function(e){var o=e.pageY-this._dragStartY,i=this.getPane(),r=i.getTopPane(),a=0>o;if(r!==null&&i.getOptions().dragEnabled){var s=void 0,l=void 0,c=void 0,u=void 0;a?(s=r,l=i,c=this._topPaneHeight,u=this._currentPaneHeight):(s=i,l=r,c=this._currentPaneHeight,u=this._topPaneHeight);var h=s.getOptions().minHeight;if(c>h){var d=Math.max(c-Math.abs(o),h),p=c-d;s.setBounding({height:d}),l.setBounding({height:u+p});var v=i.getChart();v.getChartStore().getActionStore().execute(f.ActionType.OnPaneDrag,{paneId:i.getId}),v.adjustPaneViewport(!0,!0,!0,!0,!0)}}return!0},t.prototype._mouseEnterEvent=function(){var e=this.getPane();if(e.getOptions().dragEnabled){var o=e.getChart().getStyles().separator;return this._moveDom.style.background=o.activeBackgroundColor,!0}return!1},t.prototype._mouseLeaveEvent=function(){return!this._dragFlag&&(this._moveDom.style.background="",!0)},t.prototype.getContainerStyle=function(){return{margin:"0",padding:"0",position:"relative",boxSizing:"border-box"}},t.prototype.insertBefore=function(){return!0},t.prototype.initDom=function(e){this._moveDom=yt("div",{width:"100%",height:"".concat(7,"px"),margin:"0",padding:"0",position:"absolute",top:"-3px",zIndex:"20",boxSizing:"border-box",cursor:"ns-resize"}),e.appendChild(this._moveDom)},t.prototype.updateImp=function(e,o,i){if(i===4||i===2){var r=this.getPane().getChart().getStyles().separator;this._moveDom.style.top="".concat(-Math.floor((7-r.size)/2),"px"),this._moveDom.style.height="".concat(7,"px");var a=r.fill;e.style.backgroundColor=r.color,e.style.height="".concat(r.size,"px"),e.style.marginLeft="".concat(a?0:o.left,"px"),e.style.width=a?"100%":"".concat(o.width,"px")}},t.prototype.getImage=function(){var e=this.getPane().getChart().getStyles().separator,o=this.getContainer().offsetWidth,i=e.size,r=yt("canvas",{width:"".concat(o,"px"),height:"".concat(i,"px"),boxSizing:"border-box"}),a=r.getContext("2d"),s=kt(r);return r.width=o*s,r.height=i*s,a.scale(s,s),a.fillStyle=e.color,a.fillRect(this.getBounding().left,0,o,i),r},t}(oi),rt="candle_pane",_o="indicator_pane_",lt="xaxis_pane",ni=function(){function n(t,e,o,i,r){this._yAxisWidget=null,this._separatorWidget=null,this._axis=this.createAxisComponent(),this._bounding=ii(),this._options={minHeight:30,dragEnabled:!0,gap:{top:.2,bottom:.1},axisOptions:{scrollZoomEnabled:!0}},this._chart=e,this._id=o,this._topPane=i!=null?i:null,this._bottomPane=r!=null?r:null,this._init(t)}return n.prototype._init=function(t){this._container=t,this._seriesContainer=yt("div",{width:"100%",margin:"0",padding:"0",position:"relative",overflow:"hidden",boxSizing:"border-box"}),this._separatorWidget=this.createSeparatorWidget(t);var e=t.lastChild;e!==null?t.insertBefore(this._seriesContainer,e):t.appendChild(this._seriesContainer),this._mainWidget=this.createMainWidget(this._seriesContainer),this._yAxisWidget=this.createYAxisWidget(this._seriesContainer)},n.prototype.getContainer=function(){return this._seriesContainer},n.prototype.getId=function(){return this._id},n.prototype.setOptions=function(t){var e,o,i,r,a;return j(this._options,t),this.getId()===lt?(r=this.getMainWidget().getContainer(),a="ew-resize"):(r=(e=this.getYAxisWidget())===null||e===void 0?void 0:e.getContainer(),a="ns-resize"),r.style.cursor=(i=(o=t.axisOptions)===null||o===void 0?void 0:o.scrollZoomEnabled)===null||i===void 0||i?a:"default",this},n.prototype.getOptions=function(){return this._options},n.prototype.getChart=function(){return this._chart},n.prototype.getAxisComponent=function(){return this._axis},n.prototype.setBounding=function(t,e,o){var i,r,a;j(this._bounding,t);var s=0;if(this._separatorWidget!==null){s=this._chart.getStyles().separator.size;var l=P(P({},t),{height:7});t.top!==void 0&&(l.top=t.top-Math.floor((7-s)/2)),this._separatorWidget.setBounding(l)}var c={};return t.height!==void 0&&(c.height=t.height-s),t.top!==void 0&&(c.top=t.top+s),this._mainWidget.setBounding(c),(i=this._yAxisWidget)===null||i===void 0||i.setBounding(c),e!==void 0&&(this._mainWidget.setBounding(e),(r=this._separatorWidget)===null||r===void 0||r.setBounding(e)),o!==void 0&&((a=this._yAxisWidget)===null||a===void 0||a.setBounding(o)),this},n.prototype.getTopPane=function(){return this._topPane},n.prototype.setTopPane=function(t){return this._topPane=t,this},n.prototype.getBottomPane=function(){return this._bottomPane},n.prototype.setBottomPane=function(t){return this._bottomPane=t,this},n.prototype.getBounding=function(){return this._bounding},n.prototype.getMainWidget=function(){return this._mainWidget},n.prototype.getYAxisWidget=function(){return this._yAxisWidget},n.prototype.getSeparatorWidget=function(){return this._separatorWidget},n.prototype.update=function(t){var e,o;this._bounding.width!==this._seriesContainer.offsetWidth&&(this._seriesContainer.style.width="".concat(this._bounding.width,"px"));var i=this._mainWidget.getBounding().height;i!==this._seriesContainer.offsetHeight&&(this._seriesContainer.style.height="".concat(i,"px"));var r=t!=null?t:3;this._mainWidget.update(r),(e=this._yAxisWidget)===null||e===void 0||e.update(r),(o=this._separatorWidget)===null||o===void 0||o.update(r)},n.prototype.getImage=function(t){var e=this._bounding,o=e.width,i=e.height,r=yt("canvas",{width:"".concat(o,"px"),height:"".concat(i,"px"),boxSizing:"border-box"}),a=r.getContext("2d"),s=kt(r);r.width=o*s,r.height=i*s,a.scale(s,s);var l=0;if(this._separatorWidget!=null){var c=this.getChart().getStyles().separator.size;l=c,a.drawImage(this._separatorWidget.getImage(),0,0,o,c)}var u=this._mainWidget.getBounding();if(a.drawImage(this._mainWidget.getImage(t),u.left,l,u.width,u.height),this._yAxisWidget!==null){var h=this._yAxisWidget.getBounding();a.drawImage(this._yAxisWidget.getImage(t),h.left,l,h.width,h.height)}return r},n.prototype.destroy=function(){this._container.removeChild(this._seriesContainer),this._separatorWidget!==null&&this._container.removeChild(this._separatorWidget.getContainer())},n.prototype.createSeparatorWidget=function(t){return null},n.prototype.createYAxisWidget=function(t){return null},n}(),xo=function(){function n(t){this._instances=new Map,this._counter=new Map,this._progressInstanceInfo=null,this._pressedInstanceInfo={paneId:"",instance:null,figureType:0,figureKey:"",figureIndex:-1,attrsIndex:-1},this._hoverInstanceInfo={paneId:"",instance:null,figureType:0,figureKey:"",figureIndex:-1,attrsIndex:-1},this._clickInstanceInfo={paneId:"",instance:null,figureType:0,figureKey:"",figureIndex:-1,attrsIndex:-1},this._chartStore=t}return n.prototype._overrideInstance=function(t,e){var o=e.id,i=e.groupId,r=e.points,a=e.styles,s=e.lock,l=e.visible,c=e.zLevel,u=e.mode,h=e.modeSensitivity,d=e.extendData,p=e.onDrawStart,v=e.onDrawing,g=e.onDrawEnd,m=e.onClick,y=e.onDoubleClick,_=e.onRightClick,x=e.onPressedMoveStart,S=e.onPressedMoving,C=e.onPressedMoveEnd,T=e.onMouseEnter,b=e.onMouseLeave,w=e.onRemoved,E=e.onSelected,D=e.onDeselected,I=!1,M=!1;return o!==void 0&&t.setId(o),i!==void 0&&t.setGroupId(i),r!==void 0&&t.setPoints(r)&&(I=!0),a!==void 0&&t.setStyles(a)&&(I=!0),s!==void 0&&t.setLock(s),l!==void 0&&t.setVisible(l)&&(I=!0),c!==void 0&&t.setZLevel(c)&&(I=!0,M=!0),u!==void 0&&t.setMode(u),h!==void 0&&t.setModeSensitivity(h),d!==void 0&&t.setExtendData(d)&&(I=!0),p!==void 0&&t.setOnDrawStartCallback(p),v!==void 0&&t.setOnDrawingCallback(v),g!==void 0&&t.setOnDrawEndCallback(g),m!==void 0&&t.setOnClickCallback(m),y!==void 0&&t.setOnDoubleClickCallback(y),_!==void 0&&t.setOnRightClickCallback(_),x!==void 0&&t.setOnPressedMoveStartCallback(x),S!==void 0&&t.setOnPressedMovingCallback(S),C!==void 0&&t.setOnPressedMoveEndCallback(C),T!==void 0&&t.setOnMouseEnterCallback(T),b!==void 0&&t.setOnMouseLeaveCallback(b),w!==void 0&&t.setOnRemovedCallback(w),E!==void 0&&t.setOnSelectedCallback(E),D!==void 0&&t.setOnDeselectedCallback(D),[I,M]},n.prototype.getInstanceById=function(t){var e,o;try{for(var i=qt(this._instances),r=i.next();!r.done;r=i.next()){var a=r.value[1].find(function(s){return s.id===t});if(a!==void 0)return a}}catch(s){e={error:s}}finally{try{r&&!r.done&&(o=i.return)&&o.call(i)}finally{if(e)throw e.error}}return this._progressInstanceInfo!==null&&this._progressInstanceInfo.instance.id===t?this._progressInstanceInfo.instance:null},n.prototype._sort=function(t){var e;t!==void 0?(e=this._instances.get(t))===null||e===void 0||e.sort(function(o,i){return o.defaultZLevel-i.defaultZLevel}).sort(function(o,i){return o.zLevel-i.zLevel}):this._instances.forEach(function(o){o.sort(function(i,r){return i.defaultZLevel-r.defaultZLevel}).sort(function(i,r){return i.zLevel-r.zLevel})})},n.prototype.addInstances=function(t,e,o){var i=this,r=t.map(function(a){var s,l,c,u,h,d=(s=a.id)!==null&&s!==void 0?s:je("overlay_");if(i.getInstanceById(d)===null){var p=mo(a.name);if(p!==null){var v=new p,g=((l=i._counter.get(e))!==null&&l!==void 0?l:0)+1;i._counter.set(e,g),v.setDefaultZLevel(g),v.setPaneId(e);var m=(c=a.groupId)!==null&&c!==void 0?c:d;return a.id=d,a.groupId=m,i._overrideInstance(v,a),v.isDrawing()?i._progressInstanceInfo={paneId:e,instance:v,appointPaneFlag:o}:(i._instances.has(e)||i._instances.set(e,[]),(u=i._instances.get(e))===null||u===void 0||u.push(v)),v.isStart()&&((h=v.onDrawStart)===null||h===void 0||h.call(v,{overlay:v})),d}}return null});return r.some(function(a){return a!==null})&&(this._sort(),this._chartStore.getChart().updatePane(1,e)),r},n.prototype.getProgressInstanceInfo=function(){return this._progressInstanceInfo},n.prototype.progressInstanceComplete=function(){var t;if(this._progressInstanceInfo!==null){var e=this._progressInstanceInfo,o=e.instance,i=e.paneId;o.isDrawing()||(this._instances.has(i)||this._instances.set(i,[]),(t=this._instances.get(i))===null||t===void 0||t.push(o),this._sort(i),this._progressInstanceInfo=null)}},n.prototype.updateProgressInstanceInfo=function(t,e){this._progressInstanceInfo!==null&&(e!==void 0&&e&&(this._progressInstanceInfo.appointPaneFlag=e),this._progressInstanceInfo.paneId=t,this._progressInstanceInfo.instance.setPaneId(t))},n.prototype.getInstances=function(t){var e;if(t===void 0){var o=[];return this._instances.forEach(function(i){o=o.concat(i)}),o}return(e=this._instances.get(t))!==null&&e!==void 0?e:[]},n.prototype.override=function(t){var e=this,o=t.id,i=t.groupId,r=t.name,a=!1,s=!1,l=function(h){var d=e._overrideInstance(h,t);d[0]&&(a=!0),d[1]&&(s=!0)};if(o!==void 0){var c=this.getInstanceById(o);c!==null&&l(c)}else if(this._instances.forEach(function(h){h.forEach(function(d){(r!==void 0&&d.name===r||i!==void 0&&d.groupId===i||r===void 0&&i===void 0)&&l(d)})}),this._progressInstanceInfo!==null){var u=this._progressInstanceInfo.instance;(r!==void 0&&u.name===r||i!==void 0&&u.groupId===i||r===void 0&&i===void 0)&&l(u)}s&&this._sort(),a&&this._chartStore.getChart().updatePane(1)},n.prototype.removeInstance=function(t){var e,o,i,r=function(p,v){if(p.id!==void 0){if(v.id!==p.id)return!1}else if(p.groupId!==void 0){if(v.groupId!==p.groupId)return!1}else if(p.name!==void 0&&v.name!==p.name)return!1;return!0},a=[];if(this._progressInstanceInfo!==null){var s=this._progressInstanceInfo.instance;(t===void 0||t!==void 0&&r(t,s))&&(a.push(this._progressInstanceInfo.paneId),(i=s.onRemoved)===null||i===void 0||i.call(s,{overlay:s}),this._progressInstanceInfo=null)}if(t!==void 0){var l=new Map,c=function(p){var v=p[1].filter(function(g){var m;return!r(t,g)||(a.includes(p[0])||a.push(p[0]),(m=g.onRemoved)===null||m===void 0||m.call(g,{overlay:g}),!1)});v.length>0&&l.set(p[0],v)};try{for(var u=qt(this._instances),h=u.next();!h.done;h=u.next())c(h.value)}catch(p){e={error:p}}finally{try{h&&!h.done&&(o=u.return)&&o.call(u)}finally{if(e)throw e.error}}this._instances=l}else this._instances.forEach(function(p,v){a.push(v),p.forEach(function(g){var m;(m=g.onRemoved)===null||m===void 0||m.call(g,{overlay:g})})}),this._instances.clear();if(a.length>0){var d=this._chartStore.getChart();a.forEach(function(p){d.updatePane(1,p)}),d.updatePane(1,lt)}},n.prototype.setPressedInstanceInfo=function(t){this._pressedInstanceInfo=t},n.prototype.getPressedInstanceInfo=function(){return this._pressedInstanceInfo},n.prototype.setHoverInstanceInfo=function(t,e){var o,i,r=this._hoverInstanceInfo,a=r.instance,s=r.figureKey,l=r.figureIndex;if(((a==null?void 0:a.id)!==((o=t.instance)===null||o===void 0?void 0:o.id)||r.figureType!==t.figureType||l!==t.figureIndex)&&(this._hoverInstanceInfo=t,(a==null?void 0:a.id)!==((i=t.instance)===null||i===void 0?void 0:i.id))){var c=!1,u=!1;a!==null&&(u=!0,a.resetZLevel(),K(a.onMouseLeave)&&(a.onMouseLeave(P({overlay:a,figureKey:s,figureIndex:l},e)),c=!0)),t.instance!==null&&(u=!0,t.instance.setZLevel(lo),K(t.instance.onMouseEnter)&&(t.instance.onMouseEnter(P({overlay:t.instance,figureKey:t.figureKey,figureIndex:t.figureIndex},e)),c=!0)),u&&this._sort(),c||this._chartStore.getChart().updatePane(1)}},n.prototype.getHoverInstanceInfo=function(){return this._hoverInstanceInfo},n.prototype.setClickInstanceInfo=function(t,e){var o,i,r,a,s,l,c,u,h,d=this._clickInstanceInfo,p=d.paneId,v=d.instance,g=d.figureType,m=d.figureKey,y=d.figureIndex;if((i=(o=t.instance)===null||o===void 0?void 0:o.isDrawing())!==null&&i!==void 0&&i||(a=(r=t.instance)===null||r===void 0?void 0:r.onClick)===null||a===void 0||a.call(r,P({overlay:t.instance,figureKey:t.figureKey,figureIndex:t.figureIndex},e)),((v==null?void 0:v.id)!==((s=t.instance)===null||s===void 0?void 0:s.id)||g!==t.figureType||y!==t.figureIndex)&&(this._clickInstanceInfo=t,(v==null?void 0:v.id)!==((l=t.instance)===null||l===void 0?void 0:l.id))){(c=v==null?void 0:v.onDeselected)===null||c===void 0||c.call(v,P({overlay:v,figureKey:m,figureIndex:y},e)),(h=(u=t.instance)===null||u===void 0?void 0:u.onSelected)===null||h===void 0||h.call(u,P({overlay:t.instance,figureKey:t.figureKey,figureIndex:t.figureIndex},e));var _=this._chartStore.getChart();_.updatePane(1,t.paneId),p!==t.paneId&&_.updatePane(1,p),_.updatePane(1,lt)}},n.prototype.getClickInstanceInfo=function(){return this._clickInstanceInfo},n.prototype.isEmpty=function(){return this._instances.size===0&&this._progressInstanceInfo===null},n.prototype.isDrawing=function(){var t,e;return this._progressInstanceInfo!==null&&(e=(t=this._progressInstanceInfo)===null||t===void 0?void 0:t.instance.isDrawing())!==null&&e!==void 0&&e},n}(),So=function(){function n(){this._actions=new Map}return n.prototype.execute=function(t,e){var o;(o=this._actions.get(t))===null||o===void 0||o.execute(e)},n.prototype.subscribe=function(t,e){var o;this._actions.has(t)||this._actions.set(t,new $i),(o=this._actions.get(t))===null||o===void 0||o.subscribe(e)},n.prototype.unsubscribe=function(t,e){var o=this._actions.get(t);o!==void 0&&(o.unsubscribe(e),o.isEmpty()&&this._actions.delete(t))},n.prototype.has=function(t){var e=this._actions.get(t);return e!==void 0&&!e.isEmpty()},n}(),ri={light:{grid:{horizontal:{color:"#EDEDED"},vertical:{color:"#EDEDED"}},candle:{priceMark:{high:{color:"#76808F"},low:{color:"#76808F"}},tooltip:{rect:{color:"#FEFEFE",borderColor:"#F2F3F5"},text:{color:"#76808F"}}},indicator:{tooltip:{text:{color:"#76808F"}}},xAxis:{axisLine:{color:"#DDDDDD"},tickText:{color:"#76808F"},tickLine:{color:"#DDDDDD"}},yAxis:{axisLine:{color:"#DDDDDD"},tickText:{color:"#76808F"},tickLine:{color:"#DDDDDD"}},separator:{color:"#DDDDDD"},crosshair:{horizontal:{line:{color:"#76808F"},text:{borderColor:"#686D76",backgroundColor:"#686D76"}},vertical:{line:{color:"#76808F"},text:{borderColor:"#686D76",backgroundColor:"#686D76"}}}},dark:{grid:{horizontal:{color:"#292929"},vertical:{color:"#292929"}},candle:{priceMark:{high:{color:"#929AA5"},low:{color:"#929AA5"}},tooltip:{rect:{color:"rgba(10, 10, 10, .6)",borderColor:"rgba(10, 10, 10, .6)"},text:{color:"#929AA5"}}},indicator:{tooltip:{text:{color:"#929AA5"}}},xAxis:{axisLine:{color:"#333333"},tickText:{color:"#929AA5"},tickLine:{color:"#333333"}},yAxis:{axisLine:{color:"#333333"},tickText:{color:"#929AA5"},tickLine:{color:"#333333"}},separator:{color:"#333333"},crosshair:{horizontal:{line:{color:"#929AA5"},text:{borderColor:"#373a40",backgroundColor:"#373a40"}},vertical:{line:{color:"#929AA5"},text:{borderColor:"#373a40",backgroundColor:"#373a40"}}}}};function ai(n){var t;return(t=ri[n])!==null&&t!==void 0?t:null}var Co=function(){function n(t,e){this._styles={grid:{show:!0,horizontal:{show:!0,size:1,color:"#EDEDED",style:f.LineType.Dashed,dashedValue:[2,2]},vertical:{show:!0,size:1,color:"#EDEDED",style:f.LineType.Dashed,dashedValue:[2,2]}},candle:{type:f.CandleType.CandleSolid,bar:{upColor:"#2DC08E",downColor:"#F92855",noChangeColor:"#888888",upBorderColor:"#2DC08E",downBorderColor:"#F92855",noChangeBorderColor:"#888888",upWickColor:"#2DC08E",downWickColor:"#F92855",noChangeWickColor:"#888888"},area:{lineSize:2,lineColor:"#1677FF",value:"close",backgroundColor:[{offset:0,color:"rgba(22, 119, 255, 0.01)"},{offset:1,color:"rgba(22, 119, 255, 0.2)"}]},priceMark:{show:!0,high:{show:!0,color:"#76808F",textOffset:5,textSize:10,textFamily:"Helvetica Neue",textWeight:"normal"},low:{show:!0,color:"#76808F",textOffset:5,textSize:10,textFamily:"Helvetica Neue",textWeight:"normal"},last:{show:!0,upColor:"#2DC08E",downColor:"#F92855",noChangeColor:"#888888",line:{show:!0,style:f.LineType.Dashed,dashedValue:[4,4],size:1},text:{show:!0,style:f.PolygonType.Fill,size:12,paddingLeft:4,paddingTop:4,paddingRight:4,paddingBottom:4,borderColor:"transparent",borderStyle:f.LineType.Solid,borderSize:0,borderDashedValue:[2,2],color:"#FFFFFF",family:"Helvetica Neue",weight:"normal",borderRadius:2}}},tooltip:{showRule:f.TooltipShowRule.Always,showType:f.TooltipShowType.Standard,custom:null,defaultValue:"n/a",rect:{position:ne.Fixed,paddingLeft:0,paddingRight:0,paddingTop:0,paddingBottom:8,offsetLeft:10,offsetTop:8,offsetRight:10,offsetBottom:8,borderRadius:4,borderSize:1,borderColor:"#F2F3F5",color:"#FEFEFE"},text:{size:12,family:"Helvetica Neue",weight:"normal",color:"#76808F",marginLeft:10,marginTop:8,marginRight:6,marginBottom:0},icons:[]}},indicator:{ohlc:{upColor:"rgba(45, 192, 142, .7)",downColor:"rgba(249, 40, 85, .7)",noChangeColor:"#888888"},bars:[{style:f.PolygonType.Fill,borderStyle:f.LineType.Solid,borderSize:1,borderDashedValue:[2,2],upColor:"rgba(45, 192, 142, .7)",downColor:"rgba(249, 40, 85, .7)",noChangeColor:"#888888"}],lines:[{style:f.LineType.Solid,smooth:!1,size:1,dashedValue:[2,2],color:"#FF9600"},{style:f.LineType.Solid,smooth:!1,size:1,dashedValue:[2,2],color:"#935EBD"},{style:f.LineType.Solid,smooth:!1,size:1,dashedValue:[2,2],color:"#1677FF"},{style:f.LineType.Solid,smooth:!1,size:1,dashedValue:[2,2],color:"#E11D74"},{style:f.LineType.Solid,smooth:!1,size:1,dashedValue:[2,2],color:"#01C5C4"}],circles:[{style:f.PolygonType.Fill,borderStyle:f.LineType.Solid,borderSize:1,borderDashedValue:[2,2],upColor:"rgba(45, 192, 142, .7)",downColor:"rgba(249, 40, 85, .7)",noChangeColor:"#888888"}],lastValueMark:{show:!1,text:{show:!1,style:f.PolygonType.Fill,color:"#FFFFFF",size:12,family:"Helvetica Neue",weight:"normal",borderStyle:f.LineType.Solid,borderColor:"transparent",borderSize:1,borderDashedValue:[2,2],paddingLeft:4,paddingTop:4,paddingRight:4,paddingBottom:4,borderRadius:2}},tooltip:{showRule:f.TooltipShowRule.Always,showType:f.TooltipShowType.Standard,showName:!0,showParams:!0,defaultValue:"n/a",text:{size:12,family:"Helvetica Neue",weight:"normal",color:"#76808F",marginLeft:10,marginTop:8,marginRight:6,marginBottom:0},icons:[]}},xAxis:{show:!0,size:"auto",axisLine:{show:!0,color:"#DDDDDD",size:1},tickText:{show:!0,color:"#76808F",size:12,family:"Helvetica Neue",weight:"normal",marginStart:4,marginEnd:4},tickLine:{show:!0,size:1,length:3,color:"#DDDDDD"}},yAxis:{show:!0,size:"auto",type:f.YAxisType.Normal,position:f.YAxisPosition.Right,inside:!1,reverse:!1,axisLine:{show:!0,color:"#DDDDDD",size:1},tickText:{show:!0,color:"#76808F",size:12,family:"Helvetica Neue",weight:"normal",marginStart:4,marginEnd:4},tickLine:{show:!0,size:1,length:3,color:"#DDDDDD"}},separator:{size:1,color:"#DDDDDD",fill:!0,activeBackgroundColor:"rgba(33, 150, 243, 0.08)"},crosshair:{show:!0,horizontal:{show:!0,line:{show:!0,style:f.LineType.Dashed,dashedValue:[4,2],size:1,color:"#76808F"},text:{show:!0,style:f.PolygonType.Fill,color:"#FFFFFF",size:12,family:"Helvetica Neue",weight:"normal",borderStyle:f.LineType.Solid,borderDashedValue:[2,2],borderSize:1,borderColor:"#686D76",borderRadius:2,paddingLeft:4,paddingRight:4,paddingTop:4,paddingBottom:4,backgroundColor:"#686D76"}},vertical:{show:!0,line:{show:!0,style:f.LineType.Dashed,dashedValue:[4,2],size:1,color:"#76808F"},text:{show:!0,style:f.PolygonType.Fill,color:"#FFFFFF",size:12,family:"Helvetica Neue",weight:"normal",borderStyle:f.LineType.Solid,borderDashedValue:[2,2],borderSize:1,borderRadius:2,borderColor:"#686D76",paddingLeft:4,paddingRight:4,paddingTop:4,paddingBottom:4,backgroundColor:"#686D76"}}},overlay:{point:{color:"#1677FF",borderColor:"rgba(22, 119, 255, 0.35)",borderSize:1,radius:5,activeColor:"#1677FF",activeBorderColor:"rgba(22, 119, 255, 0.35)",activeBorderSize:3,activeRadius:5},line:{style:f.LineType.Solid,smooth:!1,color:"#1677FF",size:1,dashedValue:[2,2]},rect:{style:f.PolygonType.Fill,color:"rgba(22, 119, 255, 0.25)",borderColor:"#1677FF",borderSize:1,borderRadius:0,borderStyle:f.LineType.Solid,borderDashedValue:[2,2]},polygon:{style:f.PolygonType.Fill,color:"#1677FF",borderColor:"#1677FF",borderSize:1,borderStyle:f.LineType.Solid,borderDashedValue:[2,2]},circle:{style:f.PolygonType.Fill,color:"rgba(22, 119, 255, 0.25)",borderColor:"#1677FF",borderSize:1,borderStyle:f.LineType.Solid,borderDashedValue:[2,2]},arc:{style:f.LineType.Solid,color:"#1677FF",size:1,dashedValue:[2,2]},text:{style:f.PolygonType.Fill,color:"#FFFFFF",size:12,family:"Helvetica Neue",weight:"normal",borderStyle:f.LineType.Solid,borderDashedValue:[2,2],borderSize:0,borderRadius:2,borderColor:"#1677FF",paddingLeft:0,paddingRight:0,paddingTop:0,paddingBottom:0,backgroundColor:"transparent"},rectText:{style:f.PolygonType.Fill,color:"#FFFFFF",size:12,family:"Helvetica Neue",weight:"normal",borderStyle:f.LineType.Solid,borderDashedValue:[2,2],borderSize:1,borderRadius:2,borderColor:"#1677FF",paddingLeft:4,paddingRight:4,paddingTop:4,paddingBottom:4,backgroundColor:"#1677FF"}}},this._customApi={formatDate:ze,formatBigNumber:Ye},this._locale="en-US",this._precision={price:2,volume:0},this._thousandsSeparator=",",this._dataList=[],this._timeScaleStore=new Qi(this),this._indicatorStore=new ao(this),this._overlayStore=new xo(this),this._tooltipStore=new so(this),this._actionStore=new So,this._visibleDataList=[],this._chart=t,this.setOptions(e)}return n.prototype.adjustVisibleDataList=function(){this._visibleDataList=[];for(var t=this._timeScaleStore.getVisibleRange(),e=t.to,o=t.from;e>o;o++){var i=this._dataList[o],r=this._timeScaleStore.dataIndexToCoordinate(o);this._visibleDataList.push({dataIndex:o,x:r,data:i})}},n.prototype.setOptions=function(t){if(t!==void 0){var e=t.locale,o=t.timezone,i=t.styles,r=t.customApi;e!==void 0&&(this._locale=e),o!==void 0&&this._timeScaleStore.setTimezone(o),i!==void 0&&(q(i)?j(this._styles,ai(i)):j(this._styles,i)),r!==void 0&&j(this._customApi,r),t.thousandsSeparator!==void 0&&(this._thousandsSeparator=t.thousandsSeparator)}return this},n.prototype.getStyles=function(){return this._styles},n.prototype.getLocale=function(){return this._locale},n.prototype.getCustomApi=function(){return this._customApi},n.prototype.getThousandsSeparator=function(){return this._thousandsSeparator},n.prototype.getPrecision=function(){return this._precision},n.prototype.setPrecision=function(t){return this._precision=t,this._indicatorStore.setSeriesPrecision(t),this},n.prototype.getDataList=function(){return this._dataList},n.prototype.getVisibleDataList=function(){return this._visibleDataList},n.prototype.addData=function(t,e,o){if(W(t)){this._timeScaleStore.setLoading(!1),this._timeScaleStore.setMore(o==null||o);var i=this._dataList.length===0;this._dataList=t.concat(this._dataList),i&&this._timeScaleStore.resetOffsetRightDistance(),this._timeScaleStore.adjustVisibleRange()}else if(e<this._dataList.length)this._dataList[e]=t,this.adjustVisibleDataList();else{this._dataList.push(t);var r=this._timeScaleStore.getOffsetRightBarCount();0>r&&this._timeScaleStore.setOffsetRightBarCount(--r),this._timeScaleStore.adjustVisibleRange()}this._tooltipStore.recalculateCrosshair(!0)},n.prototype.clear=function(){this._dataList=[],this._visibleDataList=[],this._timeScaleStore.clear(),this._tooltipStore.clear()},n.prototype.getTimeScaleStore=function(){return this._timeScaleStore},n.prototype.getIndicatorStore=function(){return this._indicatorStore},n.prototype.getOverlayStore=function(){return this._overlayStore},n.prototype.getTooltipStore=function(){return this._tooltipStore},n.prototype.getActionStore=function(){return this._actionStore},n.prototype.getChart=function(){return this._chart},n}();function Ie(n){return window.requestAnimationFrame==null?window.setTimeout(n,20):window.requestAnimationFrame(n)}function ue(n){window.cancelAnimationFrame==null&&window.clearTimeout(n),window.cancelAnimationFrame(n)}var Yt=-1,De=function(n){function t(){var e=n!==null&&n.apply(this,arguments)||this;return e._mainRequestAnimationId=Yt,e._overlayRequestAnimationId=Yt,e}return B(t,n),t.prototype.getContainerStyle=function(){return{margin:"0",padding:"0",position:"absolute",top:"0",overflow:"hidden",boxSizing:"border-box"}},t.prototype.initDom=function(e){this._mainCanvas=yt("canvas",{position:"absolute",top:"0",left:"0",zIndex:"2",boxSizing:"border-box"}),this._mainCtx=this._mainCanvas.getContext("2d"),this._overlayCanvas=yt("canvas",{position:"absolute",top:"0",left:"0",zIndex:"2",boxSizing:"border-box"}),this._overlayCtx=this._overlayCanvas.getContext("2d"),e.appendChild(this._mainCanvas),e.appendChild(this._overlayCanvas)},t.prototype._optimalUpdateMain=function(e,o){var i=this;this._mainRequestAnimationId!==Yt&&(ue(this._mainRequestAnimationId),this._mainRequestAnimationId=Yt),this._mainRequestAnimationId=Ie(function(){if(e!==i._mainCanvas.offsetWidth||o!==i._mainCanvas.offsetHeight){i._mainCtx.clearRect(0,0,i._mainCanvas.offsetWidth,i._mainCanvas.offsetHeight);var r=kt(i._mainCanvas),a=Math.floor(e*r),s=Math.floor(o*r);i._mainCanvas.style.width="".concat(e,"px"),i._mainCanvas.style.height="".concat(o,"px"),i._mainCanvas.width=a,i._mainCanvas.height=s,i._mainCtx.scale(r,r)}else i._mainCtx.clearRect(0,0,i._mainCanvas.offsetWidth,i._mainCanvas.offsetHeight);i.updateMain(i._mainCtx)})},t.prototype._optimalUpdateOverlay=function(e,o){var i=this;this._overlayRequestAnimationId!==Yt&&(ue(this._overlayRequestAnimationId),this._overlayRequestAnimationId=Yt),this._overlayRequestAnimationId=Ie(function(){if(e!==i._overlayCanvas.offsetWidth||o!==i._overlayCanvas.offsetHeight){i._overlayCtx.clearRect(0,0,i._overlayCanvas.offsetWidth,i._overlayCanvas.offsetHeight);var r=kt(i._overlayCanvas),a=Math.floor(e*r),s=Math.floor(o*r);i._overlayCanvas.style.width="".concat(e,"px"),i._overlayCanvas.style.height="".concat(o,"px"),i._overlayCanvas.width=a,i._overlayCanvas.height=s,i._overlayCtx.scale(r,r)}else i._overlayCtx.clearRect(0,0,i._overlayCanvas.offsetWidth,i._overlayCanvas.offsetHeight);i.updateOverlay(i._overlayCtx)})},t.prototype.updateImp=function(e,o,i){var r=o.width,a=o.height;e.style.left="".concat(o.left,"px");var s=i;switch(r===e.offsetWidth&&a===e.offsetHeight||(e.style.width="".concat(r,"px"),e.style.height="".concat(a,"px"),s=3),s){case 0:this._optimalUpdateMain(r,a);break;case 1:this._optimalUpdateOverlay(r,a);break;case 3:case 4:this._optimalUpdateMain(r,a),this._optimalUpdateOverlay(r,a)}},t.prototype.getImage=function(e){var o=this.getBounding(),i=o.width,r=o.height,a=yt("canvas",{width:"".concat(i,"px"),height:"".concat(r,"px"),boxSizing:"border-box"}),s=a.getContext("2d"),l=kt(a);return a.width=i*l,a.height=r*l,s.scale(l,l),s.drawImage(this._mainCanvas,0,0,i,r),e&&s.drawImage(this._overlayCanvas,0,0,i,r),a},t}(oi);function si(n,t){var e=n.x-t.x,o=n.y-t.y,i=t.r;return!(e*e+o*o>i*i)}function li(n,t,e){var o=t.x,i=t.y,r=t.r,a=e.style,s=a===void 0?f.PolygonType.Fill:a,l=e.color,c=e.borderSize,u=c===void 0?1:c,h=e.borderColor,d=h===void 0?"currentColor":h,p=e.borderStyle,v=p===void 0?f.LineType.Solid:p,g=e.borderDashedValue,m=g===void 0?[2,2]:g;s!==f.PolygonType.Fill&&e.style!==f.PolygonType.StrokeFill||(n.fillStyle=l===void 0?"currentColor":l,n.beginPath(),n.arc(o,i,r,0,2*Math.PI),n.closePath(),n.fill()),s!==f.PolygonType.Stroke&&e.style!==f.PolygonType.StrokeFill||(n.strokeStyle=d,n.lineWidth=u,n.setLineDash(v===f.LineType.Dashed?m:[]),n.beginPath(),n.arc(o,i,r,0,2*Math.PI),n.closePath(),n.stroke())}var bo={name:"circle",checkEventOn:si,draw:function(n,t,e){li(n,t,e)}};function ci(n,t){for(var e=!1,o=t.coordinates,i=0,r=o.length-1;o.length>i;r=i++)o[i].y>n.y!=o[r].y>n.y&&(o[r].x-o[i].x)*(n.y-o[i].y)/(o[r].y-o[i].y)+o[i].x>n.x&&(e=!e);return e}function ui(n,t,e){var o=t.coordinates,i=e.style,r=i===void 0?f.PolygonType.Fill:i,a=e.color,s=e.borderSize,l=s===void 0?1:s,c=e.borderColor,u=c===void 0?"currentColor":c,h=e.borderStyle,d=h===void 0?f.LineType.Solid:h,p=e.borderDashedValue,v=p===void 0?[2,2]:p;if(r===f.PolygonType.Fill||e.style===f.PolygonType.StrokeFill){n.fillStyle=a===void 0?"currentColor":a,n.beginPath(),n.moveTo(o[0].x,o[0].y);for(var g=1;o.length>g;g++)n.lineTo(o[g].x,o[g].y);n.closePath(),n.fill()}if(r===f.PolygonType.Stroke||e.style===f.PolygonType.StrokeFill){for(n.strokeStyle=u,n.lineWidth=l,n.setLineDash(d===f.LineType.Dashed?v:[]),n.beginPath(),n.moveTo(o[0].x,o[0].y),g=1;o.length>g;g++)n.lineTo(o[g].x,o[g].y);n.closePath(),n.stroke()}}var To={name:"polygon",checkEventOn:ci,draw:function(n,t,e){ui(n,t,e)}};function hi(n){return n==="transparent"}function di(n,t){var e=t.x,o=t.width;4>o&&(e-=2,o=4);var i=t.y,r=t.height;return 4>r&&(i-=2,r=4),!(e>n.x||n.x>e+o||i>n.y||n.y>i+r)}function Pe(n,t,e){var o=t.x,i=t.y,r=t.width,a=t.height,s=e.style,l=s===void 0?f.PolygonType.Fill:s,c=e.color,u=c===void 0?"transparent":c,h=e.borderSize,d=h===void 0?1:h,p=e.borderColor,v=p===void 0?"transparent":p,g=e.borderStyle,m=g===void 0?f.LineType.Solid:g,y=e.borderRadius,_=y===void 0?0:y,x=e.borderDashedValue,S=x===void 0?[2,2]:x;if(l===f.PolygonType.Fill||e.style===f.PolygonType.StrokeFill){var C=!0;q(u)&&(C=!hi(u)),C&&(n.fillStyle=u,n.beginPath(),n.moveTo(o+_,i),n.arcTo(o+r,i,o+r,i+a,_),n.arcTo(o+r,i+a,o,i+a,_),n.arcTo(o,i+a,o,i,_),n.arcTo(o,i,o+r,i,_),n.closePath(),n.fill())}l!==f.PolygonType.Stroke&&e.style!==f.PolygonType.StrokeFill||hi(v)||0>d||(n.strokeStyle=v,n.lineWidth=d,n.setLineDash(m===f.LineType.Dashed?S:[]),n.beginPath(),n.moveTo(o+_,i),n.arcTo(o+r,i,o+r,i+a,_),n.arcTo(o+r,i+a,o,i+a,_),n.arcTo(o,i+a,o,i,_),n.arcTo(o,i,o+r,i,_),n.closePath(),n.stroke())}var wo={name:"rect",checkEventOn:di,draw:function(n,t,e){Pe(n,t,e)}};function pi(n,t){var e,o,i=t.size,r=i===void 0?12:i,a=t.paddingLeft,s=t.paddingTop,l=s===void 0?0:s,c=t.paddingRight,u=c===void 0?0:c,h=t.paddingBottom,d=h===void 0?0:h,p=t.weight,v=n.x,g=n.y,m=n.align,y=m===void 0?"left":m,_=n.baseline,x=_===void 0?"top":_,S=n.width,C=n.height,T=S!=null?S:(a===void 0?0:a)+Gt(n.text,r,p===void 0?"normal":p,t.family)+u,b=C!=null?C:l+r+d;switch(y){case"left":case"start":e=v;break;case"right":case"end":e=v-T;break;default:e=v-T/2}switch(x){case"top":case"hanging":o=g;break;case"bottom":case"ideographic":case"alphabetic":o=g-b;break;default:o=g-b/2}return{x:e,y:o,width:T,height:b}}function vi(n,t,e){var o=pi(t,e),i=o.x,r=o.y;return!(i>n.x||n.x>i+o.width||r>n.y||n.y>r+o.height)}function Me(n,t,e){var o=t.text,i=e.color,r=i===void 0?"currentColor":i,a=e.size,s=a===void 0?12:a,l=e.family,c=e.weight,u=e.paddingLeft,h=u===void 0?0:u,d=e.paddingTop,p=d===void 0?0:d,v=e.paddingRight,g=v===void 0?0:v,m=pi(t,e);Pe(n,m,P(P({},e),{color:e.backgroundColor})),n.textAlign="left",n.textBaseline="top",n.font=At(s,c,l),n.fillStyle=r,n.fillText(o,m.x+h,m.y+p,m.width-h-g)}var gi={name:"text",checkEventOn:function(n,t,e){return vi(n,t,e)},draw:function(n,t,e){Me(n,t,e)}},Eo=Me;function fi(n,t){if(2>Math.abs(Math.sqrt((h=(c=n).x-(u=t).x)*h+(d=c.y-u.y)*d)-t.r)){var e=t.r,o=t.startAngle,i=t.endAngle,r=e*Math.cos(o)+t.x,a=e*Math.sin(o)+t.y,s=e*Math.cos(i)+t.x,l=e*Math.sin(i)+t.y;return!(n.x>Math.max(r,s)+2||Math.min(r,s)-2>n.x||n.y>Math.max(a,l)+2||Math.min(a,l)-2>n.y)}var c,u,h,d;return!1}function mi(n,t,e){var o=t.x,i=t.y,r=t.r,a=t.startAngle,s=t.endAngle,l=e.style,c=l===void 0?f.LineType.Solid:l,u=e.size,h=e.color,d=h===void 0?"currentColor":h,p=e.dashedValue,v=p===void 0?[2,2]:p;n.lineWidth=u===void 0?1:u,n.strokeStyle=d,n.setLineDash(c===f.LineType.Dashed?v:[]),n.beginPath(),n.arc(o,i,r,a,s),n.stroke(),n.closePath()}var Io={name:"arc",checkEventOn:fi,draw:function(n,t,e){mi(n,t,e)}},Jt={};[bo,po,To,wo,gi,gi,Io].forEach(function(n){Jt[n.name]=Ue.extend(n)});var St=function(n){function t(e){var o=n.call(this)||this;return o._widget=e,o}return B(t,n),t.prototype.getWidget=function(){return this._widget},t.prototype.createFigure=function(e,o,i,r){var a=function(c){var u;return(u=Jt[c])!==null&&u!==void 0?u:null}(e);if(a!==null){var s=new a({name:e,attrs:o,styles:i});if(r!==void 0){for(var l in r)r.hasOwnProperty(l)&&s.registerEvent(l,r[l]);this.addChild(s)}return s}return null},t.prototype.draw=function(e){this.clear(),this.drawImp(e)},t}(we),Do=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return B(t,n),t.prototype.drawImp=function(e){var o,i=this,r=this.getWidget(),a=this.getWidget().getPane(),s=a.getChart(),l=r.getBounding(),c=s.getStyles().grid;if(c.show){e.save(),e.globalCompositeOperation="destination-over";var u=c.horizontal;u.show&&a.getAxisComponent().getTicks().forEach(function(d){var p;(p=i.createFigure("line",{coordinates:[{x:0,y:d.coord},{x:l.width,y:d.coord}]},u))===null||p===void 0||p.draw(e)});var h=c.vertical;h.show&&((o=s.getPaneById(lt))===null||o===void 0?void 0:o.getAxisComponent()).getTicks().forEach(function(d){var p;(p=i.createFigure("line",{coordinates:[{x:d.coord,y:0},{x:d.coord,y:l.height}]},h))===null||p===void 0||p.draw(e)}),e.restore()}},t}(St),ke=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return B(t,n),t.prototype.eachChildren=function(e){var o=this.getWidget().getPane().getChart().getChartStore(),i=o.getVisibleDataList(),r=o.getTimeScaleStore().getBarSpace();i.forEach(function(a,s){e(a,r,s)})},t}(St),yi=function(n){function t(){var e=n!==null&&n.apply(this,arguments)||this;return e._boundCandleBarClickEvent=function(o){return function(){return e.getWidget().getPane().getChart().getChartStore().getActionStore().execute(f.ActionType.OnCandleBarClick,o),!1}},e}return B(t,n),t.prototype.drawImp=function(e){var o=this,i=this.getWidget().getPane(),r=i.getId()===rt,a=i.getChart().getChartStore(),s=this.getCandleBarOptions(a);if(s!==null){var l=i.getAxisComponent();this.eachChildren(function(c,u){o._drawCandleBar(e,l,c,u,s,r)})}},t.prototype.getCandleBarOptions=function(e){var o=e.getStyles().candle;return{type:o.type,styles:o.bar}},t.prototype._drawCandleBar=function(e,o,i,r,a,s){var l,c,u,h=this,d=i.data,p=i.x,v=d.open,g=d.high,m=d.low,y=d.close,_=r.halfGapBar,x=r.gapBar,S=a.type,C=a.styles;y>v?(l=C.upColor,c=C.upBorderColor,u=C.upWickColor):v>y?(l=C.downColor,c=C.downBorderColor,u=C.downWickColor):(l=C.noChangeColor,c=C.noChangeBorderColor,u=C.noChangeWickColor);var T=o.convertToPixel(v),b=o.convertToPixel(y),w=[T,b,o.convertToPixel(g),o.convertToPixel(m)];w.sort(function(I,M){return I-M});var E=Math.max(1,w[2]-w[1]),D=[];S!==f.CandleType.Ohlc?(D.push({name:"rect",attrs:{x:p-.5,y:w[0],width:1,height:w[1]-w[0]},styles:{color:u}}),D.push(S===f.CandleType.CandleStroke||S===f.CandleType.CandleUpStroke&&y>v||S===f.CandleType.CandleDownStroke&&v>y?{name:"rect",attrs:{x:p-_+.5,y:w[1],width:x-1,height:E},styles:{style:f.PolygonType.Stroke,borderColor:c}}:{name:"rect",attrs:{x:p-_+.5,y:w[1],width:x-1,height:E},styles:{style:f.PolygonType.StrokeFill,color:l,borderColor:c}}),D.push({name:"rect",attrs:{x:p-.5,y:w[2],width:1,height:w[3]-w[2]},styles:{color:u}})):D=[{name:"rect",attrs:{x:p-.5,y:w[0],width:1,height:w[3]-w[0]},styles:{color:l}},{name:"rect",attrs:{x:p-_,y:T,width:_,height:1},styles:{color:l}},{name:"rect",attrs:{x:p,y:b,width:_,height:1},styles:{color:l}}],D.forEach(function(I){var M,F,L=I.attrs,O=I.styles;s&&(F={mouseClickEvent:h._boundCandleBarClickEvent(i)}),(M=h.createFigure("rect",L,O,F))===null||M===void 0||M.draw(e)})},t}(ke),Po=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return B(t,n),t.prototype.getCandleBarOptions=function(e){var o,i,r=this.getWidget().getPane();if(!r.getAxisComponent().isInCandle()){var a=e.getIndicatorStore().getInstances(r.getId());try{for(var s=qt(a),l=s.next();!l.done;l=s.next()){var c=l.value[1];if(c.shouldOhlc&&c.visible){var u=c.styles,h=e.getStyles().indicator,d=$(u,"ohlc.upColor",h.ohlc.upColor),p=$(u,"ohlc.downColor",h.ohlc.downColor),v=$(u,"ohlc.noChangeColor",h.ohlc.noChangeColor);return{type:f.CandleType.Ohlc,styles:{upColor:d,downColor:p,noChangeColor:v,upBorderColor:d,downBorderColor:p,noChangeBorderColor:v,upWickColor:d,downWickColor:p,noChangeWickColor:v}}}}}catch(g){o={error:g}}finally{try{l&&!l.done&&(i=s.return)&&i.call(s)}finally{if(o)throw o.error}}}return null},t.prototype.drawImp=function(e){var o,i=this;n.prototype.drawImp.call(this,e);var r=this.getWidget(),a=r.getPane(),s=a.getChart(),l=r.getBounding(),c=(o=s.getPaneById(lt))===null||o===void 0?void 0:o.getAxisComponent(),u=a.getAxisComponent(),h=s.getChartStore(),d=h.getDataList(),p=h.getTimeScaleStore(),v=p.getVisibleRange(),g=h.getIndicatorStore().getInstances(a.getId()),m=h.getStyles().indicator;g.forEach(function(y){var _;if(y.visible){var x=!1;if(y.draw!==null&&(e.save(),x=(_=y.draw({ctx:e,kLineDataList:d,indicator:y,visibleRange:v,bounding:l,barSpace:p.getBarSpace(),defaultStyles:m,xAxis:c,yAxis:u}))!==null&&_!==void 0&&_,e.restore()),!x){var S=y.result;i.eachChildren(function(C,T){var b,w,E,D=T.halfGapBar,I=T.gapBar,M=C.dataIndex,F=C.x,L=c.convertToPixel(M-1),O=c.convertToPixel(M+1),H=(b=S[M-1])!==null&&b!==void 0?b:{},Y=(w=S[M])!==null&&w!==void 0?w:{},tt=(E=S[M+1])!==null&&E!==void 0?E:{},at={x:L},ct={x:F},X={x:O};y.figures.forEach(function(z){var Q=z.key;at[Q]=u.convertToPixel(H[Q]),ct[Q]=u.convertToPixel(Y[Q]),X[Q]=u.convertToPixel(tt[Q])}),be(d,y,M,m,function(z,Q){var st,ut,It;if(R(Y[z.key])){var vt=ct[z.key],gt=(st=z.attrs)===null||st===void 0?void 0:st.call(z,{coordinate:{prev:at,current:ct,next:X},bounding:l,barSpace:T,xAxis:c,yAxis:u});if(!R(gt))switch(z.type){case"circle":gt={x:F,y:vt,r:D};break;case"rect":case"bar":var Dt=(ut=z.baseValue)!==null&&ut!==void 0?ut:u.getExtremum().min,Ct=u.convertToPixel(Dt),ht=Math.abs(Ct-vt);Dt!==Y[z.key]&&(ht=Math.max(1,ht)),gt={x:F-D,y:vt>Ct?Ct:vt,width:I,height:ht};break;case"line":V(ct[z.key])&&V(X[z.key])&&(gt={coordinates:[{x:ct.x,y:ct[z.key]},{x:X.x,y:X[z.key]}]})}if(R(gt)){var pe=z.type;(It=i.createFigure(pe==="bar"?"rect":pe,gt,Q))===null||It===void 0||It.draw(e)}}})})}}})},t}(yi),Mo=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return B(t,n),t.prototype.drawImp=function(e){var o=this.getWidget(),i=o.getPane(),r=o.getBounding(),a=o.getPane().getChart().getChartStore(),s=a.getTooltipStore().getCrosshair(),l=a.getStyles().crosshair;if(s.paneId!==void 0&&l.show){if(s.paneId===i.getId()){var c=s.y;this._drawLine(e,[{x:0,y:c},{x:r.width,y:c}],l.horizontal)}var u=s.realX;this._drawLine(e,[{x:u,y:0},{x:u,y:r.height}],l.vertical)}},t.prototype._drawLine=function(e,o,i){var r;if(i.show){var a=i.line;a.show&&((r=this.createFigure("line",{coordinates:o},a))===null||r===void 0||r.draw(e))}},t}(St),_i=function(n){function t(){var e=n!==null&&n.apply(this,arguments)||this;return e._boundIconClickEvent=function(o,i){return function(){return e.getWidget().getPane().getChart().getChartStore().getActionStore().execute(f.ActionType.OnTooltipIconClick,P(P({},o),{iconId:i})),!0}},e._boundIconMouseMoveEvent=function(o,i){return function(){return e.getWidget().getPane().getChart().getChartStore().getTooltipStore().setActiveIcon(P(P({},o),{iconId:i})),!0}},e}return B(t,n),t.prototype.drawImp=function(e){var o=this.getWidget(),i=o.getPane(),r=i.getChart().getChartStore(),a=r.getTooltipStore().getCrosshair();if(a.kLineData!==void 0){var s=o.getBounding(),l=r.getCustomApi(),c=r.getThousandsSeparator(),u=r.getIndicatorStore().getInstances(i.getId()),h=r.getTooltipStore().getActiveIcon(),d=r.getStyles().indicator;this.drawIndicatorTooltip(e,i.getId(),r.getDataList(),a,h,u,l,c,s,d)}},t.prototype.drawIndicatorTooltip=function(e,o,i,r,a,s,l,c,u,h,d){var p=this,v=h.tooltip,g=0;if(this.isDrawTooltip(r,v)){var m=v.text,y=0,_=d!=null?d:0,x=0;s.forEach(function(S){var C=p.getIndicatorTooltipData(i,r,S,l,c,h),T=C.name,b=C.calcParamsText,w=C.values,E=T.length>0,D=w.length>0;if(E||D){var I=it(p.classifyTooltipIcons(C.icons),3),M=I[1],F=I[2],L=it(p.drawStandardTooltipIcons(e,u,{paneId:o,indicatorName:S.name,iconId:""},a,I[0],y,_,x),4);if(y=L[0],_=L[1],g+=L[3],x=L[2],E){var O=T;b.length>0&&(O="".concat(O).concat(b));var H=it(p.drawStandardTooltipLabels(e,u,[{title:{text:"",color:m.color},value:{text:O,color:m.color}}],y,_,x,m),4);y=H[0],_=H[1],g+=H[3],x=H[2]}var Y=it(p.drawStandardTooltipIcons(e,u,{paneId:o,indicatorName:S.name,iconId:""},a,M,y,_,x),4);if(y=Y[0],_=Y[1],g+=Y[3],x=Y[2],D){var tt=it(p.drawStandardTooltipLabels(e,u,w,y,_,x,m),4);y=tt[0],_=tt[1],g+=tt[3],x=tt[2]}var at=it(p.drawStandardTooltipIcons(e,u,{paneId:o,indicatorName:S.name,iconId:""},a,F,y,_,x),4);y=0,g+=at[3],_=at[1]+at[2],x=0}})}return g},t.prototype.drawStandardTooltipIcons=function(e,o,i,r,a,s,l,c){var u=this,h=s,d=l,p=0,v=0,g=0;return a.length>0&&(a.forEach(function(m){var y=m.marginLeft,_=m.marginTop,x=m.marginRight,S=m.marginBottom,C=m.paddingLeft,T=m.paddingTop,b=m.paddingRight,w=m.paddingBottom,E=m.size,D=m.icon;e.font=At(E,"normal",m.fontFamily),p+=y+C+e.measureText(D).width+b+x,v=Math.max(v,_+T+E+w+S)}),h+p>o.width?(h=a[0].marginLeft,d+=c,g=v):g=Math.max(0,v-c),a.forEach(function(m){var y,_=m.marginRight,x=m.paddingLeft,S=m.paddingRight,C=m.icon,T=(r==null?void 0:r.paneId)===i.paneId&&(r==null?void 0:r.indicatorName)===i.indicatorName&&(r==null?void 0:r.iconId)===m.id;(y=u.createFigure("text",{text:C,x:h+=m.marginLeft,y:d+m.marginTop},{paddingLeft:x,paddingTop:m.paddingTop,paddingRight:S,paddingBottom:m.paddingBottom,color:T?m.activeColor:m.color,size:m.size,family:m.fontFamily,backgroundColor:T?m.activeBackgroundColor:m.backgroundColor},{mouseClickEvent:u._boundIconClickEvent(i,m.id),mouseMoveEvent:u._boundIconMouseMoveEvent(i,m.id)}))===null||y===void 0||y.draw(e),h+=x+e.measureText(C).width+S+_})),[h,d,Math.max(c,v),g]},t.prototype.drawStandardTooltipLabels=function(e,o,i,r,a,s,l){var c=this,u=r,h=a,d=0,p=0,v=s;if(i.length>0){var g=l.marginLeft,m=l.marginTop,y=l.marginRight,_=l.marginBottom,x=l.size,S=l.family,C=l.weight;e.font=At(x,C,S),i.forEach(function(T){var b,w,E=T.title,D=T.value,I=e.measureText(E.text).width,M=e.measureText(D.text).width,F=x+m+_;u+g+(I+M)+y>o.width?(u=g,h+=F,p+=F):(u+=g,p+=Math.max(0,F-v)),v=d=Math.max(v,F),E.text.length>0&&((b=c.createFigure("text",{x:u,y:h+m,text:E.text},{color:E.color,size:x,family:S,weight:C}))===null||b===void 0||b.draw(e),u+=I),(w=c.createFigure("text",{x:u,y:h+m,text:D.text},{color:D.color,size:x,family:S,weight:C}))===null||w===void 0||w.draw(e),u+=M+y})}return[u,h,d,p]},t.prototype.isDrawTooltip=function(e,o){var i=o.showRule;return i===f.TooltipShowRule.Always||i===f.TooltipShowRule.FollowCross&&e.paneId!==void 0},t.prototype.getIndicatorTooltipData=function(e,o,i,r,a,s){var l,c,u,h=s.tooltip,d=h.showName?i.shortName:"",p="",v=i.calcParams;v.length>0&&h.showParams&&(p="(".concat(v.join(","),")"));var g={name:d,calcParamsText:p,values:[],icons:h.icons},m=o.dataIndex,y=(l=i.result)!==null&&l!==void 0?l:[],_=[];if(i.visible){var x=(c=y[m])!==null&&c!==void 0?c:{};be(e,i,m,s,function(L,O){if(L.title!==void 0){var H=O.color,Y=x[L.key];R(Y)&&(Y=U(Y,i.precision),i.shouldFormatBigNumber&&(Y=r.formatBigNumber(Y))),_.push({title:{text:L.title,color:H},value:{text:J(Y!=null?Y:h.defaultValue,a),color:H}})}}),g.values=_}if(i.createTooltipDataSource!==null){var S=this.getWidget(),C=S.getPane(),T=C.getChart().getChartStore(),b=i.createTooltipDataSource({kLineDataList:e,indicator:i,visibleRange:T.getTimeScaleStore().getVisibleRange(),bounding:S.getBounding(),crosshair:o,defaultStyles:s,xAxis:(u=C.getChart().getPaneById(lt))===null||u===void 0?void 0:u.getAxisComponent(),yAxis:C.getAxisComponent()}),w=b.name,E=b.calcParamsText,D=b.values,I=b.icons;if(w!==void 0&&h.showName&&(g.name=w),E!==void 0&&h.showParams&&(g.calcParamsText=E),I!==void 0&&(g.icons=I),D!==void 0&&i.visible){var M=[],F=s.tooltip.text.color;D.forEach(function(L){var O={text:"",color:F};N(L.title)?O=L.title:O.text=L.title;var H={text:"",color:F};N(L.value)?H=L.value:H.text=L.value,H.text=J(H.text,a),M.push({title:O,value:H})}),g.values=M}}return g},t.prototype.classifyTooltipIcons=function(e){var o=[],i=[],r=[];return e.forEach(function(a){switch(a.position){case f.TooltipIconPosition.Left:o.push(a);break;case f.TooltipIconPosition.Middle:i.push(a);break;case f.TooltipIconPosition.Right:r.push(a)}}),[o,i,r]},t}(St),xi=function(n){function t(e){var o=n.call(this,e)||this;return o._initEvent(),o}return B(t,n),t.prototype._initEvent=function(){var e=this,o=this.getWidget().getPane(),i=o.getId(),r=o.getChart().getChartStore().getOverlayStore();this.registerEvent("mouseMoveEvent",function(a){var s,l=r.getProgressInstanceInfo();if(l!==null){var c=l.instance,u=l.paneId;c.isStart()&&(r.updateProgressInstanceInfo(i),u=i);var h=c.points.length-1,d="".concat(zt,"point_").concat(h);return c.isDrawing()&&u===i&&(c.eventMoveForDrawing(e._coordinateToPoint(l.instance,a)),(s=c.onDrawing)===null||s===void 0||s.call(c,P({overlay:c,figureKey:d,figureIndex:h},a))),e._figureMouseMoveEvent(c,1,d,h,0)(a)}return r.setHoverInstanceInfo({paneId:i,instance:null,figureType:0,figureKey:"",figureIndex:-1,attrsIndex:-1},a),!1}).registerEvent("mouseClickEvent",function(a){var s,l,c=r.getProgressInstanceInfo();if(c!==null){var u=c.instance,h=c.paneId;u.isStart()&&(r.updateProgressInstanceInfo(i,!0),h=i);var d=u.points.length-1,p="".concat(zt,"point_").concat(d);return u.isDrawing()&&h===i&&(u.eventMoveForDrawing(e._coordinateToPoint(u,a)),(s=u.onDrawing)===null||s===void 0||s.call(u,P({overlay:u,figureKey:p,figureIndex:d},a)),u.nextStep(),u.isDrawing()||(r.progressInstanceComplete(),(l=u.onDrawEnd)===null||l===void 0||l.call(u,P({overlay:u,figureKey:p,figureIndex:d},a)))),e._figureMouseClickEvent(u,1,p,d,0)(a)}return r.setClickInstanceInfo({paneId:i,instance:null,figureType:0,figureKey:"",figureIndex:-1,attrsIndex:-1},a),!1}).registerEvent("mouseDoubleClickEvent",function(a){var s,l=r.getProgressInstanceInfo();if(l!==null){var c=l.instance,u=l.paneId;if(c.isDrawing()&&u===i&&(c.forceComplete(),!c.isDrawing())){r.progressInstanceComplete();var h=c.points.length-1,d="".concat(zt,"point_").concat(h);(s=c.onDrawEnd)===null||s===void 0||s.call(c,P({overlay:c,figureKey:d,figureIndex:h},a))}var p=c.points.length-1;return e._figureMouseClickEvent(c,1,"".concat(zt,"point_").concat(p),p,0)(a)}return!1}).registerEvent("mouseRightClickEvent",function(a){var s=r.getProgressInstanceInfo();if(s!==null){var l=s.instance;if(l.isDrawing()){var c=l.points.length-1;return e._figureMouseRightClickEvent(l,1,"".concat(zt,"point_").concat(c),c,0)(a)}}return!1}).registerEvent("mouseUpEvent",function(a){var s,l=r.getPressedInstanceInfo(),c=l.instance;return c!==null&&((s=c.onPressedMoveEnd)===null||s===void 0||s.call(c,P({overlay:c,figureKey:l.figureKey,figureIndex:l.figureIndex},a))),r.setPressedInstanceInfo({paneId:i,instance:null,figureType:0,figureKey:"",figureIndex:-1,attrsIndex:-1}),!1}).registerEvent("pressedMouseMoveEvent",function(a){var s,l,c=r.getPressedInstanceInfo(),u=c.instance,h=c.figureType,d=c.figureIndex;if(u!==null){if(!(u.lock||(l=(s=u.onPressedMoving)===null||s===void 0?void 0:s.call(u,P({overlay:u,figureIndex:d,figureKey:c.figureKey},a)))!==null&&l!==void 0&&l)){var p=e._coordinateToPoint(u,a);h===1?u.eventPressedPointMove(p,d):u.eventPressedOtherMove(p,e.getWidget().getPane().getChart().getChartStore().getTimeScaleStore())}return!0}return!1})},t.prototype._createFigureEvents=function(e,o,i,r,a,s){var l;if(!e.isDrawing()){var c=[];if(s!==void 0&&(G(s)?s&&(c=["mouseClickEvent","mouseDoubleClickEvent","mouseRightClickEvent","tapEvent","doubleTapEvent","mouseDownEvent","touchStartEvent","mouseMoveEvent","touchMoveEvent"]):c=s),c.length===0)return{mouseMoveEvent:this._figureMouseMoveEvent(e,o,i,r,a),mouseDownEvent:this._figureMouseDownEvent(e,o,i,r,a),mouseClickEvent:this._figureMouseClickEvent(e,o,i,r,a),mouseRightClickEvent:this._figureMouseRightClickEvent(e,o,i,r,a),mouseDoubleClickEvent:this._figureMouseDoubleClickEvent(e,o,i,r,a)};l={},c.includes("mouseMoveEvent")||c.includes("touchMoveEvent")||(l.mouseMoveEvent=this._figureMouseMoveEvent(e,o,i,r,a)),c.includes("mouseDownEvent")||c.includes("touchStartEvent")||(l.mouseDownEvent=this._figureMouseDownEvent(e,o,i,r,a)),c.includes("mouseClickEvent")||c.includes("tapEvent")||(l.mouseClickEvent=this._figureMouseClickEvent(e,o,i,r,a)),c.includes("mouseDoubleClickEvent")||c.includes("doubleTapEvent")||(l.mouseDoubleClickEvent=this._figureMouseDoubleClickEvent(e,o,i,r,a)),c.includes("mouseRightClickEvent")||(l.mouseRightClickEvent=this._figureMouseRightClickEvent(e,o,i,r,a))}return l},t.prototype._figureMouseMoveEvent=function(e,o,i,r,a){var s=this;return function(l){var c=s.getWidget().getPane();return c.getChart().getChartStore().getOverlayStore().setHoverInstanceInfo({paneId:c.getId(),instance:e,figureType:o,figureKey:i,figureIndex:r,attrsIndex:a},l),!0}},t.prototype._figureMouseDownEvent=function(e,o,i,r,a){var s=this;return function(l){var c,u=s.getWidget().getPane(),h=u.getId(),d=u.getChart().getChartStore().getOverlayStore();return e.startPressedMove(s._coordinateToPoint(e,l)),(c=e.onPressedMoveStart)===null||c===void 0||c.call(e,P({overlay:e,figureIndex:r,figureKey:i},l)),d.setPressedInstanceInfo({paneId:h,instance:e,figureType:o,figureKey:i,figureIndex:r,attrsIndex:a}),!0}},t.prototype._figureMouseClickEvent=function(e,o,i,r,a){var s=this;return function(l){var c=s.getWidget().getPane(),u=c.getId();return c.getChart().getChartStore().getOverlayStore().setClickInstanceInfo({paneId:u,instance:e,figureType:o,figureKey:i,figureIndex:r,attrsIndex:a},l),!0}},t.prototype._figureMouseDoubleClickEvent=function(e,o,i,r,a){return function(s){var l;return(l=e.onDoubleClick)===null||l===void 0||l.call(e,P(P({},s),{figureIndex:r,figureKey:i,overlay:e})),!0}},t.prototype._figureMouseRightClickEvent=function(e,o,i,r,a){var s=this;return function(l){var c,u;return(u=(c=e.onRightClick)===null||c===void 0?void 0:c.call(e,P({overlay:e,figureIndex:r,figureKey:i},l)))!==null&&u!==void 0&&u||s.getWidget().getPane().getChart().getChartStore().getOverlayStore().removeInstance(e),!0}},t.prototype._coordinateToPoint=function(e,o){var i,r,a={},s=this.getWidget().getPane(),l=s.getChart(),c=s.getId(),u=l.getChartStore().getTimeScaleStore();if(this.coordinateToPointTimestampDataIndexFlag()){var h=((i=l.getPaneById(lt))===null||i===void 0?void 0:i.getAxisComponent()).convertFromPixel(o.x),d=(r=u.dataIndexToTimestamp(h))!==null&&r!==void 0?r:void 0;a.dataIndex=h,a.timestamp=d}if(this.coordinateToPointValueFlag()){var p=s.getAxisComponent(),v=p.convertFromPixel(o.y);if(e.mode!==f.OverlayMode.Normal&&c===rt&&a.dataIndex!==void 0){var g=u.getDataByDataIndex(a.dataIndex);if(g!==null){var m=e.modeSensitivity;if(v>g.high)if(e.mode===f.OverlayMode.WeakMagnet){var y=p.convertToPixel(g.high);p.convertFromPixel(y-m)>v&&(v=g.high)}else v=g.high;else if(g.low>v)if(e.mode===f.OverlayMode.WeakMagnet){var _=p.convertToPixel(g.low);v>p.convertFromPixel(_-m)&&(v=g.low)}else v=g.low;else{var x=Math.max(g.open,g.close),S=Math.min(g.open,g.close);v=v>x?g.high-v>v-x?x:g.high:S>v?S-v>v-g.low?g.low:S:v-S>x-v?x:S}}}a.value=v}return a},t.prototype.coordinateToPointValueFlag=function(){return!0},t.prototype.coordinateToPointTimestampDataIndexFlag=function(){return!0},t.prototype.dispatchEvent=function(e,o,i){return this.getWidget().getPane().getChart().getChartStore().getOverlayStore().isDrawing()?this.onEvent(e,o,i):n.prototype.dispatchEvent.call(this,e,o,i)},t.prototype.checkEventOn=function(){return!0},t.prototype.drawImp=function(e){var o,i=this,r=this.getWidget(),a=r.getPane(),s=a.getId(),l=a.getChart(),c=a.getAxisComponent(),u=(o=l.getPaneById(lt))===null||o===void 0?void 0:o.getAxisComponent(),h=r.getBounding(),d=l.getChartStore(),p=d.getCustomApi(),v=d.getThousandsSeparator(),g=d.getTimeScaleStore(),m=g.getDateTimeFormat(),y=g.getBarSpace(),_=d.getPrecision(),x=d.getStyles().overlay,S=d.getOverlayStore(),C=S.getHoverInstanceInfo(),T=S.getClickInstanceInfo();this.getCompleteOverlays(S,s).forEach(function(E){E.visible&&i._drawOverlay(e,E,h,y,_,m,p,v,x,u,c,C,T,g)});var b=S.getProgressInstanceInfo();if(b!==null){var w=this.getProgressOverlay(b,s);w!==null&&w.visible&&this._drawOverlay(e,w,h,y,_,m,p,v,x,u,c,C,T,g)}},t.prototype._drawOverlay=function(e,o,i,r,a,s,l,c,u,h,d,p,v,g){var m=o.points.map(function(_){var x,S,C=_.dataIndex;_.timestamp!==void 0&&(C=g.timestampToDataIndex(_.timestamp));var T={x:0,y:0};return C!==void 0&&(T.x=(x=h==null?void 0:h.convertToPixel(C))!==null&&x!==void 0?x:0),_.value!==void 0&&(T.y=(S=d==null?void 0:d.convertToPixel(_.value))!==null&&S!==void 0?S:0),T});if(m.length>0){var y=[].concat(this.getFigures(o,m,i,r,a,c,s,u,h,d));this.drawFigures(e,o,y,u)}this.drawDefaultFigures(e,o,m,i,a,s,l,c,u,h,d,p,v)},t.prototype.drawFigures=function(e,o,i,r){var a=this;i.forEach(function(s,l){var c=s.type,u=s.styles,h=s.ignoreEvent;[].concat(s.attrs).forEach(function(d,p){var v,g,m,y=a._createFigureEvents(o,2,(v=s.key)!==null&&v!==void 0?v:"",l,p,h),_=P(P(P({},r[c]),(g=o.styles)===null||g===void 0?void 0:g[c]),u);(m=a.createFigure(c,d,_,y))===null||m===void 0||m.draw(e)})})},t.prototype.getCompleteOverlays=function(e,o){return e.getInstances(o)},t.prototype.getProgressOverlay=function(e,o){return e.paneId===o?e.instance:null},t.prototype.getFigures=function(e,o,i,r,a,s,l,c,u,h){var d,p;return(p=(d=e.createPointFigures)===null||d===void 0?void 0:d.call(e,{overlay:e,coordinates:o,bounding:i,barSpace:r,precision:a,thousandsSeparator:s,dateTimeFormat:l,defaultStyles:c,xAxis:u,yAxis:h}))!==null&&p!==void 0?p:[]},t.prototype.drawDefaultFigures=function(e,o,i,r,a,s,l,c,u,h,d,p,v){var g,m,y=this;if(o.needDefaultPointFigure&&(((g=p.instance)===null||g===void 0?void 0:g.id)===o.id&&p.figureType!==0||((m=v.instance)===null||m===void 0?void 0:m.id)===o.id&&v.figureType!==0)){var _=o.styles,x=P(P({},u.point),_==null?void 0:_.point);i.forEach(function(S,C){var T,b,w,E=S.x,D=S.y,I=x.radius,M=x.color,F=x.borderColor,L=x.borderSize;((T=p.instance)===null||T===void 0?void 0:T.id)===o.id&&p.figureType===1&&p.figureIndex===C&&(I=x.activeRadius,M=x.activeColor,F=x.activeBorderColor,L=x.activeBorderSize),(b=y.createFigure("circle",{x:E,y:D,r:I+L},{color:F},y._createFigureEvents(o,1,"".concat(zt,"point_").concat(C),C,0)))===null||b===void 0||b.draw(e),(w=y.createFigure("circle",{x:E,y:D,r:I},{color:M}))===null||w===void 0||w.draw(e)})}},t}(St),Si=function(n){function t(e,o){var i=n.call(this,e,o)||this;return i._gridView=new Do(i),i._indicatorView=new Po(i),i._crosshairLineView=new Mo(i),i._tooltipView=i.createTooltipView(),i._overlayView=new xi(i),i.addChild(i._tooltipView),i.addChild(i._overlayView),i.getContainer().style.cursor="crosshair",i.registerEvent("mouseMoveEvent",function(){return o.getChart().getChartStore().getTooltipStore().setActiveIcon(),!1}),i}return B(t,n),t.prototype.getName=function(){return nt},t.prototype.updateMain=function(e){this.updateMainContent(e),this._indicatorView.draw(e),this._gridView.draw(e)},t.prototype.createTooltipView=function(){return new _i(this)},t.prototype.updateMainContent=function(e){},t.prototype.updateOverlay=function(e){this._overlayView.draw(e),this._crosshairLineView.draw(e),this._tooltipView.draw(e)},t}(De),ko=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return B(t,n),t.prototype.drawImp=function(e){var o,i,r=this.getWidget(),a=r.getPane(),s=a.getChart(),l=r.getBounding(),c=a.getAxisComponent(),u=s.getStyles().candle.area,h=[],d=[],p=Number.MAX_SAFE_INTEGER;this.eachChildren(function(S,C,T){var b=S.x,w=C.halfGapBar,E=S.data[u.value];if(V(E)){var D=c.convertToPixel(E);if(T===0){var I=b-w;d.push({x:I,y:l.height}),d.push({x:I,y:D}),h.push({x:I,y:D})}h.push({x:b,y:D}),d.push({x:b,y:D}),p=Math.min(p,D)}});var v=d.length;if(v>0){var g=d[v-1],m=g.x;h.push({x:m,y:g.y}),d.push({x:m,y:g.y}),d.push({x:m,y:l.height})}if(h.length>0&&((o=this.createFigure("line",{coordinates:h},{color:u.lineColor,size:u.lineSize}))===null||o===void 0||o.draw(e)),d.length>0){var y=u.backgroundColor,_=void 0;if(W(y)){var x=e.createLinearGradient(0,l.height,0,p);try{y.forEach(function(S){x.addColorStop(S.offset,S.color)})}catch{}_=x}else _=y;(i=this.createFigure("polygon",{coordinates:d},{color:_}))===null||i===void 0||i.draw(e)}},t}(ke),Ao=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return B(t,n),t.prototype.drawImp=function(e){var o=this.getWidget().getPane(),i=o.getChart().getChartStore(),r=i.getStyles().candle.priceMark,a=r.high,s=r.low;if(r.show&&(a.show||s.show)){var l=i.getThousandsSeparator(),c=i.getPrecision(),u=o.getAxisComponent(),h=Number.MIN_SAFE_INTEGER,d=0,p=Number.MAX_SAFE_INTEGER,v=0;this.eachChildren(function(y){var _=y.data,x=y.x;_.high>h&&(h=_.high,d=x),p>_.low&&(p=_.low,v=x)});var g=u.convertToPixel(h),m=u.convertToPixel(p);a.show&&h!==Number.MIN_SAFE_INTEGER&&this._drawMark(e,J(U(h,c.price),l),{x:d,y:g},m>g?[-2,-5]:[2,5],a),s.show&&p!==Number.MAX_SAFE_INTEGER&&this._drawMark(e,J(U(p,c.price),l),{x:v,y:m},m>g?[2,5]:[-2,-5],s)}},t.prototype._drawMark=function(e,o,i,r,a){var s,l,c,u,h,d,p=i.x,v=i.y+r[0];(s=this.createFigure("line",{coordinates:[{x:p-2,y:v+r[0]},{x:p,y:v},{x:p+2,y:v+r[0]}]},{color:a.color}))===null||s===void 0||s.draw(e),p>this.getWidget().getBounding().width/2?(h=(u=p-5)-a.textOffset,d="right"):(d="left",h=(u=p+5)+a.textOffset);var g=v+r[1];(l=this.createFigure("line",{coordinates:[{x:p,y:v},{x:p,y:g},{x:u,y:g}]},{color:a.color}))===null||l===void 0||l.draw(e),(c=this.createFigure("text",{x:h,y:g,text:o,align:d,baseline:"middle"},{color:a.color,size:a.textSize,family:a.textFamily,weight:a.textWeight}))===null||c===void 0||c.draw(e)},t}(ke),Fo=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return B(t,n),t.prototype.drawImp=function(e){var o,i=this.getWidget(),r=i.getPane(),a=i.getBounding(),s=r.getChart().getChartStore(),l=s.getStyles().candle.priceMark,c=l.last,u=c.line;if(l.show&&c.show&&u.show){var h=r.getAxisComponent(),d=s.getDataList(),p=d[d.length-1];if(p!=null){var v=p.close,g=p.open,m=h.convertToNicePixel(v);(o=this.createFigure("line",{coordinates:[{x:0,y:m},{x:a.width,y:m}]},{style:u.style,color:v>g?c.upColor:g>v?c.downColor:c.noChangeColor,size:u.size,dashedValue:u.dashedValue}))===null||o===void 0||o.draw(e)}}},t}(St),he={"zh-CN":{time:"\u65F6\u95F4\uFF1A",open:"\u5F00\uFF1A",high:"\u9AD8\uFF1A",low:"\u4F4E\uFF1A",close:"\u6536\uFF1A",volume:"\u6210\u4EA4\u91CF\uFF1A",change:"\u6DA8\u5E45\uFF1A"},"en-US":{time:"Time: ",open:"Open: ",high:"High: ",low:"Low: ",close:"Close: ",volume:"Volume: ",change:"Change: "}},Lo=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return B(t,n),t.prototype.drawImp=function(e){var o,i=this.getWidget(),r=i.getPane(),a=r.getId(),s=r.getChart().getChartStore(),l=s.getTooltipStore().getCrosshair();if(l.kLineData!==void 0){var c=i.getBounding(),u=(o=r.getYAxisWidget())===null||o===void 0?void 0:o.getBounding(),h=s.getDataList(),d=s.getPrecision(),p=s.getLocale(),v=s.getCustomApi(),g=s.getThousandsSeparator(),m=s.getTooltipStore().getActiveIcon(),y=s.getIndicatorStore().getInstances(r.getId()),_=s.getTimeScaleStore().getDateTimeFormat(),x=s.getStyles(),S=x.candle,C=x.indicator;if(S.tooltip.showType===f.TooltipShowType.Rect&&C.tooltip.showType===f.TooltipShowType.Rect){var T=this.isDrawTooltip(l,S.tooltip),b=this.isDrawTooltip(l,C.tooltip);this._drawRectTooltip(e,h,y,c,u,l,d,_,p,v,g,T,b,x,0)}else if(S.tooltip.showType===f.TooltipShowType.Standard&&C.tooltip.showType===f.TooltipShowType.Standard){var w=this._drawCandleStandardTooltip(e,h,a,c,l,m,d,_,p,v,g,S);this.drawIndicatorTooltip(e,a,h,l,m,y,v,g,c,C,w)}else if(S.tooltip.showType===f.TooltipShowType.Rect&&C.tooltip.showType===f.TooltipShowType.Standard){var E=this.drawIndicatorTooltip(e,a,h,l,m,y,v,g,c,C,0);T=this.isDrawTooltip(l,S.tooltip),this._drawRectTooltip(e,h,y,c,u,l,d,_,p,v,g,T,!1,x,E)}else{var D=this._drawCandleStandardTooltip(e,h,a,c,l,m,d,_,p,v,g,S);b=this.isDrawTooltip(l,C.tooltip),this._drawRectTooltip(e,h,y,c,u,l,d,_,p,v,g,!1,b,x,D)}}},t.prototype._drawCandleStandardTooltip=function(e,o,i,r,a,s,l,c,u,h,d,p){var v,g,m,y=p.tooltip,_=y.text,x=0;if(this.isDrawTooltip(a,y)){var S=(v=a.dataIndex)!==null&&v!==void 0?v:0,C=this._getCandleTooltipData({prev:(g=o[S-1])!==null&&g!==void 0?g:null,current:a.kLineData,next:(m=o[S+1])!==null&&m!==void 0?m:null},l,c,u,h,d,p),T=0,b=0,w=0,E=it(this.classifyTooltipIcons(y.icons),3),D=E[1],I=E[2],M=it(this.drawStandardTooltipIcons(e,r,{paneId:i,indicatorName:"",iconId:""},s,E[0],T,b,0),4);x+=M[3];var F=it(this.drawStandardTooltipIcons(e,r,{paneId:i,indicatorName:"",iconId:""},s,D,T=M[0],b=M[1],w=M[2]),4);if(T=F[0],b=F[1],x+=F[3],w=F[2],C.length>0){var L=it(this.drawStandardTooltipLabels(e,r,C,T,b,w,_),4);T=L[0],b=L[1],x+=L[3],w=L[2]}var O=it(this.drawStandardTooltipIcons(e,r,{paneId:i,indicatorName:"",iconId:""},s,I,T,b,w),4);T=O[0],b=O[1],x+=O[3],w=O[2]}return x},t.prototype._drawRectTooltip=function(e,o,i,r,a,s,l,c,u,h,d,p,v,g,m){var y,_,x,S,C,T=this,b=g.candle,w=g.indicator,E=b.tooltip,D=w.tooltip;if(p||v){var I=(y=s.dataIndex)!==null&&y!==void 0?y:0,M=this._getCandleTooltipData({prev:(_=o[I-1])!==null&&_!==void 0?_:null,current:s.kLineData,next:(x=o[I+1])!==null&&x!==void 0?x:null},l,c,u,h,d,b),F=E.text,L=F.marginLeft,O=F.marginRight,H=F.marginTop,Y=F.marginBottom,tt=F.size,at=F.weight,ct=F.family,X=E.rect,z=X.position,Q=X.paddingLeft,st=X.paddingRight,ut=X.paddingTop,It=X.paddingBottom,vt=X.offsetLeft,gt=X.offsetRight,Dt=X.offsetTop,Ct=X.offsetBottom,ht=X.borderSize,pe=X.borderRadius,Qo=X.borderColor,Jo=X.color,te=0,Lt=0,Pt=0;p&&(e.font=At(tt,at,ct),M.forEach(function(Et){var dt=Et.value,pt="".concat(Et.title.text).concat(dt.text),ft=e.measureText(pt).width+L+O;te=Math.max(te,ft)}),Pt+=(Y+H+tt)*M.length);var Rt=D.text,Pi=Rt.marginLeft,Mi=Rt.marginRight,ki=Rt.marginTop,Ai=Rt.marginBottom,ee=Rt.size,Le=Rt.weight,Re=Rt.family,Fi=[];if(v&&(e.font=At(ee,Le,Re),i.forEach(function(Et){var dt,pt=(dt=T.getIndicatorTooltipData(o,s,Et,h,d,w).values)!==null&&dt!==void 0?dt:[];Fi.push(pt),pt.forEach(function(ft){var Bt=ft.value,ve="".concat(ft.title.text).concat(Bt.text),on=e.measureText(ve).width+Pi+Mi;te=Math.max(te,on),Pt+=ki+Ai+ee})})),(Lt+=te)!==0&&Pt!==0){Lt+=2*ht+Q+st,Pt+=2*ht+ut+It;var Li=z===ne.Pointer&&s.paneId===rt,Ri=((S=s.realX)!==null&&S!==void 0?S:0)>r.width/2,bt=0;if(Li){var Bi=s.realX;bt=Ri?Bi-gt-Lt:Bi+vt}else Ri?(bt=vt,g.yAxis.inside&&g.yAxis.position===f.YAxisPosition.Left&&(bt+=a.width)):(bt=r.width-gt-Lt,g.yAxis.inside&&g.yAxis.position===f.YAxisPosition.Right&&(bt-=a.width));var Ht=m+Dt;Li&&((Ht=s.y-Pt/2)+Pt>r.height-Ct&&(Ht=r.height-Ct-Pt),m+Dt>Ht&&(Ht=m+Dt)),(C=this.createFigure("rect",{x:bt,y:Ht,width:Lt,height:Pt},{style:f.PolygonType.StrokeFill,color:Jo,borderColor:Qo,borderSize:ht,borderRadius:pe}))===null||C===void 0||C.draw(e);var tn=bt+ht+Q+L,Xt=Ht+ht+ut;if(p&&M.forEach(function(Et){var dt,pt,ft=Et.title;(dt=T.createFigure("text",{x:tn,y:Xt+=H,text:ft.text},{color:ft.color,size:tt,family:ct,weight:at}))===null||dt===void 0||dt.draw(e);var Bt=Et.value;(pt=T.createFigure("text",{x:bt+Lt-ht-O-st,y:Xt,text:Bt.text,align:"right"},{color:Bt.color,size:tt,family:ct,weight:at}))===null||pt===void 0||pt.draw(e),Xt+=tt+Y}),v){var en=bt+ht+Q+Pi;Fi.forEach(function(Et){Et.forEach(function(dt){var pt,ft,Bt=dt.title,ve=dt.value;(pt=T.createFigure("text",{x:en,y:Xt+=ki,text:Bt.text},{color:Bt.color,size:ee,family:Re,weight:Le}))===null||pt===void 0||pt.draw(e),(ft=T.createFigure("text",{x:bt+Lt-ht-Mi-st,y:Xt,text:ve.text,align:"right"},{color:ve.color,size:ee,family:Re,weight:Le}))===null||ft===void 0||ft.draw(e),Xt+=ee+Ai})})}}}},t.prototype._getCandleTooltipData=function(e,o,i,r,a,s,l){var c,u,h,d,p,v=l.tooltip,g=v.text.color,m=e.current,y=(u=(c=e.prev)===null||c===void 0?void 0:c.close)!==null&&u!==void 0?u:m.close,_=m.close-y,x=o.price,S=o.volume,C={"{time}":a.formatDate(i,m.timestamp,"YYYY-MM-DD HH:mm",f.FormatDateType.Tooltip),"{open}":J(U(m.open,x),s),"{high}":J(U(m.high,x),s),"{low}":J(U(m.low,x),s),"{close}":J(U(m.close,x),s),"{volume}":J(a.formatBigNumber(U((h=m.volume)!==null&&h!==void 0?h:v.defaultValue,S)),s),"{change}":y===0?v.defaultValue:"".concat(U(_/y*100),"%")};return((p=K(v.custom)?(d=v.custom)===null||d===void 0?void 0:d.call(v,e,l):v.custom)!==null&&p!==void 0?p:[{title:"time",value:"{time}"},{title:"open",value:"{open}"},{title:"high",value:"{high}"},{title:"low",value:"{low}"},{title:"close",value:"{close}"},{title:"volume",value:"{volume}"}]).map(function(T){var b,w=T.title,E=T.value,D={text:"",color:""};N(w)?D=P({},w):(D.text=w,D.color=g),D.text=function(L,O){var H,Y;return(Y=(H=he[O])===null||H===void 0?void 0:H[L])!==null&&Y!==void 0?Y:L}(D.text,r);var I={text:v.defaultValue,color:""};N(E)?I=P({},E):(I.text=E,I.color=g);var M=I.text.match(/{(\S*)}/);if(M!==null&&M.length>1){var F="{".concat(M[1],"}");I.text=I.text.replace(F,(b=C[F])!==null&&b!==void 0?b:v.defaultValue),F==="{change}"&&(I.color=_===0?l.priceMark.last.noChangeColor:_>0?l.priceMark.last.upColor:l.priceMark.last.downColor)}return{title:D,value:I}})},t}(_i),Ro=function(n){function t(e,o){var i=n.call(this,e,o)||this;return i._candleBarView=new yi(i),i._candleAreaView=new ko(i),i._candleHighLowPriceView=new Ao(i),i._candleLastPriceLineView=new Fo(i),i.addChild(i._candleBarView),i}return B(t,n),t.prototype.updateMainContent=function(e){this.getPane().getChart().getStyles().candle.type!==f.CandleType.Area?(this._candleBarView.draw(e),this._candleHighLowPriceView.draw(e)):this._candleAreaView.draw(e),this._candleLastPriceLineView.draw(e)},t.prototype.createTooltipView=function(){return new Lo(this)},t}(Si),Ci=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return B(t,n),t.prototype.drawImp=function(e){var o,i=this,r=this.getWidget(),a=r.getPane(),s=r.getBounding(),l=a.getAxisComponent(),c=this.getAxisStyles(a.getChart().getStyles());if(c.show){c.axisLine.show&&((o=this.createFigure("line",this.createAxisLine(s,c),c.axisLine))===null||o===void 0||o.draw(e));var u=l.getTicks();c.tickLine.show&&this.createTickLines(u,s,c).forEach(function(h){var d;(d=i.createFigure("line",h,c.tickLine))===null||d===void 0||d.draw(e)}),c.tickText.show&&this.createTickTexts(u,s,c).forEach(function(h){var d;(d=i.createFigure("text",h,c.tickText))===null||d===void 0||d.draw(e)})}},t}(St),Bo=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return B(t,n),t.prototype.getAxisStyles=function(e){return e.yAxis},t.prototype.createAxisLine=function(e,o){var i,r=this.getWidget().getPane().getAxisComponent(),a=o.axisLine.size;return{coordinates:[{x:i=r.isFromZero()?a/2:e.width-a,y:0},{x:i,y:e.height}]}},t.prototype.createTickLines=function(e,o,i){var r=this.getWidget().getPane().getAxisComponent(),a=i.axisLine,s=i.tickLine,l=0,c=0;return r.isFromZero()?(l=0,a.show&&(l+=a.size),c=l+s.length):(l=o.width,a.show&&(l-=a.size),c=l-s.length),e.map(function(u){return{coordinates:[{x:l,y:u.coord},{x:c,y:u.coord}]}})},t.prototype.createTickTexts=function(e,o,i){var r=this.getWidget().getPane().getAxisComponent(),a=i.axisLine,s=i.tickLine,l=i.tickText,c=0;r.isFromZero()?(c=l.marginStart,a.show&&(c+=a.size),s.show&&(c+=s.length)):(c=o.width-l.marginEnd,a.show&&(c-=a.size),s.show&&(c-=s.length));var u=this.getWidget().getPane().getAxisComponent().isFromZero()?"left":"right";return e.map(function(h){return{x:c,y:h.coord,text:h.text,align:u,baseline:"middle"}})},t}(Ci),Oo=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return B(t,n),t.prototype.drawImp=function(e){var o,i=this.getWidget(),r=i.getPane(),a=i.getBounding(),s=r.getChart().getChartStore(),l=s.getStyles().candle.priceMark,c=l.last,u=c.text;if(l.show&&c.show&&u.show){var h=s.getPrecision(),d=r.getAxisComponent(),p=s.getDataList(),v=s.getVisibleDataList(),g=p[p.length-1];if(g!==void 0){var m=g.close,y=g.open,_=d.convertToNicePixel(m),x=void 0;x=m>y?c.upColor:y>m?c.downColor:c.noChangeColor;var S=void 0;if(d.getType()===f.YAxisType.Percentage){var C=v[0].data.close;S="".concat(((m-C)/C*100).toFixed(2),"%")}else S=U(m,h.price);S=J(S,s.getThousandsSeparator());var T=void 0,b=void 0;d.isFromZero()?(T=0,b="left"):(T=a.width,b="right"),(o=this.createFigure("text",{x:T,y:_,text:S,align:b,baseline:"middle"},P(P({},u),{backgroundColor:x})))===null||o===void 0||o.draw(e)}}},t}(St),Vo=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return B(t,n),t.prototype.drawImp=function(e){var o=this,i=this.getWidget(),r=i.getPane(),a=i.getBounding(),s=r.getChart().getChartStore(),l=s.getCustomApi(),c=s.getStyles().indicator,u=c.lastValueMark,h=u.text;if(u.show){var d=r.getAxisComponent(),p=s.getDataList(),v=p.length-1,g=s.getIndicatorStore().getInstances(r.getId()),m=s.getThousandsSeparator();g.forEach(function(y){var _=y.result[v];if(_!==void 0&&y.visible){var x=y.precision;be(p,y,v,c,function(S,C){var T,b=_[S.key];if(R(b)){var w=d.convertToNicePixel(b),E=U(b,x);y.shouldFormatBigNumber&&(E=l.formatBigNumber(E)),E=J(E,m);var D=void 0,I=void 0;d.isFromZero()?(D=0,I="left"):(D=a.width,I="right"),(T=o.createFigure("text",{x:D,y:w,text:E,align:I,baseline:"middle"},P(P({},h),{backgroundColor:C.color})))===null||T===void 0||T.draw(e)}})}})}},t}(St),bi=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return B(t,n),t.prototype.coordinateToPointTimestampDataIndexFlag=function(){return!1},t.prototype.drawDefaultFigures=function(e,o,i,r,a,s,l,c,u,h,d,p,v){this.drawFigures(e,o,this.getDefaultFigures(o,i,r,a,s,l,c,h,d,v),u)},t.prototype.getDefaultFigures=function(e,o,i,r,a,s,l,c,u,h){var d,p,v=[];if(e.needDefaultYAxisFigure&&e.id===((d=h.instance)===null||d===void 0?void 0:d.id)&&h.paneId===this.getWidget().getPane().getId()){var g,m,y=Number.MAX_SAFE_INTEGER,_=Number.MIN_SAFE_INTEGER;(p=u==null?void 0:u.isFromZero())!==null&&p!==void 0&&p?(g="left",m=0):(g="right",m=i.width),o.forEach(function(x,S){var C=e.points[S];if(C.value!==void 0){y=Math.min(y,x.y),_=Math.max(_,x.y);var T=J(U(C.value,r.price),l);v.push({type:"text",attrs:{x:m,y:x.y,text:T,align:g,baseline:"middle"},ignoreEvent:!0})}}),o.length>1&&v.unshift({type:"rect",attrs:{x:0,y,width:i.width,height:_-y},ignoreEvent:!0})}return v},t.prototype.getFigures=function(e,o,i,r,a,s,l,c,u,h){var d,p;return(p=(d=e.createYAxisFigures)===null||d===void 0?void 0:d.call(e,{overlay:e,coordinates:o,bounding:i,barSpace:r,precision:a,thousandsSeparator:s,dateTimeFormat:l,defaultStyles:c,xAxis:u,yAxis:h}))!==null&&p!==void 0?p:[]},t}(xi),Ti=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return B(t,n),t.prototype.drawImp=function(e){var o,i=this.getWidget(),r=i.getPane(),a=i.getBounding(),s=i.getPane().getChart().getChartStore(),l=s.getTooltipStore().getCrosshair(),c=s.getStyles().crosshair;if(l.paneId!==void 0&&this.compare(l,r.getId())&&c.show){var u=this.getDirectionStyles(c),h=u.text;if(u.show&&h.show){var d=r.getAxisComponent(),p=this.getText(l,s,d);e.font=At(h.size,h.weight,h.family),(o=this.createFigure("text",this.getTextAttrs(p,e.measureText(p).width,l,a,d,h),h))===null||o===void 0||o.draw(e)}}},t.prototype.compare=function(e,o){return e.paneId===o},t.prototype.getDirectionStyles=function(e){return e.horizontal},t.prototype.getText=function(e,o,i){var r,a,s,l=i,c=i.convertFromPixel(e.y);if(l.getType()===f.YAxisType.Percentage){var u=(a=(r=o.getVisibleDataList()[0])===null||r===void 0?void 0:r.data)!==null&&a!==void 0?a:{};s="".concat(((c-u.close)/u.close*100).toFixed(2),"%")}else{var h=o.getIndicatorStore().getInstances(e.paneId),d=0,p=!1;l.isInCandle()?d=o.getPrecision().price:h.forEach(function(v){d=Math.max(v.precision,d),p||(p=v.shouldFormatBigNumber)}),s=U(c,d),p&&(s=o.getCustomApi().formatBigNumber(s))}return J(s,o.getThousandsSeparator())},t.prototype.getTextAttrs=function(e,o,i,r,a,s){var l,c;return a.isFromZero()?(l=0,c="left"):(l=r.width,c="right"),{x:l,y:i.y,text:e,align:c,baseline:"middle"}},t}(St),Wo=function(n){function t(e,o){var i=n.call(this,e,o)||this;return i._yAxisView=new Bo(i),i._candleLastPriceLabelView=new Oo(i),i._indicatorLastValueView=new Vo(i),i._overlayYAxisView=new bi(i),i._crosshairHorizontalLabelView=new Ti(i),i.getContainer().style.cursor="ns-resize",i.addChild(i._overlayYAxisView),i}return B(t,n),t.prototype.getName=function(){return xt},t.prototype.updateMain=function(e){this._yAxisView.draw(e),this.getPane().getAxisComponent().isInCandle()&&this._candleLastPriceLabelView.draw(e),this._indicatorLastValueView.draw(e)},t.prototype.updateOverlay=function(e){this._overlayYAxisView.draw(e),this._crosshairHorizontalLabelView.draw(e)},t}(De),wi=function(){function n(t){this._extremum={min:0,max:0,range:0,realMin:0,realMax:0,realRange:0},this._prevExtremum={min:0,max:0,range:0,realMin:0,realMax:0,realRange:0},this._ticks=[],this._autoCalcTickFlag=!0,this._parent=t}return n.prototype.getParent=function(){return this._parent},n.prototype.buildTicks=function(t){return this._autoCalcTickFlag&&(this._extremum=this.calcExtremum()),!(this._prevExtremum.min===this._extremum.min&&this._prevExtremum.max===this._extremum.max&&!t)&&(this._prevExtremum=this._extremum,this._ticks=this.optimalTicks(this._calcTicks()),!0)},n.prototype.getTicks=function(){return this._ticks},n.prototype.getScrollZoomEnabled=function(){var t;return(t=this.getParent().getOptions().axisOptions.scrollZoomEnabled)===null||t===void 0||t},n.prototype.setExtremum=function(t){this._autoCalcTickFlag=!1,this._extremum=t},n.prototype.getExtremum=function(){return this._extremum},n.prototype.setAutoCalcTickFlag=function(t){this._autoCalcTickFlag=t},n.prototype.getAutoCalcTickFlag=function(){return this._autoCalcTickFlag},n.prototype._calcTicks=function(){var t=this._extremum,e=t.realMin,o=t.realMax,i=t.realRange,r=[];if(i>=0){var a=it(this._calcTickInterval(i),2),s=a[0],l=a[1],c=Ze(Math.ceil(e/s)*s,l),u=Ze(Math.floor(o/s)*s,l),h=0,d=c;if(s!==0)for(;u>=d;){var p=d.toFixed(l);r[h]={text:p,coord:0,value:p},++h,d+=s}}return r},n.prototype._calcTickInterval=function(t){var e,o,i,r,a=(o=Math.floor($t(e=t/8)),i=Ft(o),e=(1.5>(r=e/i)?1:2.5>r?2:3.5>r?3:4.5>r?4:5.5>r?5:6.5>r?6:8)*i,-20>o?e:+e.toFixed(0>o?-o:0)),s=function(l){var c=""+l,u=c.indexOf("e");if(u>0){var h=+c.slice(u+1);return 0>h?-h:0}var d=c.indexOf(".");return 0>d?0:c.length-1-d}(a);return[a,s]},n}(),No=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return B(t,n),t.prototype.calcExtremum=function(){var e,o,i,r,a,s=this.getParent(),l=s.getChart(),c=l.getChartStore(),u=Number.MAX_SAFE_INTEGER,h=Number.MIN_SAFE_INTEGER,d=[],p=!1,v=Number.MAX_SAFE_INTEGER,g=Number.MIN_SAFE_INTEGER,m=Number.MAX_SAFE_INTEGER;c.getIndicatorStore().getInstances(s.getId()).forEach(function(z){var Q,st,ut;p||(p=(Q=z.shouldOhlc)!==null&&Q!==void 0&&Q),m=Math.min(m,z.precision),z.minValue!==null&&(v=Math.min(v,z.minValue)),z.maxValue!==null&&(g=Math.max(g,z.maxValue)),d.push({figures:(st=z.figures)!==null&&st!==void 0?st:[],result:(ut=z.result)!==null&&ut!==void 0?ut:[]})});var y=4,_=this.isInCandle();if(_){var x=c.getPrecision().price;y=m!==Number.MAX_SAFE_INTEGER?Math.min(m,x):x}else m!==Number.MAX_SAFE_INTEGER&&(y=m);var S=c.getVisibleDataList(),C=l.getStyles().candle,T=C.type===f.CandleType.Area,b=C.area.value,w=_&&!T||!_&&p;S.forEach(function(z){var Q=z.dataIndex,st=z.data;if(w&&(u=Math.min(u,st.low),h=Math.max(h,st.high)),_&&T){var ut=st[b];u=Math.min(u,ut),h=Math.max(h,ut)}d.forEach(function(It){var vt,gt=(vt=It.result[Q])!==null&&vt!==void 0?vt:{};It.figures.forEach(function(Dt){var Ct=gt[Dt.key];R(Ct)&&(u=Math.min(u,Ct),h=Math.max(h,Ct))})})}),u!==Number.MAX_SAFE_INTEGER&&h!==Number.MIN_SAFE_INTEGER?(u=Math.min(v,u),h=Math.max(g,h)):(u=0,h=10);var E,D=this.getType();switch(D){case f.YAxisType.Percentage:var I=(e=S[0])===null||e===void 0?void 0:e.data;(I==null?void 0:I.close)!==void 0&&(u=(u-I.close)/I.close*100,h=(h-I.close)/I.close*100),E=.01;break;case f.YAxisType.Log:u=$t(u),h=$t(h),E=.05*Ft(-y);break;default:E=Ft(-y)}if(u===h||E>Math.abs(u-h)){var M=v===u,F=g===h;u=M?u:F?u-8*E:u-4*E,h=F?h:M?h+8*E:h+4*E}var L=(i=(o=this.getParent().getYAxisWidget())===null||o===void 0?void 0:o.getBounding().height)!==null&&i!==void 0?i:0,O=s.getOptions().gap,H=(r=O==null?void 0:O.top)!==null&&r!==void 0?r:.2;1>H||(H/=L);var Y=(a=O==null?void 0:O.bottom)!==null&&a!==void 0?a:.1;1>Y||(Y/=L);var tt,at,ct,X=Math.abs(h-u);return X=Math.abs((h+=X*H)-(u-=X*Y)),D===f.YAxisType.Log?(tt=Ft(u),at=Ft(h),ct=Math.abs(at-tt)):(tt=u,at=h,ct=X),{min:u,max:h,range:X,realMin:tt,realMax:at,realRange:ct}},t.prototype._innerConvertToPixel=function(e){var o,i,r=(i=(o=this.getParent().getYAxisWidget())===null||o===void 0?void 0:o.getBounding().height)!==null&&i!==void 0?i:0,a=this.getExtremum(),s=(e-a.min)/a.range;return this.isReverse()?Math.round(s*r):Math.round((1-s)*r)},t.prototype.isInCandle=function(){return this.getParent().getName()==="candle"},t.prototype.getType=function(){return this.isInCandle()?this.getParent().getChart().getStyles().yAxis.type:f.YAxisType.Normal},t.prototype.getPosition=function(){return this.getParent().getChart().getStyles().yAxis.position},t.prototype.isReverse=function(){return!!this.isInCandle()&&this.getParent().getChart().getStyles().yAxis.reverse},t.prototype.isFromZero=function(){var e=this.getParent().getChart().getStyles().yAxis,o=e.inside;return e.position===f.YAxisPosition.Left&&o||e.position===f.YAxisPosition.Right&&!o},t.prototype.optimalTicks=function(e){var o,i,r=this,a=this.getParent(),s=(i=(o=a.getYAxisWidget())===null||o===void 0?void 0:o.getBounding().height)!==null&&i!==void 0?i:0,l=a.getChart().getChartStore(),c=l.getCustomApi(),u=[],h=this.getType(),d=l.getIndicatorStore().getInstances(a.getId()),p=l.getThousandsSeparator(),v=0,g=!1;this.isInCandle()?v=l.getPrecision().price:d.forEach(function(_){v=Math.max(v,_.precision),g||(g=_.shouldFormatBigNumber)});var m,y=l.getStyles().xAxis.tickText.size;return e.forEach(function(_){var x,S=_.value,C=r._innerConvertToPixel(+S);switch(h){case f.YAxisType.Percentage:x="".concat(U(S,2),"%");break;case f.YAxisType.Log:C=r._innerConvertToPixel($t(+S)),x=U(S,v);break;default:x=U(S,v),g&&(x=c.formatBigNumber(S))}x=J(x,p),C>y&&s-y>C&&(m!==void 0&&Math.abs(m-C)>2*y||m===void 0)&&(u.push({text:x,coord:C,value:S}),m=C)}),u},t.prototype.getAutoSize=function(){var e=this.getParent(),o=e.getChart(),i=o.getStyles(),r=i.yAxis,a=r.size;if(a!=="auto")return a;var s=o.getChartStore(),l=s.getCustomApi(),c=0;if(r.show&&(r.axisLine.show&&(c+=r.axisLine.size),r.tickLine.show&&(c+=r.tickLine.length),r.tickText.show)){var u=0;this.getTicks().forEach(function(S){u=Math.max(u,Gt(S.text,r.tickText.size,r.tickText.weight,r.tickText.family))}),c+=r.tickText.marginStart+r.tickText.marginEnd+u}var h=i.crosshair,d=0;if(h.show&&h.horizontal.show&&h.horizontal.text.show){var p=s.getIndicatorStore().getInstances(e.getId()),v=0,g=!1;p.forEach(function(S){v=Math.max(S.precision,v),g||(g=S.shouldFormatBigNumber)});var m=2;if(this.getType()!==f.YAxisType.Percentage)if(this.isInCandle()){var y=s.getPrecision().price,_=i.indicator.lastValueMark;m=_.show&&_.text.show?Math.max(v,y):y}else m=v;var x=U(this.getExtremum().max,m);g&&(x=l.formatBigNumber(x)),d+=h.horizontal.text.paddingLeft+h.horizontal.text.paddingRight+2*h.horizontal.text.borderSize+Gt(x,h.horizontal.text.size,h.horizontal.text.weight,h.horizontal.text.family)}return Math.max(c,d)},t.prototype.convertFromPixel=function(e){var o,i,r,a=(i=(o=this.getParent().getYAxisWidget())===null||o===void 0?void 0:o.getBounding().height)!==null&&i!==void 0?i:0,s=this.getExtremum(),l=s.min,c=s.range,u=(this.isReverse()?e/a:1-e/a)*c+l;switch(this.getType()){case f.YAxisType.Percentage:var h=(r=this.getParent().getChart().getChartStore().getVisibleDataList()[0])===null||r===void 0?void 0:r.data;return(h==null?void 0:h.close)!==void 0?h.close*u/100+h.close:0;case f.YAxisType.Log:return Ft(u);default:return u}},t.prototype.convertToRealValue=function(e){var o=e;return this.getType()===f.YAxisType.Log&&(o=Ft(e)),o},t.prototype.convertToPixel=function(e){var o,i=e;switch(this.getType()){case f.YAxisType.Percentage:var r=(o=this.getParent().getChart().getChartStore().getVisibleDataList()[0])===null||o===void 0?void 0:o.data;(r==null?void 0:r.close)!==void 0&&(i=(e-r.close)/r.close*100);break;case f.YAxisType.Log:i=$t(e);break;default:i=e}return this._innerConvertToPixel(i)},t.prototype.convertToNicePixel=function(e){var o,i,r=(i=(o=this.getParent().getYAxisWidget())===null||o===void 0?void 0:o.getBounding().height)!==null&&i!==void 0?i:0,a=this.convertToPixel(e);return Math.round(Math.max(.05*r,Math.min(a,.98*r)))},t}(wi),Ei=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return B(t,n),t.prototype.getName=function(){return"indicator"},t.prototype.createAxisComponent=function(){return new No(this)},t.prototype.createMainWidget=function(e){return new Si(e,this)},t.prototype.createSeparatorWidget=function(e){return new yo(e,this)},t.prototype.createYAxisWidget=function(e){return new Wo(e,this)},t}(ni),zo=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return B(t,n),t.prototype.getName=function(){return"candle"},t.prototype.createMainWidget=function(e){return new Ro(e,this)},t.prototype.createSeparatorWidget=function(){return null},t}(Ei),Yo=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return B(t,n),t.prototype.getAxisStyles=function(e){return e.xAxis},t.prototype.createAxisLine=function(e,o){var i=o.axisLine.size/2;return{coordinates:[{x:0,y:i},{x:e.width,y:i}]}},t.prototype.createTickLines=function(e,o,i){var r=i.tickLine,a=i.axisLine.size;return e.map(function(s){return{coordinates:[{x:s.coord,y:0},{x:s.coord,y:a+r.length}]}})},t.prototype.createTickTexts=function(e,o,i){var r=i.tickText,a=i.axisLine.size,s=i.tickLine.length;return e.map(function(l){return{x:l.coord,y:a+s+r.marginStart,text:l.text,align:"center",baseline:"top"}})},t}(Ci),Ho=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return B(t,n),t.prototype.coordinateToPointTimestampDataIndexFlag=function(){return!0},t.prototype.coordinateToPointValueFlag=function(){return!1},t.prototype.getCompleteOverlays=function(e){return e.getInstances()},t.prototype.getProgressOverlay=function(e){return e.instance},t.prototype.getDefaultFigures=function(e,o,i,r,a,s,l,c,u,h){var d,p=[];if(e.needDefaultXAxisFigure&&e.id===((d=h.instance)===null||d===void 0?void 0:d.id)){var v=Number.MAX_SAFE_INTEGER,g=Number.MIN_SAFE_INTEGER;o.forEach(function(m,y){v=Math.min(v,m.x),g=Math.max(g,m.x);var _=e.points[y];if(_.timestamp!==void 0){var x=s.formatDate(a,_.timestamp,"YYYY-MM-DD HH:mm",f.FormatDateType.Crosshair);p.push({type:"text",attrs:{x:m.x,y:0,text:x,align:"center"},ignoreEvent:!0})}}),o.length>1&&p.unshift({type:"rect",attrs:{x:v,y:0,width:g-v,height:i.height},ignoreEvent:!0})}return p},t.prototype.getFigures=function(e,o,i,r,a,s,l,c,u,h){var d,p;return(p=(d=e.createXAxisFigures)===null||d===void 0?void 0:d.call(e,{overlay:e,coordinates:o,bounding:i,barSpace:r,precision:a,thousandsSeparator:s,dateTimeFormat:l,defaultStyles:c,xAxis:u,yAxis:h}))!==null&&p!==void 0?p:[]},t}(bi),Xo=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return B(t,n),t.prototype.compare=function(e){return e.kLineData!==void 0&&e.dataIndex===e.realDataIndex},t.prototype.getDirectionStyles=function(e){return e.vertical},t.prototype.getText=function(e,o){var i,r=(i=e.kLineData)===null||i===void 0?void 0:i.timestamp;return o.getCustomApi().formatDate(o.getTimeScaleStore().getDateTimeFormat(),r,"YYYY-MM-DD HH:mm",f.FormatDateType.Crosshair)},t.prototype.getTextAttrs=function(e,o,i,r,a,s){var l,c=i.realX,u="center";return 0>c-o/2-s.paddingLeft?(l=0,u="left"):c+o/2+s.paddingRight>r.width?(l=r.width,u="right"):l=c,{x:l,y:0,text:e,align:u,baseline:"top"}},t}(Ti),jo=function(n){function t(e,o){var i=n.call(this,e,o)||this;return i._xAxisView=new Yo(i),i._overlayXAxisView=new Ho(i),i._crosshairVerticalLabelView=new Xo(i),i.getContainer().style.cursor="ew-resize",i.addChild(i._overlayXAxisView),i}return B(t,n),t.prototype.getName=function(){return _t},t.prototype.updateMain=function(e){this._xAxisView.draw(e)},t.prototype.updateOverlay=function(e){this._overlayXAxisView.draw(e),this._crosshairVerticalLabelView.draw(e)},t}(De),Zo=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return B(t,n),t.prototype.calcExtremum=function(){var e=this.getParent().getChart().getChartStore().getTimeScaleStore().getVisibleRange(),o=e.from,i=e.to,r=i-1,a=i-o;return{min:o,max:r,range:a,realMin:o,realMax:r,realRange:a}},t.prototype.optimalTicks=function(e){var o,i,r=this.getParent().getChart(),a=r.getChartStore(),s=a.getCustomApi().formatDate,l=[],c=e.length,u=a.getDataList();if(c>0){var h=a.getTimeScaleStore().getDateTimeFormat(),d=r.getStyles().xAxis.tickText,p=Gt("00-00 00:00",d.size,d.weight,d.family),v=this.convertToPixel(parseInt(e[0].value,10)),g=1;if(c>1){var m=this.convertToPixel(parseInt(e[1].value,10)),y=Math.abs(m-v);p>y&&(g=Math.ceil(p/y))}for(var _=0;c>_;_+=g){var x=parseInt(e[_].value,10),S=u[x].timestamp,C=s(h,S,"HH:mm",f.FormatDateType.XAxis);_!==0&&(C=(o=this._optimalTickLabel(s,h,S,u[parseInt(e[_-g].value,10)].timestamp))!==null&&o!==void 0?o:C);var T=this.convertToPixel(x);l.push({text:C,coord:T,value:S})}if(l.length===1)l[0].text=s(h,l[0].value,"YYYY-MM-DD HH:mm",f.FormatDateType.XAxis);else{var b=l[0].value,w=l[1].value;if(l[2]!==void 0){var E=l[2].text;/^[0-9]{2}-[0-9]{2}$/.test(E)?l[0].text=s(h,b,"MM-DD",f.FormatDateType.XAxis):/^[0-9]{4}-[0-9]{2}$/.test(E)?l[0].text=s(h,b,"YYYY-MM",f.FormatDateType.XAxis):/^[0-9]{4}$/.test(E)&&(l[0].text=s(h,b,"YYYY",f.FormatDateType.XAxis))}else l[0].text=(i=this._optimalTickLabel(s,h,b,w))!==null&&i!==void 0?i:l[0].text}}return l},t.prototype._optimalTickLabel=function(e,o,i,r){var a=e(o,i,"YYYY",f.FormatDateType.XAxis),s=e(o,i,"YYYY-MM",f.FormatDateType.XAxis),l=e(o,i,"MM-DD",f.FormatDateType.XAxis);return a!==e(o,r,"YYYY",f.FormatDateType.XAxis)?a:s!==e(o,r,"YYYY-MM",f.FormatDateType.XAxis)?s:l!==e(o,r,"MM-DD",f.FormatDateType.XAxis)?l:null},t.prototype.getAutoSize=function(){var e=this.getParent().getChart().getStyles(),o=e.xAxis,i=o.size;if(i!=="auto")return i;var r=e.crosshair,a=0;o.show&&(o.axisLine.show&&(a+=o.axisLine.size),o.tickLine.show&&(a+=o.tickLine.length),o.tickText.show&&(a+=o.tickText.marginStart+o.tickText.marginEnd+o.tickText.size));var s=0;return r.show&&r.vertical.show&&r.vertical.text.show&&(s+=r.vertical.text.paddingTop+r.vertical.text.paddingBottom+2*r.vertical.text.borderSize+r.vertical.text.size),Math.max(a,s)},t.prototype.convertTimestampFromPixel=function(e){var o=this.getParent().getChart().getChartStore().getTimeScaleStore(),i=o.coordinateToDataIndex(e);return o.dataIndexToTimestamp(i)},t.prototype.convertTimestampToPixel=function(e){var o=this.getParent().getChart().getChartStore().getTimeScaleStore(),i=o.timestampToDataIndex(e);return o.dataIndexToCoordinate(i)},t.prototype.convertFromPixel=function(e){return this.getParent().getChart().getChartStore().getTimeScaleStore().coordinateToDataIndex(e)},t.prototype.convertToPixel=function(e){return this.getParent().getChart().getChartStore().getTimeScaleStore().dataIndexToCoordinate(e)},t}(wi),qo=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return B(t,n),t.prototype.getName=function(){return"xAxis"},t.prototype.createAxisComponent=function(){return new Zo(this)},t.prototype.createMainWidget=function(e){return new jo(e,this)},t}(ni);function Ii(){var n;return typeof window!="undefined"&&((n=window.navigator.userAgent.toLowerCase().indexOf("firefox"))!==null&&n!==void 0?n:-1)>-1}function Ae(){return typeof window!="undefined"&&/iPhone|iPad|iPod/.test(window.navigator.platform)}var Fe,Go=function(){function n(t,e,o){var i=this;this._clickCount=0,this._clickTimeoutId=null,this._clickCoordinate={x:-1/0,y:1/0},this._tapCount=0,this._tapTimeoutId=null,this._tapCoordinate={x:-1/0,y:1/0},this._longTapTimeoutId=null,this._longTapActive=!1,this._mouseMoveStartCoordinate=null,this._touchMoveStartCoordinate=null,this._touchMoveExceededManhattanDistance=!1,this._cancelClick=!1,this._cancelTap=!1,this._unsubscribeOutsideMouseEvents=null,this._unsubscribeOutsideTouchEvents=null,this._unsubscribeMobileSafariEvents=null,this._unsubscribeMousemove=null,this._unsubscribeMouseWheel=null,this._unsubscribeContextMenu=null,this._unsubscribeRootMouseEvents=null,this._unsubscribeRootTouchEvents=null,this._startPinchMiddleCoordinate=null,this._startPinchDistance=0,this._pinchPrevented=!1,this._preventTouchDragProcess=!1,this._mousePressed=!1,this._lastTouchEventTimeStamp=0,this._activeTouchId=null,this._acceptMouseLeave=!Ae(),this._onFirefoxOutsideMouseUp=function(r){i._mouseUpHandler(r)},this._onMobileSafariDoubleClick=function(r){i._firesTouchEvents(r)?(++i._tapCount,i._tapTimeoutId!==null&&i._tapCount>1&&(30>i._mouseTouchMoveWithDownInfo(i._getCoordinate(r),i._tapCoordinate).manhattanDistance&&!i._cancelTap&&i._processEvent(i._makeCompatEvent(r),i._handler.doubleTapEvent),i._resetTapTimeout())):(++i._clickCount,i._clickTimeoutId!==null&&i._clickCount>1&&(5>i._mouseTouchMoveWithDownInfo(i._getCoordinate(r),i._clickCoordinate).manhattanDistance&&!i._cancelClick&&i._processEvent(i._makeCompatEvent(r),i._handler.mouseDoubleClickEvent),i._resetClickTimeout()))},this._target=t,this._handler=e,this._options=o,this._init()}return n.prototype.destroy=function(){this._unsubscribeOutsideMouseEvents!==null&&(this._unsubscribeOutsideMouseEvents(),this._unsubscribeOutsideMouseEvents=null),this._unsubscribeOutsideTouchEvents!==null&&(this._unsubscribeOutsideTouchEvents(),this._unsubscribeOutsideTouchEvents=null),this._unsubscribeMousemove!==null&&(this._unsubscribeMousemove(),this._unsubscribeMousemove=null),this._unsubscribeMouseWheel!==null&&(this._unsubscribeMouseWheel(),this._unsubscribeMouseWheel=null),this._unsubscribeContextMenu!==null&&(this._unsubscribeContextMenu(),this._unsubscribeContextMenu=null),this._unsubscribeRootMouseEvents!==null&&(this._unsubscribeRootMouseEvents(),this._unsubscribeRootMouseEvents=null),this._unsubscribeRootTouchEvents!==null&&(this._unsubscribeRootTouchEvents(),this._unsubscribeRootTouchEvents=null),this._unsubscribeMobileSafariEvents!==null&&(this._unsubscribeMobileSafariEvents(),this._unsubscribeMobileSafariEvents=null),this._clearLongTapTimeout(),this._resetClickTimeout()},n.prototype._mouseEnterHandler=function(t){var e,o,i,r=this;(e=this._unsubscribeMousemove)===null||e===void 0||e.call(this),(o=this._unsubscribeMouseWheel)===null||o===void 0||o.call(this),(i=this._unsubscribeContextMenu)===null||i===void 0||i.call(this);var a=this._mouseMoveHandler.bind(this);this._unsubscribeMousemove=function(){r._target.removeEventListener("mousemove",a)},this._target.addEventListener("mousemove",a);var s=this._mouseWheelHandler.bind(this);this._unsubscribeMouseWheel=function(){r._target.removeEventListener("wheel",s)},this._target.addEventListener("wheel",s,{passive:!1});var l=this._contextMenuHandler.bind(this);this._unsubscribeContextMenu=function(){r._target.removeEventListener("contextmenu",l)},this._target.addEventListener("contextmenu",l,{passive:!1}),this._firesTouchEvents(t)||(this._processEvent(this._makeCompatEvent(t),this._handler.mouseEnterEvent),this._acceptMouseLeave=!0)},n.prototype._resetClickTimeout=function(){this._clickTimeoutId!==null&&clearTimeout(this._clickTimeoutId),this._clickCount=0,this._clickTimeoutId=null,this._clickCoordinate={x:-1/0,y:1/0}},n.prototype._resetTapTimeout=function(){this._tapTimeoutId!==null&&clearTimeout(this._tapTimeoutId),this._tapCount=0,this._tapTimeoutId=null,this._tapCoordinate={x:-1/0,y:1/0}},n.prototype._mouseMoveHandler=function(t){this._mousePressed||this._touchMoveStartCoordinate!==null||this._firesTouchEvents(t)||(this._processEvent(this._makeCompatEvent(t),this._handler.mouseMoveEvent),this._acceptMouseLeave=!0)},n.prototype._mouseWheelHandler=function(t){if(Math.abs(t.deltaX)>Math.abs(t.deltaY)){if(this._handler.mouseWheelHortEvent===void 0||(this._preventDefault(t),Math.abs(t.deltaX)===0))return;this._handler.mouseWheelHortEvent(this._makeCompatEvent(t),-t.deltaX)}else{if(this._handler.mouseWheelVertEvent===void 0)return;var e=-t.deltaY/100;if(e===0)return;switch(this._preventDefault(t),t.deltaMode){case t.DOM_DELTA_PAGE:e*=120;break;case t.DOM_DELTA_LINE:e*=32}if(e!==0){var o=Math.sign(e)*Math.min(1,Math.abs(e));this._handler.mouseWheelVertEvent(this._makeCompatEvent(t),o)}}},n.prototype._contextMenuHandler=function(t){this._preventDefault(t)},n.prototype._touchMoveHandler=function(t){var e=this._touchWithId(t.changedTouches,this._activeTouchId);if(e!==null&&(this._lastTouchEventTimeStamp=this._eventTimeStamp(t),this._startPinchMiddleCoordinate===null&&!this._preventTouchDragProcess)){this._pinchPrevented=!0;var o=this._mouseTouchMoveWithDownInfo(this._getCoordinate(e),this._touchMoveStartCoordinate),i=o.yOffset;if(this._touchMoveExceededManhattanDistance||o.manhattanDistance>=5){if(!this._touchMoveExceededManhattanDistance){var r=.5*o.xOffset,a=i>=r&&!this._options.treatVertDragAsPageScroll(),s=r>i&&!this._options.treatHorzDragAsPageScroll();a||s||(this._preventTouchDragProcess=!0),this._touchMoveExceededManhattanDistance=!0,this._cancelTap=!0,this._clearLongTapTimeout(),this._resetTapTimeout()}this._preventTouchDragProcess||this._processEvent(this._makeCompatEvent(t,e),this._handler.touchMoveEvent)}}},n.prototype._mouseMoveWithDownHandler=function(t){t.button===0&&(5>this._mouseTouchMoveWithDownInfo(this._getCoordinate(t),this._mouseMoveStartCoordinate).manhattanDistance||(this._cancelClick=!0,this._resetClickTimeout()),this._cancelClick&&this._processEvent(this._makeCompatEvent(t),this._handler.pressedMouseMoveEvent))},n.prototype._mouseTouchMoveWithDownInfo=function(t,e){var o=Math.abs(e.x-t.x),i=Math.abs(e.y-t.y);return{xOffset:o,yOffset:i,manhattanDistance:o+i}},n.prototype._touchEndHandler=function(t){var e=this._touchWithId(t.changedTouches,this._activeTouchId);if(e===null&&t.touches.length===0&&(e=t.changedTouches[0]),e!==null){this._activeTouchId=null,this._lastTouchEventTimeStamp=this._eventTimeStamp(t),this._clearLongTapTimeout(),this._touchMoveStartCoordinate=null,this._unsubscribeRootTouchEvents!==null&&(this._unsubscribeRootTouchEvents(),this._unsubscribeRootTouchEvents=null);var o=this._makeCompatEvent(t,e);this._processEvent(o,this._handler.touchEndEvent),++this._tapCount,this._tapTimeoutId!==null&&this._tapCount>1?(30>this._mouseTouchMoveWithDownInfo(this._getCoordinate(e),this._tapCoordinate).manhattanDistance&&!this._cancelTap&&this._processEvent(o,this._handler.doubleTapEvent),this._resetTapTimeout()):this._cancelTap||(this._processEvent(o,this._handler.tapEvent),this._handler.tapEvent!==void 0&&this._preventDefault(t)),this._tapCount===0&&this._preventDefault(t),t.touches.length===0&&this._longTapActive&&(this._longTapActive=!1,this._preventDefault(t))}},n.prototype._mouseUpHandler=function(t){if(t.button===0){var e=this._makeCompatEvent(t);this._mouseMoveStartCoordinate=null,this._mousePressed=!1,this._unsubscribeRootMouseEvents!==null&&(this._unsubscribeRootMouseEvents(),this._unsubscribeRootMouseEvents=null),Ii()&&this._target.ownerDocument.documentElement.removeEventListener("mouseleave",this._onFirefoxOutsideMouseUp),this._firesTouchEvents(t)||(this._processEvent(e,this._handler.mouseUpEvent),++this._clickCount,this._clickTimeoutId!==null&&this._clickCount>1?(5>this._mouseTouchMoveWithDownInfo(this._getCoordinate(t),this._clickCoordinate).manhattanDistance&&!this._cancelClick&&this._processEvent(e,this._handler.mouseDoubleClickEvent),this._resetClickTimeout()):this._cancelClick||this._processEvent(e,this._handler.mouseClickEvent))}},n.prototype._clearLongTapTimeout=function(){this._longTapTimeoutId!==null&&(clearTimeout(this._longTapTimeoutId),this._longTapTimeoutId=null)},n.prototype._touchStartHandler=function(t){if(this._activeTouchId===null){var e=t.changedTouches[0];this._activeTouchId=e.identifier,this._lastTouchEventTimeStamp=this._eventTimeStamp(t);var o=this._target.ownerDocument.documentElement;this._cancelTap=!1,this._touchMoveExceededManhattanDistance=!1,this._preventTouchDragProcess=!1,this._touchMoveStartCoordinate=this._getCoordinate(e),this._unsubscribeRootTouchEvents!==null&&(this._unsubscribeRootTouchEvents(),this._unsubscribeRootTouchEvents=null);var i=this._touchMoveHandler.bind(this),r=this._touchEndHandler.bind(this);this._unsubscribeRootTouchEvents=function(){o.removeEventListener("touchmove",i),o.removeEventListener("touchend",r)},o.addEventListener("touchmove",i,{passive:!1}),o.addEventListener("touchend",r,{passive:!1}),this._clearLongTapTimeout(),this._longTapTimeoutId=setTimeout(this._longTapHandler.bind(this,t),500),this._processEvent(this._makeCompatEvent(t,e),this._handler.touchStartEvent),this._tapTimeoutId===null&&(this._tapCount=0,this._tapTimeoutId=setTimeout(this._resetTapTimeout.bind(this),500),this._tapCoordinate=this._getCoordinate(e))}},n.prototype._mouseDownHandler=function(t){if(t.button===2)return this._preventDefault(t),void this._processEvent(this._makeCompatEvent(t),this._handler.mouseRightClickEvent);if(t.button===0){var e=this._target.ownerDocument.documentElement;Ii()&&e.addEventListener("mouseleave",this._onFirefoxOutsideMouseUp),this._cancelClick=!1,this._mouseMoveStartCoordinate=this._getCoordinate(t),this._unsubscribeRootMouseEvents!==null&&(this._unsubscribeRootMouseEvents(),this._unsubscribeRootMouseEvents=null);var o=this._mouseMoveWithDownHandler.bind(this),i=this._mouseUpHandler.bind(this);this._unsubscribeRootMouseEvents=function(){e.removeEventListener("mousemove",o),e.removeEventListener("mouseup",i)},e.addEventListener("mousemove",o),e.addEventListener("mouseup",i),this._mousePressed=!0,this._firesTouchEvents(t)||(this._processEvent(this._makeCompatEvent(t),this._handler.mouseDownEvent),this._clickTimeoutId===null&&(this._clickCount=0,this._clickTimeoutId=setTimeout(this._resetClickTimeout.bind(this),500),this._clickCoordinate=this._getCoordinate(t)))}},n.prototype._init=function(){var t=this;this._target.addEventListener("mouseenter",this._mouseEnterHandler.bind(this)),this._target.addEventListener("touchcancel",this._clearLongTapTimeout.bind(this));var e=this._target.ownerDocument,o=function(i){t._handler.mouseDownOutsideEvent!=null&&(i.composed&&t._target.contains(i.composedPath()[0])||i.target!==null&&t._target.contains(i.target)||t._handler.mouseDownOutsideEvent({x:0,y:0,pageX:0,pageY:0}))};this._unsubscribeOutsideTouchEvents=function(){e.removeEventListener("touchstart",o)},this._unsubscribeOutsideMouseEvents=function(){e.removeEventListener("mousedown",o)},e.addEventListener("mousedown",o),e.addEventListener("touchstart",o,{passive:!0}),Ae()&&(this._unsubscribeMobileSafariEvents=function(){t._target.removeEventListener("dblclick",t._onMobileSafariDoubleClick)},this._target.addEventListener("dblclick",this._onMobileSafariDoubleClick)),this._target.addEventListener("mouseleave",this._mouseLeaveHandler.bind(this)),this._target.addEventListener("touchstart",this._touchStartHandler.bind(this),{passive:!0}),this._target.addEventListener("mousedown",function(i){if(i.button===1)return i.preventDefault(),!1}),this._target.addEventListener("mousedown",this._mouseDownHandler.bind(this)),this._initPinch(),this._target.addEventListener("touchmove",function(){},{passive:!1})},n.prototype._initPinch=function(){var t=this;this._handler.pinchStartEvent===void 0&&this._handler.pinchEvent===void 0&&this._handler.pinchEndEvent===void 0||(this._target.addEventListener("touchstart",function(e){return t._checkPinchState(e.touches)},{passive:!0}),this._target.addEventListener("touchmove",function(e){if(e.touches.length===2&&t._startPinchMiddleCoordinate!==null&&t._handler.pinchEvent!==void 0){var o=t._getTouchDistance(e.touches[0],e.touches[1])/t._startPinchDistance;t._handler.pinchEvent(P(P({},t._startPinchMiddleCoordinate),{pageX:0,pageY:0}),o),t._preventDefault(e)}},{passive:!1}),this._target.addEventListener("touchend",function(e){t._checkPinchState(e.touches)}))},n.prototype._checkPinchState=function(t){t.length===1&&(this._pinchPrevented=!1),t.length!==2||this._pinchPrevented||this._longTapActive?this._stopPinch():this._startPinch(t)},n.prototype._startPinch=function(t){var e,o=(e=this._target.getBoundingClientRect())!==null&&e!==void 0?e:{left:0,top:0};this._startPinchMiddleCoordinate={x:(t[0].clientX-o.left+(t[1].clientX-o.left))/2,y:(t[0].clientY-o.top+(t[1].clientY-o.top))/2},this._startPinchDistance=this._getTouchDistance(t[0],t[1]),this._handler.pinchStartEvent!==void 0&&this._handler.pinchStartEvent({x:0,y:0,pageX:0,pageY:0}),this._clearLongTapTimeout()},n.prototype._stopPinch=function(){this._startPinchMiddleCoordinate!==null&&(this._startPinchMiddleCoordinate=null,this._handler.pinchEndEvent!==void 0&&this._handler.pinchEndEvent({x:0,y:0,pageX:0,pageY:0}))},n.prototype._mouseLeaveHandler=function(t){var e,o,i;(e=this._unsubscribeMousemove)===null||e===void 0||e.call(this),(o=this._unsubscribeMouseWheel)===null||o===void 0||o.call(this),(i=this._unsubscribeContextMenu)===null||i===void 0||i.call(this),this._firesTouchEvents(t)||this._acceptMouseLeave&&(this._processEvent(this._makeCompatEvent(t),this._handler.mouseLeaveEvent),this._acceptMouseLeave=!Ae())},n.prototype._longTapHandler=function(t){var e=this._touchWithId(t.touches,this._activeTouchId);e!==null&&(this._processEvent(this._makeCompatEvent(t,e),this._handler.longTapEvent),this._cancelTap=!0,this._longTapActive=!0)},n.prototype._firesTouchEvents=function(t){var e;return((e=t.sourceCapabilities)===null||e===void 0?void 0:e.firesTouchEvents)!==void 0?t.sourceCapabilities.firesTouchEvents:this._eventTimeStamp(t)<this._lastTouchEventTimeStamp+500},n.prototype._processEvent=function(t,e){e==null||e.call(this._handler,t)},n.prototype._makeCompatEvent=function(t,e){var o,i=this,r=e!=null?e:t,a=(o=this._target.getBoundingClientRect())!==null&&o!==void 0?o:{left:0,top:0};return{x:r.clientX-a.left,y:r.clientY-a.top,pageX:r.pageX,pageY:r.pageY,isTouch:!t.type.startsWith("mouse")&&t.type!=="contextmenu"&&t.type!=="click",preventDefault:function(){t.type!=="touchstart"&&i._preventDefault(t)}}},n.prototype._getTouchDistance=function(t,e){var o=t.clientX-e.clientX,i=t.clientY-e.clientY;return Math.sqrt(o*o+i*i)},n.prototype._preventDefault=function(t){t.cancelable&&t.preventDefault()},n.prototype._getCoordinate=function(t){return{x:t.pageX,y:t.pageY}},n.prototype._eventTimeStamp=function(t){var e;return(e=t.timeStamp)!==null&&e!==void 0?e:performance.now()},n.prototype._touchWithId=function(t,e){for(var o=0;t.length>o;++o)if(t[o].identifier===e)return t[o];return null},n}(),$o=function(){function n(t,e){var o=this;this._flingStartTime=new Date().getTime(),this._flingScrollRequestId=null,this._startScrollCoordinate=null,this._touchCoordinate=null,this._touchCancelCrosshair=!1,this._touchZoomed=!1,this._pinchScale=1,this._mouseDownWidget=null,this._prevYAxisExtremum=null,this._xAxisStartScaleCoordinate=null,this._xAxisStartScaleDistance=0,this._xAxisScale=1,this._yAxisStartScaleDistance=0,this._mouseMoveTriggerWidgetInfo={pane:null,widget:null},this._boundKeyBoardDownEvent=function(i){if(i.shiftKey)switch(i.code){case"Equal":o._chart.getChartStore().getTimeScaleStore().zoom(.5);break;case"Minus":o._chart.getChartStore().getTimeScaleStore().zoom(-.5);break;case"ArrowLeft":(r=o._chart.getChartStore().getTimeScaleStore()).startScroll(),r.scroll(-3*r.getBarSpace().bar);break;case"ArrowRight":var r;(r=o._chart.getChartStore().getTimeScaleStore()).startScroll(),r.scroll(3*r.getBarSpace().bar)}},this._container=t,this._chart=e,this._event=new Go(t,this,{treatVertDragAsPageScroll:function(){return!1},treatHorzDragAsPageScroll:function(){return!1}}),t.addEventListener("keydown",this._boundKeyBoardDownEvent)}return n.prototype.pinchStartEvent=function(){return this._touchZoomed=!0,this._pinchScale=1,!0},n.prototype.pinchEvent=function(t,e){var o=this._findWidgetByEvent(t),i=o.pane,r=o.widget;if((i==null?void 0:i.getId())!==lt&&(r==null?void 0:r.getName())===nt){var a=this._makeWidgetEvent(t,r),s=5*(e-this._pinchScale);return this._pinchScale=e,this._chart.getChartStore().getTimeScaleStore().zoom(s,{x:a.x,y:a.y}),!0}return!1},n.prototype.mouseWheelHortEvent=function(t,e){var o=this._chart.getChartStore().getTimeScaleStore();return o.startScroll(),o.scroll(e),!0},n.prototype.mouseWheelVertEvent=function(t,e){var o,i,r=this._findWidgetByEvent(t).widget,a=(o=t.isTouch)!==null&&o!==void 0&&o,s=this._makeWidgetEvent(t,r),l=null,c=r==null?void 0:r.getName();if(a)if(c===nt||c===_t)l={x:s.x,y:s.y};else{var u=(i=this._chart.getPaneById(rt))===null||i===void 0?void 0:i.getBounding();l={x:u.width/2,y:u.height/2}}else c===nt&&(l={x:s.x,y:s.y});return l!==null&&(this._chart.getChartStore().getTimeScaleStore().zoom(e,{x:s.x,y:s.y}),!0)},n.prototype.mouseDownEvent=function(t){var e,o,i=this._findWidgetByEvent(t),r=i.pane,a=i.widget;if(this._mouseDownWidget=a,a!==null){var s=this._makeWidgetEvent(t,a);switch(a.getName()){case Qt:return a.dispatchEvent("mouseDownEvent",s);case nt:var l=(e=r==null?void 0:r.getAxisComponent().getExtremum())!==null&&e!==void 0?e:null;return this._prevYAxisExtremum=l===null?l:P({},l),this._startScrollCoordinate={x:s.x,y:s.y},this._chart.getChartStore().getTimeScaleStore().startScroll(),a.dispatchEvent("mouseDownEvent",s);case _t:return(c=a.dispatchEvent("mouseDownEvent",s))&&this._chart.updatePane(1),this._xAxisStartScaleCoordinate={x:s.x,y:s.y},this._xAxisStartScaleDistance=s.pageX,c;case xt:var c;return(c=a.dispatchEvent("mouseDownEvent",s))&&this._chart.updatePane(1),l=(o=r==null?void 0:r.getAxisComponent().getExtremum())!==null&&o!==void 0?o:null,this._prevYAxisExtremum=l===null?l:P({},l),this._yAxisStartScaleDistance=s.pageY,c}}return!1},n.prototype.mouseMoveEvent=function(t){var e,o,i,r=this._findWidgetByEvent(t),a=r.pane,s=r.widget,l=this._makeWidgetEvent(t,s);if(((e=this._mouseMoveTriggerWidgetInfo.pane)===null||e===void 0?void 0:e.getId())===(a==null?void 0:a.getId())&&((o=this._mouseMoveTriggerWidgetInfo.widget)===null||o===void 0?void 0:o.getName())===(s==null?void 0:s.getName())||(s==null||s.dispatchEvent("mouseEnterEvent",l),(i=this._mouseMoveTriggerWidgetInfo.widget)===null||i===void 0||i.dispatchEvent("mouseLeaveEvent",l),this._mouseMoveTriggerWidgetInfo={pane:a,widget:s}),s!==null)switch(s.getName()){case nt:var c=s.dispatchEvent("mouseMoveEvent",l),u=this._chart.getChartStore(),h={x:l.x,y:l.y,paneId:a==null?void 0:a.getId()};return c&&u.getTooltipStore().getActiveIcon()!==null&&(h=void 0,s!==null&&(s.getContainer().style.cursor="pointer")),this._chart.getChartStore().getTooltipStore().setCrosshair(h),c;case Qt:case _t:case xt:return c=s.dispatchEvent("mouseMoveEvent",l),this._chart.getChartStore().getTooltipStore().setCrosshair(),c}return!1},n.prototype.pressedMouseMoveEvent=function(t){var e,o,i,r,a;if(this._mouseDownWidget!==null&&this._mouseDownWidget.getName()===Qt)return this._mouseDownWidget.dispatchEvent("pressedMouseMoveEvent",t);var s=this._findWidgetByEvent(t),l=s.pane,c=s.widget;if(c!==null&&((e=this._mouseDownWidget)===null||e===void 0?void 0:e.getPane().getId())===(l==null?void 0:l.getId())&&((o=this._mouseDownWidget)===null||o===void 0?void 0:o.getName())===c.getName()){var u=this._makeWidgetEvent(t,c);switch(c.getName()){case nt:var h=c.getBounding();if(!(C=c.dispatchEvent("pressedMouseMoveEvent",u))&&this._startScrollCoordinate!==null){var d=l==null?void 0:l.getAxisComponent();if(this._prevYAxisExtremum!==null&&!d.getAutoCalcTickFlag()&&d.getScrollZoomEnabled()){var p=this._prevYAxisExtremum,v=p.min,g=p.max+(w=(T=p.range)*(b=((i=d==null?void 0:d.isReverse())!==null&&i!==void 0&&i?this._startScrollCoordinate.y-u.y:u.y-this._startScrollCoordinate.y)/h.height)),m=d.convertToRealValue(I=v+w),y=d.convertToRealValue(g);d.setExtremum({min:I,max:g,range:g-I,realMin:m,realMax:y,realRange:y-m})}var _=u.x-this._startScrollCoordinate.x;this._chart.getChartStore().getTimeScaleStore().scroll(_)}return this._chart.getChartStore().getTooltipStore().setCrosshair({x:u.x,y:u.y,paneId:l==null?void 0:l.getId()}),C;case _t:if(C=c.dispatchEvent("pressedMouseMoveEvent",u))this._chart.updatePane(1);else{var x=l==null?void 0:l.getAxisComponent();if((r=x==null?void 0:x.getScrollZoomEnabled())===null||r===void 0||r){var S=10*((b=this._xAxisStartScaleDistance/u.pageX)-this._xAxisScale);this._xAxisScale=b,this._chart.getChartStore().getTimeScaleStore().zoom(S,(a=this._xAxisStartScaleCoordinate)!==null&&a!==void 0?a:void 0)}}return C;case xt:var C;if(C=c.dispatchEvent("pressedMouseMoveEvent",u))this._chart.updatePane(1);else if(d=l==null?void 0:l.getAxisComponent(),this._prevYAxisExtremum!==null&&d.getScrollZoomEnabled()){var T,b,w,E=this._prevYAxisExtremum,D=(T=E.range)*(b=u.pageY/this._yAxisStartScaleDistance),I=(v=E.min)-(w=(D-T)/2),M=(g=E.max+w,l==null?void 0:l.getAxisComponent());m=M.convertToRealValue(I),y=M.convertToRealValue(g),M.setExtremum({min:I,max:g,range:D,realMin:m,realMax:y,realRange:y-m}),this._chart.adjustPaneViewport(!1,!0,!0,!0)}return C}}return!1},n.prototype.mouseUpEvent=function(t){var e=this._findWidgetByEvent(t).widget,o=!1;if(e!==null){var i=this._makeWidgetEvent(t,e);switch(e.getName()){case nt:case Qt:case _t:case xt:o=e.dispatchEvent("mouseUpEvent",i)}o&&this._chart.updatePane(1)}return this._mouseDownWidget=null,this._startScrollCoordinate=null,this._prevYAxisExtremum=null,this._xAxisStartScaleCoordinate=null,this._xAxisStartScaleDistance=0,this._xAxisScale=1,this._yAxisStartScaleDistance=0,o},n.prototype.mouseClickEvent=function(t){var e=this._findWidgetByEvent(t).widget;if(e!==null){var o=this._makeWidgetEvent(t,e);return e.dispatchEvent("mouseClickEvent",o)}return!1},n.prototype.mouseRightClickEvent=function(t){var e=this._findWidgetByEvent(t).widget,o=!1;if(e!==null){var i=this._makeWidgetEvent(t,e);switch(e.getName()){case nt:case _t:case xt:o=e.dispatchEvent("mouseRightClickEvent",i)}o&&this._chart.updatePane(1)}return!1},n.prototype.mouseDoubleClickEvent=function(t){var e=this._findWidgetByEvent(t),o=e.pane,i=e.widget;if(i!==null)switch(i.getName()){case nt:var r=this._makeWidgetEvent(t,i);return i.dispatchEvent("mouseDoubleClickEvent",r);case xt:var a=o==null?void 0:o.getAxisComponent();if(!a.getAutoCalcTickFlag())return a.setAutoCalcTickFlag(!0),this._chart.adjustPaneViewport(!1,!0,!0,!0),!0}return!1},n.prototype.mouseLeaveEvent=function(){return this._chart.getChartStore().getTooltipStore().setCrosshair(),!0},n.prototype.touchStartEvent=function(t){var e=this._findWidgetByEvent(t),o=e.pane,i=e.widget;if(i!==null){var r=this._makeWidgetEvent(t,i);switch(i.getName()){case nt:var a=this._chart.getChartStore(),s=a.getTooltipStore();if(i.dispatchEvent("mouseDownEvent",r))return this._touchCancelCrosshair=!0,this._touchCoordinate=null,s.setCrosshair(void 0,!0),this._chart.updatePane(1),!0;if(this._flingScrollRequestId!==null&&(ue(this._flingScrollRequestId),this._flingScrollRequestId=null),this._flingStartTime=new Date().getTime(),this._startScrollCoordinate={x:r.x,y:r.y},a.getTimeScaleStore().startScroll(),this._touchZoomed=!1,this._touchCoordinate!==null){var l=r.x-this._touchCoordinate.x,c=r.y-this._touchCoordinate.y;10>Math.sqrt(l*l+c*c)?(this._touchCoordinate={x:r.x,y:r.y},s.setCrosshair({x:r.x,y:r.y,paneId:o==null?void 0:o.getId()})):(this._touchCoordinate=null,this._touchCancelCrosshair=!0,s.setCrosshair())}return!0;case _t:case xt:var u=i.dispatchEvent("mouseDownEvent",r);return u&&this._chart.updatePane(1),u}}return!1},n.prototype.touchMoveEvent=function(t){var e,o,i,r=this._findWidgetByEvent(t),a=r.pane,s=r.widget;if(s!==null){var l=this._makeWidgetEvent(t,s),c=s.getName(),u=this._chart.getChartStore(),h=u.getTooltipStore();switch(c){case nt:if(s.dispatchEvent("pressedMouseMoveEvent",l))return(e=l.preventDefault)===null||e===void 0||e.call(l),h.setCrosshair(void 0,!0),this._chart.updatePane(1),!0;if(this._touchCoordinate!==null)(o=l.preventDefault)===null||o===void 0||o.call(l),h.setCrosshair({x:l.x,y:l.y,paneId:a==null?void 0:a.getId()});else if(this._startScrollCoordinate!==null&&Math.abs(this._startScrollCoordinate.x-l.x)>this._startScrollCoordinate.y-l.y){var d=l.x-this._startScrollCoordinate.x;u.getTimeScaleStore().scroll(d)}return!0;case _t:case xt:var p=s.dispatchEvent("pressedMouseMoveEvent",l);return p&&((i=l.preventDefault)===null||i===void 0||i.call(l),this._chart.updatePane(1)),p}}return!1},n.prototype.touchEndEvent=function(t){var e=this,o=this._findWidgetByEvent(t).widget;if(o!==null){var i=this._makeWidgetEvent(t,o);switch(o.getName()){case nt:if(o.dispatchEvent("mouseUpEvent",i),this._startScrollCoordinate!==null){var r=new Date().getTime()-this._flingStartTime,a=(i.x-this._startScrollCoordinate.x)/(r>0?r:1)*20;if(200>r&&Math.abs(a)>0){var s=this._chart.getChartStore().getTimeScaleStore(),l=function(){e._flingScrollRequestId=Ie(function(){s.startScroll(),s.scroll(a),1>Math.abs(a*=.975)?e._flingScrollRequestId!==null&&(ue(e._flingScrollRequestId),e._flingScrollRequestId=null):l()})};l()}}return!0;case _t:case xt:o.dispatchEvent("mouseUpEvent",i)&&this._chart.updatePane(1)}}return!1},n.prototype.tapEvent=function(t){var e=this._findWidgetByEvent(t),o=e.pane,i=e.widget,r=!1;if(i!==null){var a=this._makeWidgetEvent(t,i),s=i.dispatchEvent("mouseClickEvent",a);if(i.getName()===nt){var l=this._makeWidgetEvent(t,i),c=this._chart.getChartStore().getTooltipStore();s?(this._touchCancelCrosshair=!0,this._touchCoordinate=null,c.setCrosshair(void 0,!0),r=!0):(this._touchCancelCrosshair||this._touchZoomed||(this._touchCoordinate={x:l.x,y:l.y},c.setCrosshair({x:l.x,y:l.y,paneId:o==null?void 0:o.getId()},!0),r=!0),this._touchCancelCrosshair=!1)}(r||s)&&this._chart.updatePane(1)}return r},n.prototype.doubleTapEvent=function(t){return this.mouseDoubleClickEvent(t)},n.prototype.longTapEvent=function(t){var e=this._findWidgetByEvent(t),o=e.pane,i=e.widget;if(i!==null&&i.getName()===nt){var r=this._makeWidgetEvent(t,i);return this._touchCoordinate={x:r.x,y:r.y},this._chart.getChartStore().getTooltipStore().setCrosshair({x:r.x,y:r.y,paneId:o==null?void 0:o.getId()}),!0}return!1},n.prototype._findWidgetByEvent=function(t){var e,o,i=this._chart.getAllPanes(),r=t.x,a=t.y,s=null;try{for(var l=qt(i),c=l.next();!c.done;c=l.next()){var u=it(c.value,2)[1],h=u.getBounding();if(!(h.left>r||r>h.left+h.width||h.top>a||a>h.top+h.height)){s=u;break}}}catch(x){e={error:x}}finally{try{c&&!c.done&&(o=l.return)&&o.call(l)}finally{if(e)throw e.error}}s===null&&(s=this._chart.getPaneById(lt));var d=null;if(s!==null){var p=s.getSeparatorWidget();if(p!==null){var v=p.getBounding();v.left>r||r>v.left+v.width||v.top>a||a>v.top+7||(d=p)}if(d===null){var g=s.getMainWidget(),m=g.getBounding();m.left>r||r>m.left+m.width||m.top>a||a>m.top+m.height||(d=g)}if(d===null){var y=s.getYAxisWidget();if(y!==null){var _=y.getBounding();_.left>r||r>_.left+_.width||_.top>a||a>_.top+_.height||(d=y)}}}return{pane:s,widget:d}},n.prototype._makeWidgetEvent=function(t,e){var o,i,r,a=(o=e==null?void 0:e.getBounding())!==null&&o!==void 0?o:null;return P(P({},t),{x:t.x-((i=a==null?void 0:a.left)!==null&&i!==void 0?i:0),y:t.y-((r=a==null?void 0:a.top)!==null&&r!==void 0?r:0)})},n.prototype.destroy=function(){this._container.removeEventListener("keydown",this._boundKeyBoardDownEvent),this._event.destroy()},n}();f.DomPosition=void 0,(Fe=f.DomPosition||(f.DomPosition={})).Root="root",Fe.Main="main",Fe.YAxis="yAxis";var Di=function(){function n(t,e){this._panes=new Map,this._initContainer(t),this._chartEvent=new $o(this._chartContainer,this),this._chartStore=new Co(this,e),this._xAxisPane=new qo(this._chartContainer,this,lt),this._panes.set(rt,new zo(this._chartContainer,this,rt)),this.adjustPaneViewport(!0,!0,!0)}return n.prototype._initContainer=function(t){this._container=t,this._chartContainer=yt("div",{position:"relative",width:"100%",outline:"none",borderStyle:"none",cursor:"crosshair",boxSizing:"border-box",userSelect:"none",webkitUserSelect:"none",msUserSelect:"none",MozUserSelect:"none",webkitTapHighlightColor:"transparent"}),this._chartContainer.tabIndex=1,t.appendChild(this._chartContainer)},n.prototype._measurePaneHeight=function(){var t,e=this._container.offsetHeight,o=this._xAxisPane.getAxisComponent().getAutoSize(),i=e-o;0>i&&(i=0);var r=0;this._panes.forEach(function(l){if(l.getId()!==rt){var c=l.getBounding().height,u=l.getOptions().minHeight;u>c&&(c=u),r+c>i?c=Math.max(i-(r=i),0):r+=c,l.setBounding({height:c})}});var a=i-r;(t=this._panes.get(rt))===null||t===void 0||t.setBounding({height:a});var s=0;this._panes.forEach(function(l){l.setBounding({top:s}),s+=l.getBounding().height}),this._xAxisPane.setBounding({height:o,top:s})},n.prototype._measurePaneWidth=function(){var t=this._chartStore.getStyles().yAxis,e=t.position===f.YAxisPosition.Left,o=!t.inside,i=this._container.offsetWidth,r=0,a=Number.MIN_SAFE_INTEGER,s=0,l=0;this._panes.forEach(function(d){a=Math.max(a,d.getAxisComponent().getAutoSize())}),a>i&&(a=i),o?(r=i-a,e?(s=0,l=a):(s=i-a,l=0)):(r=i,l=0,s=e?0:i-a),this._chartStore.getTimeScaleStore().setTotalBarSpace(r);var c={width:i},u={width:r,left:l},h={width:a,left:s};this._panes.forEach(function(d){d.setBounding(c,u,h)}),this._xAxisPane.setBounding(c,u,h)},n.prototype._setPaneOptions=function(t,e){var o,i,r=this._panes.get((o=t==null?void 0:t.id)!==null&&o!==void 0?o:""),a=!1;if(r!==void 0){var s=e;if(t.id!==rt&&t.height!==void 0&&t.height>0){var l=Math.max((i=t.minHeight)!==null&&i!==void 0?i:r.getOptions().minHeight,0);r.setBounding({height:Math.max(l,t.height)}),s=!0,a=!0}r.setOptions(t),s&&this.adjustPaneViewport(a,!0,!0,!0,!0)}},n.prototype.getContainer=function(){return this._container},n.prototype.getChartStore=function(){return this._chartStore},n.prototype.getAllPanes=function(){return this._panes},n.prototype.adjustPaneViewport=function(t,e,o,i,r){t&&this._measurePaneHeight();var a=e,s=r!=null&&r;(i!=null&&i||s)&&this._panes.forEach(function(l){var c=l.getAxisComponent().buildTicks(s);a||(a=c)}),a&&this._measurePaneWidth(),o!=null&&o&&(this._xAxisPane.getAxisComponent().buildTicks(!0),this.updatePane(4))},n.prototype.updatePane=function(t,e){var o;e!==void 0?(o=this.getPaneById(e))===null||o===void 0||o.update(t):(this._xAxisPane.update(t),this._panes.forEach(function(i){i.update(t)}))},n.prototype.getPaneById=function(t){var e;return t===lt?this._xAxisPane:(e=this._panes.get(t))!==null&&e!==void 0?e:null},n.prototype.crosshairChange=function(t){var e=this,o=this._chartStore.getActionStore();if(o.has(f.ActionType.OnCrosshairChange)){var i={};this._panes.forEach(function(r,a){var s={};e._chartStore.getIndicatorStore().getInstances(a).forEach(function(l){var c,u=l.result;s[l.name]=u[(c=t.dataIndex)!==null&&c!==void 0?c:u.length-1]}),i[a]=s}),t.paneId!==void 0&&o.execute(f.ActionType.OnCrosshairChange,P(P({},t),{indicatorData:i}))}},n.prototype.getDom=function(t,e){var o,i;if(t===void 0)return this._chartContainer;var r=this.getPaneById(t);if(r!==null)switch(e!=null?e:f.DomPosition.Root){case f.DomPosition.Root:return r.getContainer();case f.DomPosition.Main:return r.getMainWidget().getContainer();case f.DomPosition.YAxis:return(i=(o=r.getYAxisWidget())===null||o===void 0?void 0:o.getContainer())!==null&&i!==void 0?i:null}return null},n.prototype.getSize=function(t,e){var o,i;if(t===void 0)return{width:this._chartContainer.offsetWidth,height:this._chartContainer.offsetHeight,left:0,top:0,right:0,bottom:0};var r=this.getPaneById(t);if(r!==null)switch(e!=null?e:f.DomPosition.Root){case f.DomPosition.Root:return r.getBounding();case f.DomPosition.Main:return r.getMainWidget().getBounding();case f.DomPosition.YAxis:return(i=(o=r.getYAxisWidget())===null||o===void 0?void 0:o.getBounding())!==null&&i!==void 0?i:null}return null},n.prototype.setStyles=function(t){var e,o,i;this._chartStore.setOptions({styles:t}),((e=(i=q(t)?ai(t):t)==null?void 0:i.yAxis)===null||e===void 0?void 0:e.type)!==void 0&&((o=this.getPaneById(rt))===null||o===void 0||o.getAxisComponent().setAutoCalcTickFlag(!0)),this.adjustPaneViewport(!0,!0,!0,!0,!0)},n.prototype.getStyles=function(){return this._chartStore.getStyles()},n.prototype.setLocale=function(t){this._chartStore.setOptions({locale:t}),this.adjustPaneViewport(!0,!0,!0,!0,!0)},n.prototype.getLocale=function(){return this._chartStore.getLocale()},n.prototype.setCustomApi=function(t){this._chartStore.setOptions({customApi:t}),this.adjustPaneViewport(!0,!0,!0,!0,!0)},n.prototype.setPriceVolumePrecision=function(t,e){this._chartStore.setPrecision({price:t,volume:e})},n.prototype.getPriceVolumePrecision=function(){return this._chartStore.getPrecision()},n.prototype.setTimezone=function(t){this._chartStore.setOptions({timezone:t}),this._xAxisPane.getAxisComponent().buildTicks(!0),this._xAxisPane.update(3)},n.prototype.getTimezone=function(){return this._chartStore.getTimeScaleStore().getTimezone()},n.prototype.setOffsetRightDistance=function(t){this._chartStore.getTimeScaleStore().setOffsetRightDistance(t,!0)},n.prototype.getOffsetRightDistance=function(){return this._chartStore.getTimeScaleStore().getOffsetRightDistance()},n.prototype.setLeftMinVisibleBarCount=function(t){t>0&&this._chartStore.getTimeScaleStore().setLeftMinVisibleBarCount(Math.ceil(t))},n.prototype.setRightMinVisibleBarCount=function(t){t>0&&this._chartStore.getTimeScaleStore().setRightMinVisibleBarCount(Math.ceil(t))},n.prototype.setBarSpace=function(t){this._chartStore.getTimeScaleStore().setBarSpace(t)},n.prototype.getBarSpace=function(){return this._chartStore.getTimeScaleStore().getBarSpace().bar},n.prototype.getVisibleRange=function(){return this._chartStore.getTimeScaleStore().getVisibleRange()},n.prototype.clearData=function(){this._chartStore.clear()},n.prototype.getDataList=function(){return this._chartStore.getDataList()},n.prototype.applyNewData=function(t,e,o){this._chartStore.clear(),t.length===0?this.adjustPaneViewport(!1,!0,!0,!0):this.applyMoreData(t,e,o)},n.prototype.applyMoreData=function(t,e,o){var i=this;this._chartStore.addData(t,0,e),t.length>0&&this._chartStore.getIndicatorStore().calcInstance().then(function(r){i.adjustPaneViewport(!1,!0,!0,!0),o==null||o()}).catch(function(r){})},n.prototype.updateData=function(t,e){var o=this,i=this._chartStore.getDataList(),r=i.length,a=t.timestamp,s=$(i[r-1],"timestamp",0);if(a>=s){var l=r;a===s&&(l=r-1),this._chartStore.addData(t,l),this._chartStore.getIndicatorStore().calcInstance().then(function(c){o.adjustPaneViewport(!1,!0,!0,!0),e==null||e()}).catch(function(c){})}},n.prototype.loadMore=function(t){this._chartStore.getTimeScaleStore().setLoadMoreCallback(t)},n.prototype.createIndicator=function(t,e,o,i){var r,a,s,l=this,c=q(t)?{name:t}:t;if($e(c.name)===null)return null;if(R(o)&&q(o==null?void 0:o.id)&&this._panes.has(o.id))s=o.id,this._chartStore.getIndicatorStore().addInstance(c,s,e!=null&&e).then(function(p){var v,g;l._setPaneOptions(o,(g=(v=l._panes.get(s))===null||v===void 0?void 0:v.getAxisComponent().buildTicks(!0))!==null&&g!==void 0&&g)}).catch(function(p){});else{s=(r=o==null?void 0:o.id)!==null&&r!==void 0?r:je(_o);var u=Array.from(this._panes.values()).pop(),h=new Ei(this._chartContainer,this,s,u);u.setBottomPane(h);var d=(a=o==null?void 0:o.height)!==null&&a!==void 0?a:100;h.setBounding({height:d}),R(o)&&h.setOptions(o),this._panes.set(s,h),this._chartStore.getIndicatorStore().addInstance(c,s,e!=null&&e).finally(function(){l.adjustPaneViewport(!0,!0,!0,!0,!0),i==null||i()})}return s},n.prototype.overrideIndicator=function(t,e,o){var i=this;this._chartStore.getIndicatorStore().override(t,e!=null?e:null).then(function(r){var a=it(r,2),s=a[1];(a[0]||s)&&(i.adjustPaneViewport(!1,s,!0,s),o==null||o())}).catch(function(){})},n.prototype.getIndicatorByPaneId=function(t,e){return this._chartStore.getIndicatorStore().getInstanceByPaneId(t,e)},n.prototype.removeIndicator=function(t,e){var o=this._chartStore.getIndicatorStore();if(o.removeInstance(t,e)){var i=!1;if(t!==rt&&!o.hasInstances(t)){var r=this._panes.get(t);if(r!==void 0){i=!0;var a=r.getTopPane(),s=r.getBottomPane();s==null||s.setTopPane(a),a==null||a.setBottomPane(s),r==null||r.destroy(),this._panes.delete(t)}}this.adjustPaneViewport(i,!0,!0,!0,!0)}},n.prototype.createOverlay=function(t,e){var o=[];q(t)?o=[{name:t}]:W(t)?o=t.map(function(a){return q(a)?{name:a}:a}):o=[t];var i=!0;e!==void 0&&this.getPaneById(e)!==null||(e=rt,i=!1);var r=this._chartStore.getOverlayStore().addInstances(o,e,i);return W(t)?r:r[0]},n.prototype.getOverlayById=function(t){return this._chartStore.getOverlayStore().getInstanceById(t)},n.prototype.overrideOverlay=function(t){this._chartStore.getOverlayStore().override(t)},n.prototype.removeOverlay=function(t){var e;t!==void 0&&(e=q(t)?{id:t}:t),this._chartStore.getOverlayStore().removeInstance(e)},n.prototype.setPaneOptions=function(t){this._setPaneOptions(t,!1)},n.prototype.setZoomEnabled=function(t){this._chartStore.getTimeScaleStore().setZoomEnabled(t)},n.prototype.isZoomEnabled=function(){return this._chartStore.getTimeScaleStore().getZoomEnabled()},n.prototype.setScrollEnabled=function(t){this._chartStore.getTimeScaleStore().setScrollEnabled(t)},n.prototype.isScrollEnabled=function(){return this._chartStore.getTimeScaleStore().getScrollEnabled()},n.prototype.scrollByDistance=function(t,e){var o=e===void 0||0>e?0:e,i=this._chartStore.getTimeScaleStore();if(o>0){i.startScroll();var r=new Date().getTime(),a=function(){var s=(new Date().getTime()-r)/o,l=s>=1;i.scroll(l?t:t*s),l||requestAnimationFrame(a)};a()}else i.startScroll(),i.scroll(t)},n.prototype.scrollToRealTime=function(t){var e=this._chartStore.getTimeScaleStore(),o=e.getBarSpace().bar,i=e.getOffsetRightBarCount()-e.getInitialOffsetRightDistance()/o;this.scrollByDistance(i*o,t)},n.prototype.scrollToDataIndex=function(t,e){var o=this._chartStore.getTimeScaleStore(),i=(o.getOffsetRightBarCount()+(this.getDataList().length-1-t))*o.getBarSpace().bar;this.scrollByDistance(i,e)},n.prototype.scrollToTimestamp=function(t,e){var o=Se(this.getDataList(),"timestamp",t);this.scrollToDataIndex(o,e)},n.prototype.zoomAtCoordinate=function(t,e,o){var i=o===void 0||0>o?0:o,r=this._chartStore.getTimeScaleStore();if(i>0){var a=r.getBarSpace().bar,s=a*t-a,l=new Date().getTime(),c=function(){var u=(new Date().getTime()-l)/i,h=u>=1;r.zoom((h?s:s*u)/a,e),h||requestAnimationFrame(c)};c()}else r.zoom(t,e)},n.prototype.zoomAtDataIndex=function(t,e,o){var i=this._chartStore.getTimeScaleStore().dataIndexToCoordinate(e);this.zoomAtCoordinate(t,{x:i,y:0},o)},n.prototype.zoomAtTimestamp=function(t,e,o){var i=Se(this.getDataList(),"timestamp",e);this.zoomAtDataIndex(t,i,o)},n.prototype.convertToPixel=function(t,e){var o,i=e.paneId,r=i===void 0?rt:i,a=e.absolute,s=a!==void 0&&a,l=[];if(r!==lt){var c=this.getPaneById(r);if(c!==null){var u=this._chartStore.getTimeScaleStore(),h=c.getBounding(),d=[].concat(t),p=this._xAxisPane.getAxisComponent(),v=c.getAxisComponent();l=d.map(function(g){var m={},y=g.dataIndex;if(g.timestamp!==void 0&&(y=u.timestampToDataIndex(g.timestamp)),y!==void 0&&(m.x=p==null?void 0:p.convertToPixel(y)),g.value!==void 0){var _=v==null?void 0:v.convertToPixel(g.value);m.y=s?h.top+_:_}return m})}}return W(t)?l:(o=l[0])!==null&&o!==void 0?o:{}},n.prototype.convertFromPixel=function(t,e){var o,i=e.paneId,r=i===void 0?rt:i,a=e.absolute,s=a!==void 0&&a,l=[];if(r!==lt){var c=this.getPaneById(r);if(c!==null){var u=this._chartStore.getTimeScaleStore(),h=c.getBounding(),d=[].concat(t),p=this._xAxisPane.getAxisComponent(),v=c.getAxisComponent();l=d.map(function(g){var m,y={};if(g.x!==void 0){var _=p.convertFromPixel(g.x);y.dataIndex=_,y.timestamp=(m=u.dataIndexToTimestamp(_))!==null&&m!==void 0?m:void 0}return g.y!==void 0&&(y.value=v.convertFromPixel(s?g.y-h.top:g.y)),y})}}return W(t)?l:(o=l[0])!==null&&o!==void 0?o:{}},n.prototype.executeAction=function(t,e){var o;if(t===f.ActionType.OnCrosshairChange){var i=P({},e);i.paneId=(o=i.paneId)!==null&&o!==void 0?o:rt,this._chartStore.getTooltipStore().setCrosshair(i)}},n.prototype.subscribeAction=function(t,e){this._chartStore.getActionStore().subscribe(t,e)},n.prototype.unsubscribeAction=function(t,e){this._chartStore.getActionStore().unsubscribe(t,e)},n.prototype.getConvertPictureUrl=function(t,e,o){var i=this._chartContainer.offsetWidth,r=this._chartContainer.offsetHeight,a=yt("canvas",{width:"".concat(i,"px"),height:"".concat(r,"px"),boxSizing:"border-box"}),s=a.getContext("2d"),l=kt(a);a.width=i*l,a.height=r*l,s.scale(l,l),s.fillStyle=o!=null?o:"#FFFFFF",s.fillRect(0,0,i,r);var c=t!=null&&t;this._panes.forEach(function(h){var d=h.getBounding();s.drawImage(h.getImage(c),0,d.top,i,d.height)});var u=this._xAxisPane.getBounding();return s.drawImage(this._xAxisPane.getImage(c),0,u.top,i,u.height),a.toDataURL("image/".concat(e!=null?e:"jpeg"))},n.prototype.resize=function(){this.adjustPaneViewport(!0,!0,!0,!0,!0)},n.prototype.destroy=function(){this._chartEvent.destroy(),this._panes.forEach(function(t){t.destroy()}),this._panes.clear(),this._xAxisPane.destroy(),this._container.removeChild(this._chartContainer)},n}(),de=new Map,Ko=1,Uo={clone:Z,merge:j,isString:q,isNumber:V,isValid:R,isObject:N,isArray:W,isFunction:K,isBoolean:G,formatValue:$,formatPrecision:U,formatBigNumber:Ye,formatDate:ze,formatThousands:J,calcTextWidth:Gt,getLinearSlopeIntercept:ce,getLinearYFromSlopeIntercept:Ee,getLinearYFromCoordinates:Kt,checkCoordinateOnArc:fi,checkCoordinateOnCircle:si,checkCoordinateOnLine:Je,checkCoordinateOnPolygon:ci,checkCoordinateOnRect:di,checkCoordinateOnText:vi,drawArc:mi,drawCircle:li,drawLine:ti,drawPolygon:ui,drawRect:Pe,drawText:Me,drawRectText:Eo};f.dispose=function(n){var t,e,o;if(n instanceof Di)o=n.id;else{var i=void 0;o=(t=(i=q(n)?document.getElementById(n):n)==null?void 0:i.getAttribute("k-line-chart-id"))!==null&&t!==void 0?t:null}o!==null&&((e=de.get(o))===null||e===void 0||e.destroy(),de.delete(o))},f.getFigureClass=function(n){var t;return(t=Jt[n])!==null&&t!==void 0?t:null},f.getOverlayClass=function(n){var t;return(t=Ut[n])!==null&&t!==void 0?t:null},f.getSupportedFigures=function(){return Object.keys(Jt)},f.getSupportedIndicators=function(){return Object.keys(le)},f.getSupportedLocales=function(){return Object.keys(he)},f.getSupportedOverlays=function(){return Object.keys(Ut)},f.init=function(n,t){var e;if((e=q(n)?document.getElementById(n):n)===null)return null;var o=de.get(e.id);if(o!==void 0)return o;var i="k_line_chart_".concat(Ko++);return(o=new Di(e,t)).id=i,e.setAttribute("k-line-chart-id",i),de.set(i,o),o},f.registerFigure=function(n){Jt[n.name]=Ue.extend(n)},f.registerIndicator=function(n){le[n.name]=Ge.extend(n)},f.registerLocale=function(n,t){he[n]=P(P({},he[n]),t)},f.registerOverlay=function(n){Ut[n.name]=Ke.extend(n)},f.registerStyles=function(n,t){ri[n]=t},f.utils=Uo,f.version=function(){return"9.5.4"}})})(Ve,Ve.exports);ge.exports=Ve.exports;function Hi(k){return nn.post("/stock/chart/kline",k)}const Pn=Xi({name:"KLine",props:{height:{type:String,default:"40vh"},stock:{type:Object,default:()=>({})},transactions:{type:Array,default:()=>[]}},emits:["update:show","confirm"],setup(k,mt){const f=rn({time:void 0,open:{color:"",text:""},high:{color:"",text:""},low:{color:"",text:""},close:{color:"",text:""},chg:{color:"",text:""},percent:{color:"",text:""},volume:void 0}),j=W=>{const K=W.data;if(K.error_code!=0)return[];const{column:N,item:V}=K.data;return V.map(R=>R.reduce((G,q,wt)=>(G[N[wt]]=q,G),{}))};let Z;return an(()=>k.stock,W=>{!Z||!(W!=null&&W.code)||Hi({symbol:W.code,begin:new Date().getTime(),count:-284}).then(K=>{const N=j(K);Z.applyNewData(N,N.length==284),k.transactions.forEach(V=>{const R=V.direction?"#f44336":"#4caf50";Z.createOverlay({name:"simpleAnnotation",id:`transactions-${V.id}`,groupId:"transactions",points:[{timestamp:zi.extractDate(V.date,"YYYY-MM-DD").getTime(),value:V.price}],extendData:V.price,styles:{line:{style:"dashed",color:R,dashedValue:[5,5]},polygon:{color:R,borderColor:R},rectText:{borderColor:R,backgroundColor:R}}})}),W.quantity>0&&Z.createOverlay({name:"priceLine",id:"priceLine",groupId:"priceLine",points:[{value:+k.stock.price}],extendData:k.stock.price,styles:{line:{style:"dashed",dashedValue:[5,5]}}})})}),ji(()=>{Z=ge.exports.init("chart",{locale:"zh-CN",customApi:{formatDate:function(W,K,N,V){return ge.exports.utils.formatDate(W,K,"YYYY-MM-DD")}},styles:{candle:{priceMark:{last:{show:!1}},tooltip:{custom:(W,K)=>{var G;const N=W.current,V=(G=W.prev)==null?void 0:G.close,R=(q,wt)=>{const Zt=N[q]>wt?"text-red":"text-green";return{text:N[q],color:Zt}};return f.value={time:zi.formatDate(N.timestamp,"YYYY-MM-DD"),open:R("open",V),high:R("high",V),low:R("low",V),close:R("close",V),chg:R("chg",0),percent:R("percent",0),volume:ge.exports.utils.formatBigNumber(N.volume)},[]}}},yAxis:{inside:!0,axisLine:{show:!1}}}}),Z.setPriceVolumePrecision(3,3),Z.loadMore(W=>{Hi({symbol:k.stock.code,begin:W,count:-142}).then(K=>{const N=j(K);Z.applyMoreData(N,N.length==142)})})}),{tipData:f}}}),Vt=k=>(ln("data-v-d95c9900"),k=k(),cn(),k),Mn={class:"row q-col-gutter-xs text-grey text-caption"},kn={class:"col"},An={class:"col flex justify-between"},Fn=Vt(()=>A("span",null,"\u989D",-1)),Ln={class:"col flex justify-between"},Rn=Vt(()=>A("span",null,"\u5F00",-1)),Bn={class:"col flex justify-between"},On=Vt(()=>A("span",null,"\u9AD8",-1)),Vn={class:"row q-col-gutter-xs text-grey text-caption"},Wn={class:"col flex justify-between"},Nn=Vt(()=>A("span",null,"\u91CF",-1)),zn={class:"col flex justify-between"},Yn=Vt(()=>A("span",null,"\u5E45",-1)),Hn={class:"col flex justify-between"},Xn=Vt(()=>A("span",null,"\u6536",-1)),jn={class:"col flex justify-between"},Zn=Vt(()=>A("span",null,"\u4F4E",-1));function qn(k,mt,f,j,Z,W){return Ot(),oe("div",null,[A("div",Mn,[A("div",kn,et(k.tipData.time),1),A("div",An,[Fn,A("span",{class:jt(k.tipData.chg.color)},et(k.tipData.chg.text),3)]),A("div",Ln,[Rn,A("span",{class:jt(k.tipData.open.color)},et(k.tipData.open.text),3)]),A("div",Bn,[On,A("span",{class:jt(k.tipData.high.color)},et(k.tipData.high.text),3)])]),A("div",Vn,[A("div",Wn,[Nn,A("span",null,et(k.tipData.volume),1)]),A("div",zn,[Yn,A("span",{class:jt(k.tipData.percent.color)},et(k.tipData.percent.text)+"%",3)]),A("div",Hn,[Xn,A("span",{class:jt(k.tipData.close.color)},et(k.tipData.close.text),3)]),A("div",jn,[Zn,A("span",{class:jt(k.tipData.low.color)},et(k.tipData.low.text),3)])]),A("div",{id:"chart",style:sn({height:k.height})},null,4)])}var Gn=Zi(Pn,[["render",qn],["__scopeId","data-v-d95c9900"]]);const $n=Xi({name:"TransactionPage",components:{AddTransaction:En,KLine:Gn},setup(){const k=wn(),mt=un(),f=hn(),j=+mt.params.stockId,Z=dn({stock:{},transactions:[],transactionAddShow:!1,transactionAddData:{}}),W=()=>{Yi(j).then(G=>Z.stock=G.data),xn(j).then(G=>Z.transactions=G.data)};ji(W);const K=pn(()=>f.isLogin),N=G=>{Z.transactionAddShow=!0,Z.transactionAddData={stockId:j,userId:Z.stock.userId,...G}},V=()=>{In(j).then(()=>{Yi(j).then(G=>Z.stock=G.data)}).catch(G=>{var q;k.notify({message:((q=G.response)==null?void 0:q.data)||G.message||"\u4F30\u503C\u5237\u65B0\u5931\u8D25",color:"warning"})})},R=G=>{Sn(G).then(W).catch(q=>{var wt;k.notify({message:((wt=q.response)==null?void 0:wt.data)||q.message||"\u4EA4\u6613\u5220\u9664\u5931\u8D25",color:"warning"})})};return{...vn(Z),isLogin:K,loadData:W,onEditTranscation:N,onRefreshStockWorth:V,onDeleteTranscation:R}}}),Kn={class:"row"},Un={class:"col"},Qn={class:"text-h6"},Jn={class:"text-body2 text-grey q-ml-sm"},tr={key:0,class:"q-gutter-md"},er={class:"flex justify-between text-body2"},ir={class:"column items-center"},or={class:"text-subtitle2"},nr=A("span",{class:"text-grey"},"\u5355\u4EF7(\u8FD1\u4F3C\u503C)",-1),rr={class:"column items-center"},ar={class:"text-subtitle2"},sr=A("span",{class:"text-grey"},"\u6570\u91CF(\u8FD1\u4F3C\u503C)",-1),lr={class:"column items-center"},cr={class:"text-subtitle2"},ur=A("span",{class:"text-grey"},"\u603B\u989D(\u8FD1\u4F3C\u503C)",-1),hr={class:"row"},dr={class:"col"},pr={key:0,class:"q-gutter-md"},vr={class:"flex justify-between"},gr={class:"column items-center"},fr={class:"text-subtitle2"},mr=A("span",{class:"text-grey"},"\u5355\u4EF7",-1),yr={class:"column items-center"},_r={class:"text-subtitle2"},xr=A("span",{class:"text-grey"},"\u6570\u91CF",-1),Sr={class:"column items-center"},Cr={class:"text-subtitle2"},br=A("span",{class:"text-grey"},"\u603B\u989D",-1);function Tr(k,mt,f,j,Z,W){const K=Oi("KLine"),N=Oi("AddTransaction");return Ot(),Vi(Tn,null,{default:Tt(()=>[ot(Cn,{class:"q-px-md"},{default:Tt(()=>[ot(Ni,{heading:""},{default:Tt(()=>[A("div",Kn,[A("div",Un,[A("span",Qn,et(k.stock.name),1),A("span",Jn,et(k.stock.code),1)]),k.isLogin?(Ot(),oe("div",tr,[ot(ie,{flat:"",dense:"",round:"",icon:"add",onClick:mt[0]||(mt[0]=V=>k.onEditTranscation({}))}),ot(ie,{color:"warning",label:"\u91CD\u7B97\u4F30\u503C",onClick:k.onRefreshStockWorth},null,8,["onClick"])])):Be("",!0)]),A("div",er,[A("div",ir,[A("span",or,et(k.stock.price),1),nr]),A("div",rr,[A("span",ar,et(k.stock.quantity),1),sr]),A("div",lr,[A("span",cr,et(k.stock.amount),1),ur])])]),_:1}),ot(Oe),isNaN(+k.stock.code)?(Ot(),oe(Wi,{key:0},[ot(K,{stock:k.stock,transactions:k.transactions},null,8,["stock","transactions"]),ot(Oe)],64)):Be("",!0),(Ot(!0),oe(Wi,null,gn(k.transactions,V=>(Ot(),Vi(Ni,{key:V.id,color:V.direction?"red":"green"},{title:Tt(()=>[A("div",hr,[A("span",dr,et(V.date),1),k.isLogin?(Ot(),oe("div",pr,[ot(ie,{flat:"",dense:"",round:"",icon:"edit",onClick:R=>k.onEditTranscation(V)},null,8,["onClick"]),ot(ie,{color:"negative",flat:"",dense:"",round:"",icon:"delete"},{default:Tt(()=>[ot(bn,null,{default:Tt(()=>[ot(fn,null,{default:Tt(()=>[ot(mn,null,{default:Tt(()=>[yn("\u4F60\u771F\u7684\u8981\u5220\u9664\u6B64\u4EA4\u6613\u5417\uFF1F")]),_:1}),ot(Oe),ot(_n,{align:"right"},{default:Tt(()=>[ot(ie,{flat:"",color:"negative",label:"\u786E\u8BA4\u5220\u9664",onClick:R=>k.onDeleteTranscation(V.id)},null,8,["onClick"])]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024)])):Be("",!0)])]),default:Tt(()=>[A("div",vr,[A("div",gr,[A("span",fr,et(V.price),1),mr]),A("div",yr,[A("span",_r,et(V.quantity),1),xr]),A("div",Sr,[A("span",Cr,et(V.amount),1),br])])]),_:2},1032,["color"]))),128))]),_:1}),ot(N,{show:k.transactionAddShow,"onUpdate:show":mt[1]||(mt[1]=V=>k.transactionAddShow=V),data:k.transactionAddData,onConfirm:k.loadData},null,8,["show","data","onConfirm"])]),_:1})}var Rr=Zi($n,[["render",Tr]]);export{Rr as default};
